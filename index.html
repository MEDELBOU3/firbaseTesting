--- START OF FILE card-2.html (Rewritten HTML Structure) ---

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="AuraStream - Discover your next favorite movie or TV show with real-time data and an immersive interface.">

    <title>AuraStream | Your Entertainment Universe</title>

    <!-- Preconnect & Preload (Enhances Performance) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://unpkg.com">
    <link rel="preconnect" href="https://api.themoviedb.org">
    <link rel="preconnect" href="https://image.tmdb.org">

    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <!-- AOS Animate On Scroll Library CSS -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

    <style>
        /* ====================================================== */
/* === AuraStream Landing Page & Components CSS (v9.5) === */
/* ====================================================== */

/* --- Root Variables --- */
:root {
    --bg-primary: #050609;
    --bg-secondary: #0C0E14;
    --bg-tertiary: #12151C;
    --surface-color: #191E29;
    --bg-primary-rgb: 5, 6, 9;
    --bg-secondary-rgb: 12, 14, 20;
    --bg-tertiary-rgb: 18, 21, 28;
    --surface-rgb: 25, 30, 41;

    --primary-accent: #a855f7; /* Purple */
    --primary-accent-rgb: 168, 85, 247;
    --secondary-accent: #22d3ee; /* Cyan */
    --secondary-accent-rgb: 34, 211, 238;
    --tertiary-accent: #f472b6; /* Pink */
    --tertiary-accent-rgb: 244, 114, 182;

    --text-light: #f8fafc;
    --text-medium: #a0aec0;
    --text-dark: #1e293b; /* Used for light theme text */
    --text-medium-rgb: 160, 174, 192;

    --border-color: #374151;
    --border-color-light: rgba(var(--primary-accent-rgb), 0.6);

    --font-family-base: 'Inter', sans-serif;
    --font-family-headings: 'Poppins', sans-serif;

    --radius-sm: 0.3rem;
    --radius-md: 0.6rem;
    --radius-lg: 0.8rem;
    --radius-xl: 1.5rem;
    --radius-pill: 50px;

    --shadow-sm: 0 4px 10px rgba(0, 0, 0, 0.3);
    --shadow-md: 0 10px 25px rgba(0, 0, 0, 0.4);
    --shadow-lg: 0 18px 45px rgba(0, 0, 0, 0.5);
    --shadow-glow-primary: 0 0 35px rgba(var(--primary-accent-rgb), 0.3);
    --shadow-glow-secondary: 0 0 30px rgba(var(--secondary-accent-rgb), 0.25);
    --shadow-inner: inset 0 2px 6px rgba(0, 0, 0, 0.4);

    --gradient-primary: linear-gradient(130deg, var(--primary-accent) 0%, var(--secondary-accent) 100%);
    --gradient-secondary: linear-gradient(130deg, var(--primary-accent) 0%, var(--tertiary-accent) 100%);
    --gradient-hero-text: linear-gradient(to right, var(--text-light) 70%, var(--primary-accent) 110%);
    --gradient-text: linear-gradient(115deg, var(--primary-accent), var(--secondary-accent), var(--tertiary-accent));

    --transition-fast: 0.25s ease-out;
    --transition-medium: 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
    --transition-slow: 0.7s ease;

    --section-padding-y: 6rem;
    --section-padding-y-lg: 8rem;
    --curve-height: 70px;
    --navbar-height-desktop: 75px;
    --navbar-height-mobile: 65px;

    /* Bootstrap overrides if needed */
    --bs-primary: var(--primary-accent);
    --bs-primary-rgb: var(--primary-accent-rgb);
    --bs-secondary: var(--secondary-accent);
    --bs-secondary-rgb: var(--secondary-accent-rgb);
    --bs-body-color: var(--text-light);
    --bs-body-bg: var(--bg-primary);
    --bs-border-color: var(--border-color);
    --bs-border-color-translucent: rgba(var(--border-color), 0.5);
    --bs-emphasis-color: var(--text-light);
    --bs-tertiary-bg: var(--bg-tertiary);
    --bs-secondary-color: var(--text-medium);
    --bs-light-rgb: 248, 250, 252; /* text-light */
    --bs-dark-rgb: 12, 14, 20; /* bg-secondary */
}

/* --- Base & Typography --- */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
::selection { background-color: rgba(var(--primary-accent-rgb), 0.6); color: var(--text-light); }
html { scroll-behavior: smooth; -webkit-tap-highlight-color: transparent; font-size: 16px; }
body {
    font-family: var(--font-family-base);
    background-color: var(--bg-primary);
    color: var(--text-light);
    font-weight: 400; line-height: 1.7;
    overflow-x: hidden;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    position: relative;
}
body.offcanvas-open { overflow-y: hidden; }

h1, h2, h3, h4, h5, h6 { font-family: var(--font-family-headings); font-weight: 700; color: var(--text-light); letter-spacing: -0.03em; margin-bottom: 1.2rem; line-height: 1.3; }
h1 { font-weight: 800; line-height: 1.15; letter-spacing: -0.045em; font-size: clamp(2.6rem, 7vw, 4.2rem); }
h2 { font-size: clamp(1.8rem, 5.5vw, 2.8rem); font-weight: 700; margin-bottom: 1.8rem;}
h3 { font-size: clamp(1.4rem, 4.5vw, 1.8rem); font-weight: 600; margin-bottom: 1.5rem;}
h4 { font-size: clamp(1.1rem, 3vw, 1.25rem); font-weight: 600; margin-bottom: 0.8rem; }

p { color: var(--text-medium); font-size: clamp(0.95rem, 1.5vw, 1.05rem); margin-bottom: 1.2rem; max-width: 65ch; }
a { color: var(--secondary-accent); text-decoration: none; transition: color var(--transition-fast), filter var(--transition-fast); }
a:hover { color: var(--primary-accent); filter: brightness(1.15); }
a:focus-visible, button:focus-visible { outline: 2px solid var(--secondary-accent); outline-offset: 3px; border-radius: var(--radius-sm); }
*:focus { outline: none; } /* Reset default focus, rely on focus-visible */

.lead { font-size: clamp(1.05rem, 2.5vw, 1.2rem); font-weight: 400; color: var(--text-light); opacity: 0.9; max-width: 700px; margin: 0 auto 1.5rem auto; }
.text-gradient { background: var(--gradient-text); -webkit-background-clip: text; background-clip: text; color: transparent; -webkit-text-fill-color: transparent; display: inline-block; background-size: 300% auto; animation: gradientShift 7s linear infinite alternate; }
.gradient-text { background: var(--gradient-text); -webkit-background-clip: text; background-clip: text; color: transparent; -webkit-text-fill-color: transparent; display: inline-block; }
@keyframes gradientShift { 0% { background-position: 0% 50%; } 100% { background-position: 100% 50%; } }

/* --- 3D Background & Overlays --- */
#three-bg-canvas {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    z-index: 0; display: block; background-color: var(--bg-primary);
    pointer-events: none;
}
.noise-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='1.2' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
    opacity: 0.03;
    pointer-events: none; z-index: 1; mix-blend-mode: overlay;
}

/* --- Layout & Sections --- */
.landing-wrapper { position: relative; z-index: 2; background-color: transparent; overflow: hidden; }
.section { padding: var(--section-padding-y) 5%; position: relative; z-index: 3; border-bottom: 1px solid rgba(var(--border-color), 0.15); background-color: inherit; overflow: visible; }
.section-lg { padding-top: var(--section-padding-y-lg); padding-bottom: var(--section-padding-y-lg); }
.section:last-of-type { border-bottom: none; }

/* Section Backgrounds & Z-index */
#hero { background-color: transparent; z-index: 5; }
#content-showcase { background-color: var(--bg-secondary); z-index: 4; }
#features { background-color: var(--bg-primary); z-index: 4; }
#trailer-feature { background-color: var(--bg-tertiary); z-index: 4;}
#gallery-section { background-color: var(--bg-primary); z-index: 4; }
#analytics-dashboard { background-color: var(--bg-secondary); z-index: 4; }
#available-everywhere { background-color: var(--bg-primary); z-index: 4; }
#faq { background-color: var(--bg-tertiary); z-index: 4; }
#final-cta { background: var(--gradient-secondary); z-index: 4; color: #fff;}
.landing-footer { background-color: var(--bg-primary); z-index: 10; border-top: 1px solid rgba(var(--border-color), 0.3); }

/* Padding adjustments for curves */
.section-angled-top { padding-top: calc(var(--section-padding-y) + var(--curve-height) * 0.6); }
.section-angled-bottom { padding-bottom: calc(var(--section-padding-y) + var(--curve-height) * 0.6); }
.section-angled-top.section-lg { padding-top: calc(var(--section-padding-y-lg) + var(--curve-height) * 0.6); }
.section-angled-bottom.section-lg { padding-bottom: calc(var(--section-padding-y-lg) + var(--curve-height) * 0.6); }

/* --- SVG Section Dividers --- */
.section-divider { position: absolute; left: 0; width: 100%; overflow: hidden; line-height: 0; z-index: 2; pointer-events: none; height: var(--curve-height); }
.section-divider svg { position: relative; display: block; width: calc(100% + 1.3px); height: 100%; }
.divider-top { top: calc(var(--curve-height) * -1 + 1px); }
.divider-bottom { bottom: calc(var(--curve-height) * -1 + 1px); transform: rotate(180deg); }
/* Fill Rules */
#content-showcase > .divider-top .shape-fill { fill: var(--bg-primary); }
#content-showcase > .divider-bottom .shape-fill { fill: var(--bg-secondary); }
#features > .divider-top .shape-fill { fill: var(--bg-secondary); }
#features > .divider-bottom .shape-fill { fill: var(--bg-primary); }
#trailer-feature > .divider-top .shape-fill { fill: var(--bg-primary); }
#trailer-feature > .divider-bottom .shape-fill { fill: var(--bg-tertiary); }
#gallery-section > .divider-top .shape-fill { fill: var(--bg-tertiary); }
#gallery-section > .divider-bottom .shape-fill { fill: var(--bg-primary); }
#analytics-dashboard > .divider-top .shape-fill { fill: var(--bg-primary); }
#analytics-dashboard > .divider-bottom .shape-fill { fill: var(--bg-secondary); }
#available-everywhere > .divider-top .shape-fill { fill: var(--bg-secondary); }
#available-everywhere > .divider-bottom .shape-fill { fill: var(--bg-primary); }
#faq > .divider-top .shape-fill { fill: var(--bg-primary); }
#faq > .divider-bottom .shape-fill { fill: var(--bg-tertiary); }

/* --- Buttons --- */
.btn { display: inline-flex; align-items: center; justify-content: center; transition: all var(--transition-medium); letter-spacing: 0.04em; font-weight: 600; border-radius: var(--radius-pill); padding: 0.75rem 1.7rem; border: none; position: relative; overflow: hidden; box-shadow: var(--shadow-sm); cursor: pointer; font-size: 0.9rem; text-align: center; white-space: nowrap; vertical-align: middle; user-select: none; }
.btn i { line-height: 0; vertical-align: middle; font-size: 1.1em; margin-right: 0.5em;}
.btn-lg { padding: 0.9rem 2.3rem; font-size: 1.05rem; }
.btn-primary-gradient { background: var(--gradient-primary); color: #fff; box-shadow: var(--shadow-glow-primary), var(--shadow-md); }
.btn-primary-gradient:hover { transform: translateY(-4px) scale(1.03); box-shadow: 0 14px 28px rgba(var(--primary-accent-rgb), 0.3), 0 10px 10px rgba(0,0,0,0.25); filter: brightness(1.1); color: #fff; }
.btn-secondary-outline { border: 2px solid var(--border-color); color: var(--text-light); font-weight: 500; background: transparent; padding: calc(0.75rem - 2px) calc(1.7rem - 2px); box-shadow: none; }
.btn-secondary-outline:hover { background-color: rgba(var(--primary-accent-rgb), 0.12); border-color: var(--border-color-light); color: var(--primary-accent); transform: translateY(-3px); box-shadow: 0 8px 15px rgba(var(--primary-accent-rgb), 0.1); }
.btn-play { width: 60px; height: 60px; padding: 0; background: var(--gradient-primary); color: var(--text-light); border-radius: 50%; box-shadow: 0 5px 20px rgba(var(--primary-accent-rgb), 0.5); }
.btn-play:hover { background: var(--gradient-secondary); filter: brightness(1.15); transform: scale(1.1); box-shadow: 0 8px 30px rgba(var(--primary-accent-rgb), 0.6); }
.btn-play i { font-size: 1.6rem; margin: 0; line-height: 1; }
.btn:disabled { filter: grayscale(70%); opacity: 0.6; cursor: not-allowed; transform: none !important; box-shadow: var(--shadow-sm) !important; }

/* --- Custom Navbar --- */
.landing-navbar { display: flex; justify-content: space-between; align-items: center; height: var(--navbar-height-desktop); padding: 0 5%; background-color: transparent; position: fixed; top: 0; left: 0; right: 0; z-index: 1050; transition: background-color var(--transition-medium), box-shadow var(--transition-medium), height var(--transition-medium), backdrop-filter var(--transition-medium); border-bottom: 1px solid transparent; }
.landing-navbar.scrolled { background-color: rgba(var(--bg-secondary-rgb), 0.85); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); box-shadow: var(--shadow-md); border-color: rgba(var(--border-color), 0.3); height: calc(var(--navbar-height-desktop) - 10px); }
.navbar-brand-landing { font-weight: 800; font-size: 1.6rem; color: #fff !important; letter-spacing: -0.02em; transition: transform var(--transition-fast); display: inline-flex; align-items: center; gap: 0.5rem; }
.navbar-brand-landing:hover { transform: scale(1.04); color: #fff !important; }
.navbar-brand-landing i { color: var(--primary-accent); font-size: 1.2em; transition: transform 0.6s cubic-bezier(0.68, -0.55, 0.27, 1.55); }
.navbar-brand-landing:hover i { transform: rotate(360deg) scale(1.1); }
.nav-links-desktop { display: flex; align-items: center; list-style: none; margin: 0; padding: 0; gap: 0.6rem; }
.nav-links-desktop .nav-item { margin: 0; } /* Reset margin if needed */
.nav-links-desktop li a.nav-link { color: var(--text-medium); font-weight: 500; padding: 0.4rem 0.7rem; position: relative; transition: color var(--transition-fast), background-color var(--transition-fast); border-radius: var(--radius-sm); font-size: 0.9rem; }
.nav-links-desktop li a.nav-link:hover, .nav-links-desktop li a.nav-link.active { color: #fff; background-color: rgba(255, 255, 255, 0.08); }
.nav-actions { display: flex; align-items: center; gap: 0.8rem; }
.search-bar { display: flex; align-items: center; background-color: rgba(255, 255, 255, 0.08); border-radius: 50px; padding: 0.35rem 0.7rem; transition: var(--transition-medium); border: 1px solid transparent; }
.search-bar:focus-within { background-color: rgba(255, 255, 255, 0.12); box-shadow: 0 0 15px rgba(var(--secondary-accent-rgb), 0.2); border-color: rgba(var(--secondary-accent-rgb), 0.3); }
.search-bar input { background: transparent; border: none; color: var(--text-light); font-size: 0.85rem; outline: none; width: 130px; padding-left: 0.3rem; }
.search-bar input::placeholder { color: rgba(255, 255, 255, 0.5); }
.search-bar i { color: rgba(255, 255, 255, 0.7); margin-right: 0.4rem; font-size: 0.85rem; }
.btn-nav-cta { background: var(--gradient-primary); color: #fff; padding: 0.4rem 1.2rem; font-size: 0.85rem; box-shadow: 0 4px 12px rgba(var(--primary-accent-rgb), 0.3); }
.btn-nav-cta:hover { transform: translateY(-3px) scale(1.05); box-shadow: 0 7px 18px rgba(var(--primary-accent-rgb), 0.4); filter: brightness(1.1); color: #fff; }
.mobile-menu-toggle { display: none; background: none; border: none; color: var(--text-light); font-size: 1.8rem; cursor: pointer; padding: 0.5rem; line-height: 1; z-index: 1100; }
.offcanvas-menu { display: flex; flex-direction: column; position: fixed; top: 0; right: -100%; width: 85%; max-width: 350px; height: 100%; background-color: rgba(var(--bg-secondary-rgb), 0.97); backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px); border-left: 1px solid var(--border-color); transition: right 0.4s ease-in-out; z-index: 1040; padding: 6rem 1.5rem 2rem; }
.offcanvas-menu.active { right: 0; }
.offcanvas-menu .nav-links-mobile { list-style: none; padding: 0; margin: 0; width: 100%; }
.offcanvas-menu .nav-links-mobile li a { display: block; padding: 0.9rem 0; color: var(--text-medium); font-size: 1rem; font-weight: 500; border-bottom: 1px solid rgba(var(--border-color), 0.3); transition: color var(--transition-fast), background-color var(--transition-fast); }
.offcanvas-menu .nav-links-mobile li a:hover, .offcanvas-menu .nav-links-mobile li a.active { color: #fff; background-color: rgba(255, 255, 255, 0.05); padding-left: 0.5rem;}
.offcanvas-menu .mobile-search { margin: 2rem 0; }
.offcanvas-menu .mobile-launch-cta { margin-top: auto; width: 100%; }
.offcanvas-menu .btn-nav-cta { width: 100%; }
.offcanvas-overlay { position: fixed; inset: 0; background-color: rgba(0,0,0,0.6); z-index: 1030; opacity: 0; visibility: hidden; transition: opacity 0.4s ease, visibility 0s 0.4s; }
.offcanvas-overlay.active { opacity: 1; visibility: visible; transition: opacity 0.4s ease, visibility 0s 0s; }

/* --- Authentication Area Enhancements --- */
#auth-button-area { display: flex; align-items: center; } /* Container for buttons */
/* Login/Signup Prompt Button (Navbar) */
#login-signup-button { display: inline-flex; align-items: center; justify-content: center; padding: 0.4rem 1.2rem; font-size: 0.85rem; font-weight: 600; background: var(--gradient-primary, var(--primary-accent)); color: #fff; border: none; border-radius: var(--radius-pill); box-shadow: 0 4px 12px rgba(var(--primary-accent-rgb, 0 0 0), 0.3); transition: var(--transition-base); white-space: nowrap; text-decoration: none; }
#login-signup-button:hover { transform: translateY(-3px) scale(1.05); filter: brightness(1.15); box-shadow: 0 7px 18px rgba(var(--primary-accent-rgb, 0 0 0), 0.4); color: #fff; }
/* Logged-in User Info Area (Navbar) */
#user-info-area { display: flex; align-items: center; gap: 0.65rem; }
/* Avatar (Navbar) */
#user-avatar { width: 38px; height: 38px; border-radius: 50%; background-color: rgba(var(--primary-accent-rgb, 0 0 0), 0.3); color: var(--text-light); border: 2px solid rgba(var(--primary-accent-rgb, 255 255 255), 0.2); font-weight: 600; font-size: 0.85rem; overflow: hidden; cursor: pointer; display: inline-flex; align-items: center; justify-content: center; flex-shrink: 0; transition: var(--transition-base); box-shadow: var(--shadow-sm); }
#user-avatar:hover { transform: scale(1.1); border-color: rgba(var(--primary-accent-rgb, 255 255 255), 0.6); box-shadow: 0 0 10px rgba(var(--primary-accent-rgb, 255 255 255), 0.3); }
#user-avatar-image { width: 100%; height: 100%; object-fit: cover; }
#user-avatar-initials { line-height: 1; }
/* Display Name (Navbar) */
#user-display-name { color: var(--text-light); font-weight: 500; font-size: 0.9rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 160px; opacity: 0.9; }
/* Logout Button (Navbar) */
#logout-button { font-size: 0.8rem; padding: 0.35rem 0.8rem; border-radius: var(--radius-sm); border-width: 1px; color: var(--text-medium); border-color: var(--border-color); background-color: transparent; transition: var(--transition-base); white-space: nowrap; display: inline-flex; align-items: center; gap: 0.35rem; }
#logout-button:hover { color: var(--secondary-accent); border-color: var(--secondary-accent); background-color: rgba(var(--secondary-accent-rgb), 0.1); transform: scale(1.05); }

/* --- Hero Section --- */
#hero { min-height: 100vh; min-height: 100svh; display: flex; align-items: center; position: relative; z-index: 5; padding: calc(var(--navbar-height-desktop) + 50px) 5% 80px; }
.hero-background { position: absolute; inset: 0; z-index: -2; overflow: hidden; }
.hero-background-image { position: absolute; inset: 0; width: 100%; height: 100%; background-size: cover; background-position: center 30%; transform: scale(1.1); opacity: 0; transition: opacity 1.8s ease-out, transform 35s cubic-bezier(0.25, 0.1, 0.25, 1); will-change: transform, opacity; z-index: -1; }
#hero.loaded .hero-background-image { opacity: 0.4; transform: scale(1); }
#hero::before { content: ''; position: absolute; inset: 0; z-index: 0; background: linear-gradient(to right, rgba(var(--bg-primary-rgb),0.95) 25%, rgba(var(--bg-primary-rgb),0.6) 60%, transparent 100%); }
#hero::after { content: ''; position: absolute; bottom: 0; left: 0; right: 0; height: 200px; z-index: 1; background: linear-gradient(to top, var(--bg-secondary) 0%, transparent 100%); pointer-events: none; }
.hero-content { position: relative; z-index: 2; max-width: 680px; }
.hero-content h1 { background: var(--gradient-hero-text); -webkit-background-clip: text; background-clip: text; color: transparent; -webkit-text-fill-color: transparent; text-shadow: 0 4px 20px rgba(0,0,0,0.4); }
.hero-movie-info { display: flex; flex-wrap: wrap; gap: 0.8rem 1.5rem; margin-bottom: 2.2rem; color: rgba(255, 255, 255, 0.8); font-size: 0.85rem; }
.hero-info-item { display: flex; align-items: center; gap: 0.4rem; }
.hero-info-item i { color: var(--secondary-accent); font-size: 1em; }
.hero-cta-buttons { display: flex; flex-wrap: wrap; gap: 1rem; }
/* Skeleton for hero info */
.hero-info-item.skeleton-item { background-color: rgba(var(--text-medium-rgb), 0.2); border-radius: var(--radius-sm); height: 1rem; animation: pulse-skeleton 1.8s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
@keyframes pulse-skeleton { 0%, 100% { opacity: 1; } 50% { opacity: .5; } }

/* --- Content Showcase & Curved Shelves --- */
#content-showcase { z-index: 4; }
.content-shelf { margin-bottom: 4rem; position: relative; z-index: 10; }
.shelf-header { display: flex; flex-wrap: wrap; justify-content: space-between; align-items: flex-end; margin-bottom: 2rem; border-bottom: 1px solid rgba(var(--border-color), 0.2); padding-bottom: 0.8rem; gap: 0.5rem; }
.shelf-title { font-size: clamp(1.5rem, 4vw, 2rem); font-weight: 600; color: var(--text-light); margin-bottom: 0; display: inline-flex; align-items: center; gap: 0.6rem; }
.shelf-title i { font-size: 0.9em; opacity: 0.8; color: var(--secondary-accent); }
.shelf-view-all { font-size: 0.9rem; font-weight: 500; color: var(--text-medium); }
.shelf-view-all:hover { color: var(--text-light); }
.horizontal-scroll-wrapper { position: relative; margin: 0 -1rem; padding: 1rem 0; perspective: 1400px; }
.horizontal-scroll-container { display: flex; overflow-x: auto; overflow-y: hidden; gap: 1.2rem; padding: 0.5rem 1rem 2rem 1rem; margin-bottom: -1.5rem; scroll-behavior: smooth; scrollbar-width: none; -ms-overflow-style: none; -webkit-overflow-scrolling: touch; transform: rotateX(-2.5deg); transform-origin: center center; }
.horizontal-scroll-container::-webkit-scrollbar { display: none; }
.movie-card { flex: 0 0 clamp(160px, 20vw, 210px); background-color: var(--surface-color); border-radius: var(--radius-lg); overflow: hidden; text-decoration: none; color: var(--text-light); position: relative; transition: transform var(--transition-medium), box-shadow var(--transition-medium), border-color var(--transition-fast); box-shadow: var(--shadow-md); display: flex; flex-direction: column; will-change: transform, box-shadow; backface-visibility: hidden; border: 1px solid rgba(var(--border-color), 0.4); cursor: pointer; }
.movie-card:hover { transform: scale(1.05) translateY(-10px); box-shadow: var(--shadow-lg), 0 0 25px rgba(var(--primary-accent-rgb), 0.15); z-index: 15; border-color: var(--border-color-light); }
.card-image-wrapper { position: relative; width: 100%; aspect-ratio: 2 / 3; overflow: hidden; background-color: var(--bg-tertiary); }
.card-image-wrapper img { display: block; width: 100%; height: 100%; object-fit: cover; transition: transform var(--transition-slow), filter var(--transition-medium); }
.movie-card:hover .card-image-wrapper img { transform: scale(1.07); filter: brightness(1.05); }
.card-image-overlay { position: absolute; inset: 0; background: linear-gradient(to top, rgba(var(--surface-rgb), 1) 0%, rgba(var(--surface-rgb), 0.7) 35%, transparent 65%); pointer-events: none; }
.card-top-info { position: absolute; top: 0.6rem; left: 0.6rem; right: 0.6rem; display: flex; justify-content: flex-end; gap: 0.4rem; z-index: 2; pointer-events: none; }
.card-badge { background-color: rgba(var(--bg-primary-rgb), 0.75); backdrop-filter: blur(6px); color: var(--text-light); font-size: 0.65rem; font-weight: 600; padding: 0.25rem 0.5rem; border-radius: var(--radius-sm); pointer-events: all; display: inline-flex; align-items: center; gap: 0.3rem; border: 1px solid rgba(255,255,255,0.1); }
.card-badge.rating { color: #ffc107; }
.card-badge i { font-size: 0.8em; }
.card-content { padding: 0.8rem; margin-top: auto; position: relative; z-index: 1; }
.card-title { font-size: clamp(0.85rem, 2vw, 0.95rem); font-weight: 600; margin-bottom: 0.3rem; color: #fff; line-height: 1.3; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.card-meta { font-size: 0.7rem; color: var(--text-medium); opacity: 0.9; display: flex; align-items: center; gap: 0.5rem; flex-wrap: wrap; }
.card-meta span { display: inline-flex; align-items: center; gap: 0.2rem; }
.card-meta i { font-size: 0.9em; opacity: 0.8; }
.h-scroll-btn { position: absolute; top: calc(50% - 1rem); transform: translateY(-50%); z-index: 20; width: 45px; height: 45px; border-radius: 50%; background-color: rgba(var(--surface-rgb), 0.75); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); color: #fff; display: flex; align-items: center; justify-content: center; opacity: 0; transition: all var(--transition-medium); pointer-events: none; font-size: 1.2rem; box-shadow: 0 4px 15px rgba(0,0,0,0.3); cursor: pointer; }
.horizontal-scroll-wrapper:hover .h-scroll-btn:not(.disabled), .h-scroll-btn:focus-visible:not(.disabled) { opacity: 1; pointer-events: auto; }
.h-scroll-btn:not(.disabled):hover { background-color: rgba(var(--primary-accent-rgb), 0.4); border-color: rgba(var(--primary-accent-rgb), 0.6); transform: translateY(-50%) scale(1.1); box-shadow: 0 8px 25px rgba(var(--primary-accent-rgb), 0.3); }
.h-scroll-btn.prev { left: 0.5rem; }
.h-scroll-btn.next { right: 0.5rem; }
.h-scroll-btn.disabled { opacity: 0 !important; pointer-events: none; cursor: default; transform: translateY(-50%) scale(0.8); }
/* Shelf Loading/Error States */
.loading-shelf-text, .error-shelf-text { display: flex; align-items: center; justify-content: center; width: 100%; padding: 3rem 1rem; gap: 0.8rem; color: var(--text-medium); font-style: italic; font-size: 0.9rem; min-height: 200px; } /* Ensure min height */
.loading-spinner { width: 24px; height: 24px; border: 3px solid rgba(var(--text-medium-rgb), 0.3); border-left-color: var(--primary-accent); border-radius: 50%; display: inline-block; animation: spin 1s linear infinite; }
.error-shelf-text { color: var(--tertiary-accent); font-weight: 500; }
@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
/* Card Skeleton Placeholder Styles */
.movie-card.skeleton-placeholder { cursor: default; pointer-events: none; background-color: var(--bg-tertiary); }
.movie-card.skeleton-placeholder:hover { transform: none; box-shadow: var(--shadow-md); border-color: rgba(var(--border-color), 0.4); }
.skeleton-item { background: linear-gradient(110deg, rgba(var(--border-color),0.4) 8%, rgba(var(--border-color),0.6) 18%, rgba(var(--border-color),0.4) 33%); background-size: 200% 100%; border-radius: var(--radius-sm); animation: 1.8s pulse-skeleton linear infinite; }
.skeleton-placeholder .card-image-wrapper.skeleton-item { width: 100%; height: 0; padding-bottom: 150%; } /* Maintain aspect ratio */
.skeleton-placeholder .title { height: 1rem; width: 85%; margin-bottom: 0.5rem; }
.skeleton-placeholder .meta { height: 0.7rem; width: 55%; }

/* --- Features Section --- */
#features { z-index: 4; }
.feature-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 1.8rem; }
.feature-item { text-align: center; background-color: var(--surface-color); padding: 2.2rem 1.8rem; border-radius: var(--radius-lg); transition: transform var(--transition-medium), box-shadow var(--transition-medium), border-color var(--transition-medium); border: 1px solid var(--border-color); box-shadow: var(--shadow-md); height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: flex-start; }
.feature-item:hover { transform: translateY(-10px); box-shadow: var(--shadow-lg), var(--shadow-glow-secondary); border-color: var(--border-color-light); }
.feature-icon { font-size: 3rem; margin-bottom: 1.5rem; display: inline-block; background: var(--gradient-primary); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; text-fill-color: transparent; line-height: 1; }
.feature-item h4 { font-size: 1.2rem; }
.feature-item p { font-size: 0.9rem; color: var(--text-medium); flex-grow: 1; margin-bottom: 0; }

/* --- Trailer Feature Section --- */
#trailer-feature { z-index: 4; }
.trailer-feature-container { display: grid; grid-template-columns: 1fr; gap: 2.5rem; align-items: center; }
@media (min-width: 992px) { .trailer-feature-container { grid-template-columns: 1fr 1fr; gap: 4rem;} }
.trailer-visual { position: relative; border-radius: var(--radius-lg); overflow: hidden; box-shadow: var(--shadow-lg); aspect-ratio: 16 / 9; background-color: var(--bg-primary); }
.trailer-thumbnail-img { display: block; width: 100%; height: 100%; object-fit: cover; transition: opacity 0.5s ease; }
.trailer-play-button { background: var(--gradient-primary); position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 5; }
.trailer-play-button:hover:not(:disabled) { background: var(--gradient-secondary); }
.trailer-text-content h3 { font-size: clamp(1.6rem, 4vw, 2.2rem); }
.trailer-text-content p { margin-bottom: 1.8rem; color: var(--text-medium); font-size: 0.95rem;}
.trailer-text-content .btn { margin-top: 0.5rem; }
/* Loading state for trailer */
.trailer-loading-placeholder { color: var(--text-medium); font-style: italic; font-size: 0.9rem; }

/* --- Feature Video Player --- */
.feature-item.video-feature-demo { padding: 0; overflow: hidden; min-height: 350px; display: flex; flex-direction: column; }
.video-feature-demo .feature-icon, .video-feature-demo h4, .video-feature-demo p { padding: 0 1.8rem; text-align: center; position: relative; z-index: 3; }
.video-feature-demo .feature-icon { padding-top: 2.2rem; } .video-feature-demo h4 { margin-top: 1rem; } .video-feature-demo p { margin-bottom: 1.5rem; }
.contained-video-player { position: relative; width: 100%; flex-grow: 1; min-height: 200px; overflow: hidden; border-radius: 0 0 var(--radius-lg) var(--radius-lg); margin-top: auto; background-color: var(--bg-tertiary); cursor: pointer; transition: transform var(--transition-medium), box-shadow var(--transition-medium); }
.contained-video-player:hover { transform: scale(1.02); box-shadow: 0 8px 20px rgba(0,0,0, 0.4); }
.contained-video-player video { display: block; width: 100%; height: 100%; object-fit: cover; border-radius: inherit; position: absolute; top: 0; left: 0; z-index: 1; transition: filter 0.4s ease; }
.contained-video-player:not(.playing) video { filter: brightness(0.7); }
.contained-video-player:hover:not(.playing) video { filter: brightness(0.85); }
.video-overlay-gradient { position: absolute; inset: 0; background: linear-gradient(to bottom, rgba(var(--surface-rgb), 0.7) 0%, rgba(var(--surface-rgb), 0.1) 40%, transparent 60%); z-index: 2; pointer-events: none; border-radius: inherit; opacity: 1; transition: opacity 0.4s ease; }
.contained-video-player.playing .video-overlay-gradient { opacity: 0; }
.video-play-button { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 3; width: 60px; height: 60px; padding: 0; background: var(--gradient-primary); color: var(--text-light); border-radius: 50%; border: none; display: flex; align-items: center; justify-content: center; box-shadow: 0 5px 20px rgba(var(--primary-accent-rgb), 0.4); cursor: pointer; opacity: 1; transition: opacity 0.4s ease, transform 0.3s ease, background 0.3s ease; }
.video-play-button:hover { background: var(--gradient-secondary); transform: translate(-50%, -50%) scale(1.1); }
.video-play-button i { font-size: 1.8rem; line-height: 1; margin-left: 3px; }
.contained-video-player.playing .video-play-button { opacity: 0; transform: translate(-50%, -50%) scale(0.5); pointer-events: none; }
.contained-video-player.playing { cursor: default; }

/* --- 3D Carousel Gallery --- */
#gallery-section { position: relative; padding: var(--section-padding-y) 0; overflow: hidden; background-color: var(--bg-primary); z-index: 4; min-height: calc(550px + var(--section-padding-y) * 2); }
.galaxy-bg { position: absolute; width: 100%; height: 100%; top: 0; left: 0; background-image: radial-gradient(1px 1px at 20px 30px, var(--primary-accent), rgba(0,0,0,0)), radial-gradient(1px 1px at 40px 70px, var(--secondary-accent), rgba(0,0,0,0)), radial-gradient(1.5px 1.5px at 50px 160px, var(--tertiary-accent), rgba(0,0,0,0)), radial-gradient(1px 1px at 90px 40px, var(--primary-accent), rgba(0,0,0,0)), radial-gradient(1.5px 1.5px at 130px 80px, var(--secondary-accent), rgba(0,0,0,0)), radial-gradient(1px 1px at 160px 120px, var(--tertiary-accent), rgba(0,0,0,0)); background-repeat: repeat; background-size: 250px 250px; opacity: 0.06; z-index: 1; animation: stars-move 120s linear infinite; }
@keyframes stars-move { 0% { background-position: 0 0; } 100% { background-position: -1000px -1000px; } }
#gallery-section .container { width: 100%; max-width: 1100px; margin: 0 auto; padding: 0 15px; position: relative; z-index: 10; }
#gallery-section .section-heading { text-align: center; margin-bottom: 1rem; position: relative; z-index: 10; }
#gallery-section .section-heading h2 { margin-bottom: 1rem; }
#gallery-section .section-heading .lead { color: var(--text-medium); max-width: 700px; margin: 0 auto 2.5rem auto; font-size: clamp(0.95rem, 1.8vw, 1.05rem); line-height: 1.7; }
.glow-line { width: 80px; height: 3px; background: var(--gradient-primary); box-shadow: var(--shadow-glow-primary); border-radius: 10px; margin: 1rem auto 0 auto; }
/* 3D Gallery */
.gallery-3d-container { position: relative; perspective: 1100px; margin: 3rem auto 1.5rem auto; max-width: 900px; height: 400px; }
.gallery-3d-stage { width: 100%; height: 100%; position: absolute; transform-style: preserve-3d; transition: transform 0.8s cubic-bezier(0.25, 0.8, 0.25, 1); transform: rotateY(0deg); }
.gallery-card { position: absolute; width: 320px; height: 210px; left: 50%; top: 50%; cursor: grab; backface-visibility: hidden; transform-origin: center; transform-style: preserve-3d; transition: all 0.8s cubic-bezier(0.23, 1, 0.32, 1); border-radius: var(--radius-lg); overflow: hidden; box-shadow: var(--shadow-md); background-color: var(--bg-tertiary); border: 1px solid rgba(var(--border-color), 0.3); }
.gallery-card:active { cursor: grabbing; }
.gallery-card:nth-child(1) { transform: translate3d(-50%, -50%, 0) rotateY(0deg) translateZ(280px); }
.gallery-card:nth-child(2) { transform: translate3d(-50%, -50%, 0) rotateY(72deg) translateZ(280px); }
.gallery-card:nth-child(3) { transform: translate3d(-50%, -50%, 0) rotateY(144deg) translateZ(280px); }
.gallery-card:nth-child(4) { transform: translate3d(-50%, -50%, 0) rotateY(216deg) translateZ(280px); }
.gallery-card:nth-child(5) { transform: translate3d(-50%, -50%, 0) rotateY(288deg) translateZ(280px); }
.gallery-card.active { z-index: 10; transform: translate3d(-50%, -50%, 320px) rotateY(0deg) scale(1.08); box-shadow: var(--shadow-glow-primary), var(--shadow-lg); border-color: rgba(var(--primary-accent-rgb), 0.5); }
.gallery-card.active::before { content: ''; position: absolute; top: -10px; left: -10px; right: -10px; bottom: -10px; background: radial-gradient(circle, rgba(var(--primary-accent-rgb), 0.1) 0%, transparent 65%); border-radius: var(--radius-lg); z-index: -1; animation: glowPulse 3s infinite alternate; }
@keyframes glowPulse { 0%{opacity:.3;transform:scale(.98)} 100%{opacity:.6;transform:scale(1.02)} }
.gallery-card:not(.active) { filter: brightness(0.65) saturate(0.8); }
.gallery-card .card-front { position: relative; width: 100%; height: 100%; overflow: hidden; backface-visibility: hidden; transform-style: preserve-3d; transform: translateZ(0); border-radius: inherit; }
.gallery-card .card-image { width: 100%; height: 100%; object-fit: cover; transform: scale(1.0); transition: transform 1s cubic-bezier(0.23, 1, 0.32, 1), filter 0.5s ease; filter: brightness(0.85); border-radius: inherit;}
.gallery-card:hover .card-image, .gallery-card.active .card-image { transform: scale(1.04); filter: brightness(1); }
.gallery-card .card-overlay { position: absolute; inset: 0; background: linear-gradient(to top, rgba(var(--bg-primary-rgb), 0.8) 0%, rgba(var(--bg-primary-rgb), 0.1) 50%, transparent 70%); z-index: 2; transform: translateZ(1px); border-radius: inherit; transition: opacity 0.4s ease;}
.gallery-card:not(.active):hover .card-overlay { opacity: 0.6; }
.gallery-card .card-content { position: absolute; bottom: 0; left: 0; width: 100%; padding: 1rem; z-index: 3; transform: translateZ(20px); transform-style: preserve-3d; pointer-events: none;}
.gallery-card .card-tag { background: var(--primary-accent); color: var(--text-light); font-size: 0.65rem; padding: 3px 8px; border-radius: var(--radius-pill); display: inline-block; margin-bottom: 6px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; transform: translateZ(5px); box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3); }
.gallery-card .card-title { font-size: 1.1rem; font-weight: 700; margin-bottom: 4px; transform: translateZ(10px); text-shadow: 0 1px 5px rgba(0, 0, 0, 0.6); line-height: 1.3; color: #fff; }
.gallery-card .card-description { font-size: 0.8rem; color: var(--text-medium); opacity: 0; transform: translateY(15px) translateZ(15px); transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1) 0.1s; margin-bottom: 0; line-height: 1.4; }
.gallery-card:hover .card-description, .gallery-card.active .card-description { opacity: 1; transform: translateY(0) translateZ(15px); }
/* Navigation */
.gallery-nav { position: relative; display: flex; justify-content: center; align-items: center; margin-top: 2.5rem; z-index: 20; }
.gallery-nav .nav-btn { width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; background: var(--surface-color); border: 1px solid var(--border-color); color: var(--text-light); font-size: 1.2rem; cursor: pointer; transition: all var(--transition-fast); box-shadow: var(--shadow-sm); position: relative; overflow: hidden; }
.gallery-nav .nav-btn:hover { background: var(--primary-accent); border-color: var(--primary-accent); transform: translateY(-3px); box-shadow: var(--shadow-glow-primary); }
.gallery-nav .nav-btn::after { content:''; position:absolute; inset:0; background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%); opacity:0; transform:scale(0); transition: all 0.4s ease;}
.gallery-nav .nav-btn:hover::after { opacity:1; transform:scale(1.5);}
.gallery-dots { display: flex; justify-content: center; align-items: center; margin: 0 1.2rem; }
.gallery-dots .dot { width: 9px; height: 9px; margin: 0 4px; border-radius: 50%; background: var(--surface-color); border: 1px solid var(--border-color); cursor: pointer; transition: all 0.3s ease; position: relative; overflow: hidden; padding: 0; /* Reset button padding */ }
.gallery-dots .dot.active { background: var(--primary-accent); transform: scale(1.15); box-shadow: 0 0 8px rgba(var(--primary-accent-rgb), 0.5); border-color: var(--primary-accent); }
.gallery-dots .dot::after { content:''; position:absolute; top:50%; left:50%; width:16px; height:16px; background: radial-gradient(circle, var(--primary-accent) 0%, transparent 70%); transform: translate(-50%,-50%) scale(0); opacity:0; transition: all 0.3s ease;}
.gallery-dots .dot:hover::after { transform: translate(-50%,-50%) scale(1); opacity:0.4;}
.gallery-dots .dot.active::after { animation: dotPulse 2s infinite; transform: translate(-50%,-50%) scale(1.2); opacity:0.6;}
@keyframes dotPulse { 0%{transform:translate(-50%,-50%) scale(1);opacity:.6} 50%{transform:translate(-50%,-50%) scale(1.4);opacity:.4} 100%{transform:translate(-50%,-50%) scale(1);opacity:.6} }
/* Fullscreen Modal */
.fullscreen-modal { position: fixed; inset: 0; z-index: 1070; background-color: rgba(var(--bg-primary-rgb), 0.95); display: flex; align-items: center; justify-content: center; opacity: 0; visibility: hidden; transition: opacity 0.4s ease, visibility 0s 0.4s; backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); }
.fullscreen-modal.active { opacity: 1; visibility: visible; transition: opacity 0.4s ease, visibility 0s 0s; }
.fullscreen-modal .modal-content { position: relative; width: 90%; height: 85%; display: flex; flex-direction: column; align-items: center; justify-content: center; transform: scale(0.95); opacity: 0; transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) 0.1s, opacity 0.4s ease 0.1s; background: none; border: none; }
.modal-image-container { width: 100%; height: calc(100% - 50px); display: flex; align-items: center; justify-content: center; overflow: hidden; position: relative; }
.modal-image { display: block; max-width: 100%; max-height: 100%; object-fit: contain; border-radius: var(--radius-md); box-shadow: var(--shadow-lg); }
.modal-caption { position: absolute; bottom: 5px; left: 50%; transform: translateX(-50%); background: rgba(var(--surface-rgb), 0.8); backdrop-filter: blur(5px); padding: 0.5rem 1rem; border-radius: var(--radius-pill); color: var(--text-light); font-weight: 500; box-shadow: var(--shadow-sm); border: 1px solid rgba(var(--border-color), 0.5); font-size: 0.85rem; white-space: nowrap; }
.modal-close { position: absolute; top: 10px; right: 15px; width: 38px; height: 38px; border-radius: 50%; background: rgba(var(--surface-rgb), 0.7); color: var(--text-light); display: flex; align-items: center; justify-content: center; font-size: 1.3rem; cursor: pointer; transition: all 0.3s ease; box-shadow: var(--shadow-md); border: 1px solid var(--border-color); z-index: 10; padding: 0; /* Reset button padding */ }
.modal-close:hover { background: var(--primary-accent); transform: rotate(90deg) scale(1.1); box-shadow: var(--shadow-glow-primary); }

/* --- Analytics Dashboard --- */
#analytics-dashboard { background-color: var(--bg-secondary); z-index: 4; }
.analytics-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(min(100%, 280px), 1fr)); gap: 1.5rem; }
.analytics-card { background-color: var(--surface-color); border-radius: var(--radius-lg); padding: 1.3rem 1.5rem; box-shadow: var(--shadow-md); border: 1px solid var(--border-color); transition: transform var(--transition-medium), box-shadow var(--transition-medium); overflow: hidden; }
.analytics-card:hover { transform: translateY(-6px); box-shadow: var(--shadow-lg), 0 0 20px rgba(var(--secondary-accent-rgb), 0.1); }
.analytics-card h4 { font-size: 1.05rem; color: var(--text-light); margin-bottom: 1.2rem; font-weight: 500; border-bottom: 1px solid rgba(var(--border-color), 0.5); padding-bottom: 0.6rem; }
.analytics-card.large-card { grid-column: span 2; }
@media (max-width: 991px) { .analytics-card.large-card { grid-column: span 1; } }
/* Containers */
.chart-container { min-height: 160px; display: flex; flex-direction: column; align-items: center; justify-content: center; position: relative; }
.list-container { min-height: 160px; max-height: 220px; }
.scrollable-list { overflow-y: auto; scrollbar-width: thin; scrollbar-color: var(--primary-accent) rgba(var(--surface-rgb), 0.5); padding-right: 5px; }
.scrollable-list::-webkit-scrollbar { width: 5px; }
.scrollable-list::-webkit-scrollbar-track { background: rgba(var(--surface-rgb), 0.5); border-radius: 3px;}
.scrollable-list::-webkit-scrollbar-thumb { background-color: var(--primary-accent); border-radius: 3px; border: 1px solid rgba(var(--surface-rgb), 0.5); }
.loading-placeholder { color: var(--text-medium); font-style: italic; text-align: center; padding: 1rem; }
/* KPI Card */
.kpi-card h4 { margin-bottom: 1rem; }
.kpi-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1.2rem 0.8rem; text-align: center; }
.kpi-item { display: flex; flex-direction: column; }
.kpi-value { font-size: clamp(1.3rem, 4vw, 1.8rem); font-weight: 700; color: var(--text-light); line-height: 1.1; margin-bottom: 0.2rem; display: inline-flex; align-items: center; justify-content: center; gap: 0.3rem; }
.kpi-value i { font-size: 0.8em; }
.kpi-label { font-size: 0.75rem; color: var(--text-medium); text-transform: uppercase; letter-spacing: 0.5px; }
/* Simulated Donut Chart */
.simulated-donut-chart { flex-direction: row; gap: 1.2rem; align-items: center; justify-content: center; }
.donut-chart-visual { width: 110px; height: 110px; border-radius: 50%; background: conic-gradient( var(--primary-accent) 0% 30%, var(--secondary-accent) 30% 55%, var(--tertiary-accent) 55% 75%, #ffc107 75% 90%, #4caf50 90% 100% ); position: relative; flex-shrink: 0; display: flex; align-items: center; justify-content: center; }
.donut-chart-visual::before { content: ''; position: absolute; width: 60%; height: 60%; background: var(--surface-color); border-radius: 50%; }
.chart-legend { list-style: none; padding: 0; margin: 0; font-size: 0.75rem; display: flex; flex-direction: column; gap: 0.4rem; }
.chart-legend li { display: flex; align-items: center; gap: 0.4rem; color: var(--text-medium); }
.legend-color { display: inline-block; width: 10px; height: 10px; border-radius: 3px; flex-shrink: 0; }
/* Simulated Gauge Chart */
.gauge-wrap { width: 120px; height: 60px; position: relative; overflow: hidden; margin-bottom: 0.8rem; }
.gauge-wrap::before, .gauge-fill { content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 100%; border-radius: 120px 120px 0 0; transform-origin: center bottom; }
.gauge-wrap::before { background: rgba(var(--text-medium-rgb), 0.15); }
.gauge-fill { background: var(--gradient-primary); transform: rotate(0.5turn); transition: transform 1s ease-out; }
.gauge-cover { width: 75%; height: 75%; background: var(--surface-color); border-radius: 50%; position: absolute; top: 25%; left: 50%; transform: translateX(-50%); display: flex; flex-direction: column; align-items: center; justify-content: center; padding-top: 8px; }
.gauge-value { font-size: 1.4rem; font-weight: 700; color: var(--text-light); line-height: 1; }
.gauge-label { font-size: 0.7rem; color: var(--text-medium); margin-top: 2px; }
.chart-subtext { font-size: 0.75rem; color: var(--text-medium); margin-top: 0.8rem; text-align: center; }
/* Simulated Area Chart */
.simulated-area-chart { justify-content: flex-end; }
.area-chart-visual { width: 100%; height: 130px; position: relative; }
.area-chart-visual svg { position: absolute; bottom: 0; left: 0; width: 100%; height: 100%; display: block; }
.chart-axis-labels { display: flex; justify-content: space-between; width: 100%; padding: 0.4rem 0.4rem 0; font-size: 0.7rem; color: var(--text-medium); }
/* Actor List */
.actor-list { padding-right: 5px; }
.actor-item { display: flex; align-items: center; gap: 0.7rem; padding: 0.5rem 0; border-bottom: 1px solid rgba(var(--border-color), 0.3); transition: background-color var(--transition-fast); }
.actor-item:last-child { border-bottom: none; }
.actor-item:hover { background-color: rgba(var(--surface-rgb), 0.5); }
.actor-item img { width: 32px; height: 32px; border-radius: 50%; object-fit: cover; flex-shrink: 0; background-color: var(--bg-tertiary); }
.actor-name { flex-grow: 1; font-size: 0.85rem; font-weight: 500; color: var(--text-light); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.actor-popularity { font-size: 0.75rem; color: var(--secondary-accent); display: inline-flex; align-items: center; gap: 0.2rem; flex-shrink: 0; }
.actor-popularity i { font-size: 0.9em; }
/* Simulated Bar Chart */
.simulated-bar-chart { display: flex; flex-direction: column; gap: 0.6rem; width: 100%; align-items: stretch; }
.bar-item { display: flex; align-items: center; gap: 0.7rem; }
.bar-label { flex: 0 0 70px; font-size: 0.75rem; color: var(--text-medium); text-align: right; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.bar { height: 12px; border-radius: var(--radius-pill); background: var(--gradient-primary); box-shadow: inset 0 1px 2px rgba(0,0,0,0.2); transition: width 0.8s ease-out; width: 0%; }

/* --- Available Everywhere Section --- */
#available-everywhere { z-index: 4; }
.platform-list { list-style: none; padding-left: 0; max-width: 450px; margin: 0 auto; }
.platform-list li { margin-bottom: 0.9rem; font-size: 1rem; display: flex; align-items: center; gap: 0.9rem; }
.platform-list i { color: var(--secondary-accent); font-size: 1.6em; line-height: 1; flex-shrink: 0; width: 28px; text-align: center;}
.platform-list .coming-soon { font-size: 0.75em; color: var(--text-medium); opacity: 0.7; font-style: italic; margin-left: auto; white-space: nowrap; background: rgba(var(--surface-rgb), 0.5); padding: 0.1rem 0.4rem; border-radius: var(--radius-sm); }
.device-graphic-placeholder { background-color: rgba(var(--surface-rgb), 0.5); border-radius: var(--radius-xl); padding: 2.5rem; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 300px; color: var(--text-medium); border: 1px dashed var(--border-color); text-align: center; }
.device-graphic-placeholder i { font-size: 4rem; opacity: 0.3; margin-bottom: 1rem; }

/* --- FAQ Section --- */
#faq { z-index: 4; background-color: var(--bg-tertiary); }
.faq-accordion .accordion-item { background-color: var(--surface-color); border: 1px solid var(--border-color); border-radius: var(--radius-lg) !important; margin-bottom: 1rem; overflow: hidden; transition: border-color var(--transition-medium), box-shadow var(--transition-fast); }
.faq-accordion .accordion-item:hover { border-color: var(--border-color-light); box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
.faq-accordion .accordion-button { background-color: transparent; color: var(--text-light); font-weight: 600; font-size: 1.1rem; border: none; box-shadow: none; padding: 1.3rem 1.8rem; transition: background-color var(--transition-medium); text-align: left; width: 100%; display: flex; justify-content: space-between; align-items: center; }
.faq-accordion .accordion-button:not(.collapsed) { background: rgba(var(--primary-accent-rgb), 0.1); color: #fff; box-shadow: inset 0 -3px 8px rgba(var(--primary-accent-rgb), 0.1); }
.faq-accordion .accordion-button:not(.collapsed)::after { background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23ffffff'%3e%3cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3e%3c/svg%3e"); transform: rotate(-180deg); }
.faq-accordion .accordion-button::after { flex-shrink: 0; width: 1.25rem; height: 1.25rem; margin-left: auto; content: ""; background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23a0aec0'%3e%3cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3e%3c/svg%3e"); background-repeat: no-repeat; background-size: 1.25rem; transition: transform .3s ease-in-out; }
.faq-accordion .accordion-body { background-color: var(--surface-color); color: var(--text-medium); padding: 0.5rem 1.8rem 1.8rem 1.8rem; font-size: 0.95rem; line-height: 1.8; border-top: 1px solid rgba(var(--border-color), 0.3); }

/* --- Final CTA Section --- */
#final-cta { z-index: 4; }
#final-cta h2 { color: #fff; font-size: clamp(2rem, 7vw, 3rem); text-shadow: 0 4px 20px rgba(0,0,0,0.3); margin-bottom: 1.5rem; }
#final-cta p { color: rgba(255,255,255,0.95); max-width: 700px; margin: 0 auto 3rem auto; font-size: 1.1rem; }
#final-cta .btn-cta-final { background: #fff; color: var(--primary-accent); font-size: 1.1rem; padding: 1rem 2.5rem; box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
#final-cta .btn-cta-final:hover { background: var(--text-light); color: var(--primary-accent); transform: translateY(-6px) scale(1.06); box-shadow: 0 15px 40px rgba(0,0,0,0.4); }

/* --- Footer --- */
.landing-footer { padding: 4.5rem 5% 2rem; font-size: 0.9rem; color: var(--text-medium); z-index: 10; background-color: var(--bg-primary); border-top: 1px solid rgba(var(--border-color), 0.3); }
.footer-content { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 2.5rem; margin-bottom: 3.5rem; }
.footer-column h4 { color: var(--text-light); margin-bottom: 1.3rem; font-size: 1.05rem; position: relative; padding-bottom: 0.4rem; font-weight: 600; }
.footer-column h4::after { content: ''; position: absolute; left: 0; bottom: 0; width: 30px; height: 3px; background: var(--gradient-primary); border-radius: 1px;}
.footer-column ul { list-style: none; padding-left: 0; }
.footer-column ul li { margin-bottom: 0.7rem; }
.footer-column a { color: var(--text-medium); text-decoration: none; transition: var(--transition-fast); display: inline-flex; align-items: center; font-size: 0.95rem; opacity: 0.85; } /* Make links use medium color */
.footer-column a:hover { color: var(--secondary-accent); transform: translateX(4px); opacity: 1; } /* Hover use accent */
.footer-column a i { color: inherit; transition: color var(--transition-fast); }
/*Conceptual link styling specific to footer*/
button.footer-link { background: none; border: none; padding: 0; color: var(--text-medium); text-decoration: none; transition: var(--transition-fast); display: inline-flex; align-items: center; font-size: 0.95rem; opacity: 0.85; }
button.footer-link:hover { color: var(--secondary-accent); transform: translateX(4px); opacity: 1; }
button.footer-link i { margin-right: 0.3em; } /* Keep icon spacing */
.footer-social { display: flex; gap: 0.8rem; margin-top: 1rem;}
.social-icon { width: 35px; height: 35px; border-radius: 50%; background-color: rgba(255, 255, 255, 0.1); display: flex; align-items: center; justify-content: center; color: var(--text-light); text-decoration: none; transition: var(--transition-fast); font-size: 0.95rem; }
.social-icon:hover { background-color: var(--primary-accent); transform: translateY(-4px); box-shadow: 0 5px 10px rgba(var(--primary-accent-rgb), 0.3); }
.footer-bottom { text-align: center; padding-top: 2rem; border-top: 1px solid rgba(255, 255, 255, 0.1); font-size: 0.85rem; opacity: 0.8; }
.footer-bottom p { margin-bottom: 0.4rem; }
.footer-bottom a, button.footer-link-bottom { color: var(--text-medium); text-decoration: underline; background: none; border: none; padding: 0; font-size: inherit;}
.footer-bottom a:hover, button.footer-link-bottom:hover { color: #fff; }

/* --- Modal Styles (General) --- */
.modal-backdrop { background-color: rgba(0,0,0,0.8); backdrop-filter: blur(5px); }
.modal-content { background-color: var(--bg-secondary); border: 1px solid var(--border-color); color: var(--text-light); border-radius: var(--radius-lg); box-shadow: 0 10px 40px rgba(0,0,0,0.5); }
.modal-header { border-bottom: 1px solid var(--border-color); padding: 1rem 1.3rem; }
.modal-header .btn-close { filter: invert(1) grayscale(100%) brightness(200%); opacity: 0.7; transition: opacity var(--transition-fast); font-size: 0.8rem; }
.modal-header .btn-close:hover { opacity: 1; }
.modal-title { font-weight: 600; font-size: 1.15rem; display: flex; align-items: center; gap: 0.5rem; }
.modal-body { padding: 1.3rem 1.3rem 1.8rem; }
.modal-footer { border-top: 1px solid var(--border-color); padding: 0.9rem 1.3rem; }
/* Auth Modal Form Controls */
#launchAppModal .form-control { background-color: rgba(255, 255, 255, 0.05); border: 1px solid var(--border-color); color: var(--text-light); border-radius: var(--radius-md); }
#launchAppModal .form-control::placeholder { color: var(--text-medium); opacity: 0.7; }
#launchAppModal .form-control:focus { background-color: rgba(255, 255, 255, 0.1); border-color: var(--bs-primary); color: var(--text-light); box-shadow: 0 0 0 0.25rem rgba(var(--primary-accent-rgb), 0.25); }
#launchAppModal .form-label { font-weight: 500; margin-bottom: 0.5rem; font-size: 0.9rem; }
#launchAppModal .form-text { color: var(--text-medium); font-size: 0.8rem; }
#launchAppModal .nav-pills .nav-link { color: var(--text-medium); background-color: transparent; border: 1px solid var(--border-color); margin: 0 2px; transition: var(--transition-fast); }
#launchAppModal .nav-pills .nav-link.active { background-color: var(--primary-accent); color: #fff; border-color: var(--primary-accent); }
#launchAppModal .nav-pills .nav-link:hover:not(.active) { background-color: rgba(var(--surface-rgb), 0.7); }
#launchAppModal .btn-light { color: #333; background-color: #eee; border-color: #ccc; }
#launchAppModal .btn-light:hover { background-color: #ddd; }
#launchAppModal .btn-success { background-color: #198754; border-color: #198754; }
#launchAppModal .btn-success:hover { background-color: #157347; border-color: #146c43; }
#auth-error-message { font-size: 0.9rem; }

/* Trailer Modal Specific */
#trailer-modal .modal-dialog { max-width: 900px; margin: 1.5rem auto; }
#trailer-modal .modal-content { background-color: #000; border: none; border-radius: var(--radius-lg); overflow: hidden;} /* Rounded corners */
#trailer-modal .modal-body { padding: 0; position: relative;}
#trailer-modal .modal-close-video { position: absolute; top: -10px; right: -10px; /* Adjusted for overlap */ width: 34px; height: 34px; background-color: rgba(var(--bg-primary-rgb), 0.85); backdrop-filter: blur(4px); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: var(--text-light); border: 1px solid var(--border-color); cursor: pointer; z-index: 1060; transition: var(--transition-medium); font-size: 1.1rem; }
#trailer-modal .modal-close-video:hover { background-color: var(--primary-accent); transform: rotate(90deg); box-shadow: 0 0 10px rgba(var(--primary-accent-rgb), 0.5);}
.video-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; background-color: #000; } /* Removed border-radius here */
.video-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0; }

/* --- Loading Screen --- */
.loading-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: var(--bg-primary); display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 9999; transition: opacity 0.8s ease, visibility 0s 0.8s; visibility: visible; opacity: 1; }
.loading-screen.hidden { opacity: 0; visibility: hidden; }
.loader { position: relative; width: 60px; height: 60px; }
.loader div { position: absolute; border: 4px solid transparent; border-radius: 50%; border-top-color: var(--primary-accent); border-bottom-color: var(--secondary-accent); animation: rotate 1.5s linear infinite; }
.loader div:first-child { width: 100%; height: 100%; }
.loader div:nth-child(2) { top: 8px; left: 8px; right: 8px; bottom: 8px; animation: rotate 1s linear infinite reverse; border-top-color: var(--secondary-accent); border-bottom-color: var(--tertiary-accent); }
.loader div:nth-child(3) { top: 16px; left: 16px; right: 16px; bottom: 16px; animation: rotate 0.75s linear infinite; border-top-color: var(--tertiary-accent); border-bottom-color: var(--primary-accent); }
.loading-text { margin-top: 1.3rem; font-size: 0.9rem; letter-spacing: 1.5px; animation: pulse-text 1.5s infinite alternate; color: var(--text-medium); }
@keyframes rotate { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
@keyframes pulse-text { 0% { opacity: 0.6; } 100% { opacity: 1; } }

/* --- Misc & Helpers --- */
.conceptual-link { cursor: help; text-decoration: underline dotted rgba(var(--secondary-accent-rgb), 0.5); }

/* --- Responsive Overrides --- */
@media (max-width: 991px) {
    :root{ --navbar-height-desktop: 70px; --navbar-height-mobile: 65px; }
    .landing-navbar { height: var(--navbar-height-mobile); }
    .landing-navbar.scrolled { height: calc(var(--navbar-height-mobile) - 5px); }
    .nav-links-desktop, .search-bar { display: none !important; } /* Force hide */
    .mobile-menu-toggle { display: block !important; } /* Force show */
    .horizontal-scroll-container { transform: rotateX(0deg); }
    .analytics-grid { grid-template-columns: repeat(auto-fit, minmax(min(100%, 250px), 1fr)); }
    .gallery-3d-container { height: 380px; perspective: 1000px; }
    .gallery-card { width: 280px; height: 185px; }
    .gallery-card:nth-child(1) { transform: translate3d(-50%, -50%, 0) rotateY(0deg) translateZ(250px); }
    .gallery-card:nth-child(2) { transform: translate3d(-50%, -50%, 0) rotateY(72deg) translateZ(250px); }
    .gallery-card:nth-child(3) { transform: translate3d(-50%, -50%, 0) rotateY(144deg) translateZ(250px); }
    .gallery-card:nth-child(4) { transform: translate3d(-50%, -50%, 0) rotateY(216deg) translateZ(250px); }
    .gallery-card:nth-child(5) { transform: translate3d(-50%, -50%, 0) rotateY(288deg) translateZ(250px); }
    .gallery-card.active { transform: translate3d(-50%, -50%, 290px) rotateY(0deg) scale(1.05); }
}

@media (max-width: 767px) {
    :root{ --section-padding-y: 4.5rem; --curve-height: 50px; }
    .horizontal-scroll-wrapper { perspective: none; margin: 0; padding: 0.8rem 0; }
    .horizontal-scroll-container { transform: rotateX(0deg); gap: 1rem; padding: .5rem 5% 1.5rem 5%; }
    .movie-card { flex-basis: clamp(145px, 45vw, 170px); }
    .h-scroll-btn { display: none; }
    #hero { padding-top: calc(var(--navbar-height-mobile) + 30px); padding-bottom: 60px; }
    .hero-content .lead { font-size: 1rem; }
    .hero-cta-buttons { flex-direction: column; align-items: flex-start; max-width: 300px; }
    .hero-cta-buttons .btn { width: 100%; }
    .feature-grid { grid-template-columns: 1fr; gap: 1.5rem;}
    .trailer-feature-container { grid-template-columns: 1fr; gap: 2rem;}
    .footer-content { grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 2rem; text-align: left; }
    .footer-social { justify-content: flex-start; }
    .analytics-grid { grid-template-columns: 1fr; }
    .gallery-3d-container { height: 350px; perspective: 800px; margin-top: 2rem; }
    .gallery-card { width: 240px; height: 160px; }
    .gallery-card:nth-child(1) { transform: translate3d(-50%, -50%, 0) rotateY(0deg) translateZ(200px); }
    .gallery-card:nth-child(2) { transform: translate3d(-50%, -50%, 0) rotateY(72deg) translateZ(200px); }
    .gallery-card:nth-child(3) { transform: translate3d(-50%, -50%, 0) rotateY(144deg) translateZ(200px); }
    .gallery-card:nth-child(4) { transform: translate3d(-50%, -50%, 0) rotateY(216deg) translateZ(200px); }
    .gallery-card:nth-child(5) { transform: translate3d(-50%, -50%, 0) rotateY(288deg) translateZ(200px); }
    .gallery-card.active { transform: translate3d(-50%, -50%, 230px) rotateY(0deg) scale(1.05); }
    .gallery-nav .nav-btn { width: 38px; height: 38px; font-size: 1.1rem; }
    .gallery-dots { margin: 0 0.8rem; }
    .gallery-dots .dot { width: 8px; height: 8px; }
}
 @media (max-width: 576px) {
     .movie-card { flex-basis: clamp(130px, 60vw, 200px); }
     .shelf-header { flex-direction: column; align-items: flex-start; gap: 0.2rem; }
     .hero-movie-info { gap: .5rem 1rem; font-size: .8rem; }
     .landing-footer { padding: 4rem 5% 1.5rem; }
     .offcanvas-menu { width: 90%; max-width: none; }
     .faq-accordion .accordion-button { font-size: 1rem; padding: 1rem 1.2rem; }
     .faq-accordion .accordion-body { padding: 0.5rem 1.2rem 1.2rem 1.2rem; font-size: 0.9rem; }
     #final-cta h2 { font-size: 1.8rem; }
     #final-cta p { font-size: 1rem; }
     .gallery-3d-container { height: 300px; perspective: 700px; }
     .gallery-card { width: 200px; height: 135px; }
     .gallery-card:nth-child(1) { transform: translate3d(-50%, -50%, 0) rotateY(0deg) translateZ(180px); }
     .gallery-card:nth-child(2) { transform: translate3d(-50%, -50%, 0) rotateY(72deg) translateZ(180px); }
     .gallery-card:nth-child(3) { transform: translate3d(-50%, -50%, 0) rotateY(144deg) translateZ(180px); }
     .gallery-card:nth-child(4) { transform: translate3d(-50%, -50%, 0) rotateY(216deg) translateZ(180px); }
     .gallery-card:nth-child(5) { transform: translate3d(-50%, -50%, 0) rotateY(288deg) translateZ(180px); }
     .gallery-card.active { transform: translate3d(-50%, -50%, 200px) rotateY(0deg) scale(1.05); }
     .gallery-card .card-title { font-size: 0.9rem; }
     .gallery-card .card-description { display: none; }
     #gallery-section .section-heading h2 { font-size: 1.6rem; }
     #gallery-section .section-heading .lead { font-size: 0.9rem; margin-bottom: 1.5rem;}
     .gallery-nav { margin-top: 1.5rem; }
 }
    </style>

</head>
<body>
    <!-- Loading Screen -->
    <div class="loading-screen">
        <div class="loader"><div></div><div></div><div></div></div>
        <div class="loading-text">LOADING AURASTREAM</div>
    </div>

    <!-- Three.js Background Canvas & Noise Overlay -->
    <canvas id="three-bg-canvas"></canvas>
    <div class="noise-overlay"></div>

    <!-- Custom Navbar -->
    <header>
        <nav class="landing-navbar fixed-top">
            <a class="navbar-brand-landing" href="#">
                <i class="bi bi-stars"></i> AuraStream
            </a>
            <!-- Desktop Navigation Links -->
            <div class="nav-links-desktop d-none d-lg-flex">
                <ul class="navbar-nav flex-row">
                    <li class="nav-item"><a class="nav-link active" href="#hero">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="#content-showcase">Discover</a></li>
                    <li class="nav-item"><a class="nav-link" href="#features">Features</a></li>
                    <li class="nav-item"><a class="nav-link" href="#gallery-section">Gallery</a></li>
                    <li class="nav-item"><a class="nav-link" href="#analytics-dashboard">Insights</a></li>
                    <li class="nav-item"><a class="nav-link" href="#faq">FAQ</a></li>
                </ul>
            </div>
            <!-- Desktop Search and Auth Actions -->
            <div class="nav-actions d-none d-lg-flex align-items-center">
                <div class="search-bar">
                   <i class="bi bi-search"></i>
                   <input type="text" placeholder="Search..." id="nav-search-input">
                </div>
                <div id="auth-button-area">
                     <!-- Logged OUT View (Button triggers modal) -->
                     <button type="button" class="btn btn-primary-gradient btn-nav-cta" data-bs-toggle="modal" data-bs-target="#launchAppModal" id="login-signup-button">
                       Login / Sign Up
                     </button>
                      <!-- Logged IN View (Initially hidden, shown by JS) -->
                     <div class="d-none align-items-center" id="user-info-area">
                         <div id="user-avatar" class="user-avatar me-2" title="User Profile">
                             <span id="user-avatar-initials"></span>
                             <img id="user-avatar-image" src="" alt="Profile" class="d-none" />
                         </div>
                         <span id="user-display-name" class="me-3 text-light small fw-medium"></span>
                         <button type="button" class="btn btn-secondary-outline btn-sm" id="logout-button">
                             Logout
                         </button>
                     </div>
                  </div>
           </div>
           <!-- Mobile Menu Toggle Button -->
           <button class="mobile-menu-toggle d-lg-none" aria-label="Toggle navigation" id="mobile-menu-toggler">
                <i class="bi bi-list"></i>
           </button>
        </nav>

        <!-- Mobile Offcanvas Menu -->
        <div class="offcanvas-menu" id="mobile-menu">
            <button class="mobile-menu-toggle active" style="position: absolute; top: 1.5rem; right: 1.5rem;" aria-label="Close navigation" id="mobile-menu-close">
                <i class="bi bi-x"></i>
            </button>
            <ul class="nav-links-mobile">
                <li><a class="nav-link active" href="#hero">Home</a></li>
                <li><a class="nav-link" href="#content-showcase">Discover</a></li>
                <li><a class="nav-link" href="#features">Features</a></li>
                <li><a class="nav-link" href="#gallery-section">Gallery</a></li>
                <li><a class="nav-link" href="#analytics-dashboard">Insights</a></li>
                <li><a class="nav-link" href="#faq">FAQ</a></li>
            </ul>
            <div class="mobile-search search-bar mt-4 mb-4">
                <i class="bi bi-search"></i>
                <input type="text" placeholder="Search..." id="mobile-search-input">
            </div>
             <div class="mobile-launch-cta mt-auto">
                 <button type="button" class="btn btn-primary-gradient btn-nav-cta w-100" data-bs-toggle="modal" data-bs-target="#launchAppModal">
                     Launch App
                 </button>
             </div>
        </div>
        <div class="offcanvas-overlay" id="offcanvas-overlay"></div>
    </header>

    <!-- Main Content Wrapper -->
    <div class="landing-wrapper">
        <main>

            <!-- Hero Section -->
            <section id="hero" class="section">
                 <div class="hero-background"><div class="hero-background-image" id="hero-bg-image"></div></div>
                 <div class="container">
                     <div class="row">
                         <div class="col-lg-7 col-md-9">
                             <div class="hero-content" data-aos="fade-right" data-aos-delay="200">
                                 <h1 id="hero-title">Loading Universe...</h1>
                                 <p class="lead" id="hero-overview">Discover, track, and discuss your favorite movies and TV shows like never before.</p>
                                 <div class="hero-movie-info mb-4" id="hero-info-container">
                                    <!-- Skeleton Loader for Info - JS will replace this -->
                                    <div class="hero-info-item skeleton-item" style="width: 90px;"></div>
                                    <div class="hero-info-item skeleton-item" style="width: 70px;"></div>
                                    <div class="hero-info-item skeleton-item" style="width: 130px;"></div>
                                 </div>
                                 <div class="hero-cta-buttons">
                                     <button type="button" class="btn btn-primary-gradient btn-lg" id="hero-watch-trailer-btn" disabled>
                                        <i class="bi bi-play-circle-fill"></i> Watch Trailer
                                     </button>
                                     <button type="button" class="btn btn-secondary-outline btn-lg conceptual-link" id="hero-more-info-btn" title="More Info (Concept)" disabled>
                                         <i class="bi bi-info-circle"></i> More Info
                                     </button>
                                 </div>
                             </div>
                         </div>
                     </div>
                 </div>
            </section>

            <!-- Content Showcase Section -->
            <section id="content-showcase" class="section section-angled-top section-angled-bottom">
                 <div class="section-divider divider-top"><svg viewBox="0 0 1200 120" preserveAspectRatio="none"><path d="M321.39,56.44c58-10.79,114.16-30.13,172-41.86,82.39-16.72,168.19-17.73,250.45-.39C823.78,31,906.67,72,985.66,92.83c70.05,18.48,146.53,26.09,214.34,3V0H0V27.35A600.21,600.21,0,0,0,321.39,56.44Z" class="shape-fill"></path></svg></div>
                 <div class="section-divider divider-bottom"><svg viewBox="0 0 1200 120" preserveAspectRatio="none"><path d="M985.66,92.83C906.67,72,823.78,31,743.84,14.19c-82.39-16.72-168.19-17.73-250.45-.39-57.84,11.73-114,31.07-172,41.86A600.21,600.21,0,0,1,0,27.35V120H1200V95.83C1132.19,118.92,1055.71,111.31,985.66,92.83Z" class="shape-fill"></path></svg></div>
                 <div class="container-fluid position-relative" style="z-index: 10;">

                    <!-- Trending Movies Shelf -->
                    <div class="content-shelf" id="shelf-trending-movie" data-aos="fade-up">
                        <div class="shelf-header"> <h3 class="shelf-title"><i class="bi bi-graph-up-arrow"></i> Trending Movies</h3> <a href="#browse-trending-movies" class="shelf-view-all conceptual-link" title="View All Trending Movies (Concept)">View All <i class="bi bi-chevron-right"></i></a> </div>
                        <div class="horizontal-scroll-wrapper">
                            <button class="btn h-scroll-btn prev disabled" aria-label="Scroll Previous" aria-controls="trending-movies-scroll" aria-disabled="true"><i class="bi bi-chevron-left"></i></button>
                            <div class="horizontal-scroll-container" id="trending-movies-scroll" role="region" aria-label="Trending Movies Carousel">
                                <!-- JS Populates This - Placeholder shown -->
                                <div class="loading-shelf-text"><div class="loading-spinner"></div> Loading Trending Movies...</div>
                            </div>
                            <button class="btn h-scroll-btn next" aria-label="Scroll Next" aria-controls="trending-movies-scroll" aria-disabled="false"><i class="bi bi-chevron-right"></i></button>
                        </div>
                    </div>

                     <!-- Popular TV Shelf -->
                     <div class="content-shelf" id="shelf-popular-tv" data-aos="fade-up" data-aos-delay="100">
                         <div class="shelf-header"> <h3 class="shelf-title"><i class="bi bi-fire"></i> Popular TV Shows</h3> <a href="#browse-popular-tv" class="shelf-view-all conceptual-link" title="View All Popular TV Shows (Concept)">View All <i class="bi bi-chevron-right"></i></a> </div>
                         <div class="horizontal-scroll-wrapper">
                            <button class="btn h-scroll-btn prev disabled" aria-label="Scroll Previous" aria-controls="popular-tv-scroll" aria-disabled="true"><i class="bi bi-chevron-left"></i></button>
                            <div class="horizontal-scroll-container" id="popular-tv-scroll" role="region" aria-label="Popular TV Shows Carousel">
                               <!-- JS Populates This - Placeholder shown -->
                               <div class="loading-shelf-text"><div class="loading-spinner"></div> Loading Popular Shows...</div>
                            </div>
                            <button class="btn h-scroll-btn next" aria-label="Scroll Next" aria-controls="popular-tv-scroll" aria-disabled="false"><i class="bi bi-chevron-right"></i></button>
                         </div>
                     </div>

                    <!-- Top Rated Movies Shelf -->
                    <div class="content-shelf" id="shelf-toprated-movie" data-aos="fade-up" data-aos-delay="200">
                         <div class="shelf-header"> <h3 class="shelf-title"><i class="bi bi-star-fill"></i> Top Rated Movies</h3> <a href="#browse-toprated-movies" class="shelf-view-all conceptual-link" title="View All Top Rated Movies (Concept)">View All <i class="bi bi-chevron-right"></i></a> </div>
                         <div class="horizontal-scroll-wrapper">
                             <button class="btn h-scroll-btn prev disabled" aria-label="Scroll Previous" aria-controls="toprated-movies-scroll" aria-disabled="true"><i class="bi bi-chevron-left"></i></button>
                             <div class="horizontal-scroll-container" id="toprated-movies-scroll" role="region" aria-label="Top Rated Movies Carousel">
                                <!-- JS Populates This - Placeholder shown -->
                                <div class="loading-shelf-text"><div class="loading-spinner"></div> Loading Top Rated Movies...</div>
                             </div>
                             <button class="btn h-scroll-btn next" aria-label="Scroll Next" aria-controls="toprated-movies-scroll" aria-disabled="false"><i class="bi bi-chevron-right"></i></button>
                         </div>
                     </div>

                 </div>
            </section>

            <!-- Features Section -->
            <section id="features" class="section section-angled-top section-angled-bottom">
                 <div class="section-divider divider-top"><svg viewBox="0 0 1200 120" preserveAspectRatio="none"><path d="M985.66,92.83C906.67,72,823.78,31,743.84,14.19c-82.39-16.72-168.19-17.73-250.45-.39-57.84,11.73-114,31.07-172,41.86A600.21,600.21,0,0,1,0,27.35V120H1200V95.83C1132.19,118.92,1055.71,111.31,985.66,92.83Z" class="shape-fill"></path></svg></div>
                 <div class="section-divider divider-bottom"><svg viewBox="0 0 1200 120" preserveAspectRatio="none"><path d="M321.39,56.44c58-10.79,114.16-30.13,172-41.86,82.39-16.72,168.19-17.73,250.45-.39C823.78,31,906.67,72,985.66,92.83c70.05,18.48,146.53,26.09,214.34,3V0H0V27.35A600.21,600.21,0,0,0,321.39,56.44Z" class="shape-fill"></path></svg></div>
                 <div class="container position-relative" style="z-index: 10;">
                     <h2 class="text-center mb-4" data-aos="fade-up">Why <span class="text-gradient">AuraStream</span> Is Different</h2>
                      <p class="lead text-center mb-5 pb-3" data-aos="fade-up" data-aos-delay="100">We're building the ultimate platform for true entertainment lovers.</p>
                     <div class="feature-grid">
                          <article class="feature-item" data-aos="fade-up" data-aos-delay="200"> <i class="bi bi-compass-fill feature-icon"></i> <h4>Unified Discovery</h4> <p>Stop juggling apps. Find any movie or show across services with one powerful search.</p> </article>
                          <article class="feature-item" data-aos="fade-up" data-aos-delay="300"> <i class="bi bi-stars feature-icon"></i> <h4>Hyper-Personalized</h4> <p>Our smart system learns your taste, suggesting hidden gems and perfect next watches.</p> </article>
                          <article class="feature-item" data-aos="fade-up" data-aos-delay="400"> <i class="bi bi-collection-play-fill feature-icon"></i> <h4>Seamless Tracking</h4> <p>Effortlessly manage your watchlist, track progress, and know where to stream instantly.</p> </article>
                          <article class="feature-item" data-aos="fade-up" data-aos-delay="500"> <i class="bi bi-people-fill feature-icon"></i> <h4>Vibrant Community</h4> <p>Connect with fans, share reviews, discover curated lists, and join discussions (Coming Soon!).</p> </article>
                          <article class="feature-item" data-aos="fade-up" data-aos-delay="600"> <i class="bi bi-calendar-check-fill feature-icon"></i> <h4>Release Radar</h4> <p>Never miss a premiere. Get notified about new episodes, movies, and arrivals (Coming Soon!).</p> </article>
                          <article class="feature-item" data-aos="fade-up" data-aos-delay="700"> <i class="bi bi-phone-fill feature-icon"></i> <h4>Cross-Device Sync</h4> <p>Your watchlist, progress, and recommendations stay synced across all platforms.</p> </article>
                          <!-- Feature with Video Player -->
                          <article class="feature-item video-feature-demo" data-aos="fade-up" data-aos-delay="700"> <!-- Needs specific class -->
                            <i class="bi bi-play-btn-fill feature-icon"></i>
                            <h4>Interactive Preview</h4>
                            <p>See AuraStream in action with a quick interface demo.</p>
                            <div class="contained-video-player"> <!-- Video container -->
                              <video muted loop playsinline preload="metadata"> <!-- Video element -->
                                  <source src="brand.mp4" type="video/mp4" /> <!-- CHANGE to your video path -->
                                  Your browser does not support the video tag.
                              </video>
                              <div class="video-overlay-gradient"></div> <!-- Optional overlay -->
                              <button class="video-play-button" aria-label="Play Interface Demo"> <!-- Play button -->
                                <i class="bi bi-play-fill"></i>
                              </button>
                            </div>
                          </article>
                        </div>
                 </div>
             </section>

            <!-- Trailer Feature Section -->
             <section id="trailer-feature" class="section section-angled-top section-angled-bottom">
                  <div class="section-divider divider-top"><svg viewBox="0 0 1200 120" preserveAspectRatio="none"><path d="M321.39,56.44c58-10.79,114.16-30.13,172-41.86,82.39-16.72,168.19-17.73,250.45-.39C823.78,31,906.67,72,985.66,92.83c70.05,18.48,146.53,26.09,214.34,3V0H0V27.35A600.21,600.21,0,0,0,321.39,56.44Z" class="shape-fill"></path></svg></div>
                  <div class="section-divider divider-bottom"><svg viewBox="0 0 1200 120" preserveAspectRatio="none"><path d="M985.66,92.83C906.67,72,823.78,31,743.84,14.19c-82.39-16.72-168.19-17.73-250.45-.39-57.84,11.73-114,31.07-172,41.86A600.21,600.21,0,0,1,0,27.35V120H1200V95.83C1132.19,118.92,1055.71,111.31,985.66,92.83Z" class="shape-fill"></path></svg></div>
                  <div class="container position-relative" style="z-index: 10;">
                       <div class="trailer-feature-container">
                           <div class="trailer-text-content" data-aos="fade-right">
                               <h2 class="mb-3">Featured Trailer</h2>
                               <h3 id="trailer-feature-title">
                                   <!-- JS Populates This -->
                                   <span class="trailer-loading-placeholder">Loading Title...</span>
                               </h3>
                               <p id="trailer-feature-desc">
                                   <!-- JS Populates This -->
                                   <span class="trailer-loading-placeholder">Loading description...</span>
                               </p>
                               <button class="btn btn-secondary-outline conceptual-link" id="trailer-feature-more-info" disabled title="More Info (Concept)">
                                   <i class="bi bi-film me-2"></i> View Movie Details
                               </button>
                           </div>
                           <div class="trailer-visual" data-aos="fade-left" data-aos-delay="200">
                              <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class="trailer-thumbnail-img" id="trailer-feature-thumbnail" alt="Trailer Thumbnail Loading...">
                              <button class="btn btn-play trailer-play-button" id="trailer-feature-play-btn" aria-label="Play Featured Trailer" disabled>
                                <i class="bi bi-play-fill"></i>
                              </button>
                           </div>
                       </div>
                  </div>
             </section>

            <!-- 3D Gallery Section -->
            <section id="gallery-section" class="section section-angled-top section-angled-bottom">
                 <div class="section-divider divider-top"><svg viewBox="0 0 1200 120" preserveAspectRatio="none"><path d="M985.66,92.83C906.67,72,823.78,31,743.84,14.19c-82.39-16.72-168.19-17.73-250.45-.39-57.84,11.73-114,31.07-172,41.86A600.21,600.21,0,0,1,0,27.35V120H1200V95.83C1132.19,118.92,1055.71,111.31,985.66,92.83Z" class="shape-fill"></path></svg></div>
                 <div class="section-divider divider-bottom"><svg viewBox="0 0 1200 120" preserveAspectRatio="none"><path d="M321.39,56.44c58-10.79,114.16-30.13,172-41.86,82.39-16.72,168.19-17.73,250.45-.39C823.78,31,906.67,72,985.66,92.83c70.05,18.48,146.53,26.09,214.34,3V0H0V27.35A600.21,600.21,0,0,0,321.39,56.44Z" class="shape-fill"></path></svg></div>
                 <div class="galaxy-bg"></div>
                 <div class="container">
                     <div class="section-heading" data-aos="fade-up">
                         <h2>Experience <span class="text-gradient">AuraStream</span> UI</h2>
                         <div class="glow-line"></div>
                         <p class="lead">Explore our futuristic interface with immersive visuals and seamless integration across all your content.</p>
                     </div>
                     <div class="gallery-3d-container" data-aos="fade-up" data-aos-delay="200">
                         <div class="gallery-3d-stage" id="galleryStage">
                             <!-- JS can populate these or they can be hardcoded -->
                             <div class="gallery-card" data-index="0" data-name="Home Interface"><div class="card-front"><img src="images/gallery-home.jpg" alt="AuraStream Home" class="card-image" loading="lazy"><div class="card-overlay"></div><div class="card-content"><span class="card-tag">Dashboard</span><h3 class="card-title">Home Interface</h3><p class="card-description">Personalized content hub.</p></div></div></div>
                             <div class="gallery-card" data-index="1" data-name="Recommendations"><div class="card-front"><img src="images/gallery-recs.jpg" alt="AuraStream Recs" class="card-image" loading="lazy"><div class="card-overlay"></div><div class="card-content"><span class="card-tag">AI Powered</span><h3 class="card-title">Smart Suggestions</h3><p class="card-description">AI finds perfect matches.</p></div></div></div>
                             <div class="gallery-card" data-index="2" data-name="Watchlist"><div class="card-front"><img src="images/gallery-watchlist.jpg" alt="AuraStream Watchlist" class="card-image" loading="lazy"><div class="card-overlay"></div><div class="card-content"><span class="card-tag">Organization</span><h3 class="card-title">Watchlist</h3><p class="card-description">Track what you want to watch.</p></div></div></div>
                             <div class="gallery-card" data-index="3" data-name="Detailed View"><div class="card-front"><img src="images/gallery-detail.jpg" alt="AuraStream Detail" class="card-image" loading="lazy"><div class="card-overlay"></div><div class="card-content"><span class="card-tag">Info</span><h3 class="card-title">Detailed View</h3><p class="card-description">All info, cast, and options.</p></div></div></div>
                             <div class="gallery-card" data-index="4" data-name="Community Hub"><div class="card-front"><img src="images/gallery-community.jpg" alt="AuraStream Community" class="card-image" loading="lazy"><div class="card-overlay"></div><div class="card-content"><span class="card-tag">Connect</span><h3 class="card-title">Community Hub</h3><p class="card-description">Connect, review, discuss.</p></div></div></div>
                         </div>
                     </div>
                     <div class="gallery-nav" data-aos="fade-up" data-aos-delay="300">
                         <button class="nav-btn prev-btn" id="prevBtn" aria-label="Previous Gallery Item"><i class="bi bi-chevron-left"></i></button>
                         <div class="gallery-dots" id="galleryDots">
                             <button class="dot active" data-index="0" aria-label="Go to slide 1"></button>
                             <button class="dot" data-index="1" aria-label="Go to slide 2"></button>
                             <button class="dot" data-index="2" aria-label="Go to slide 3"></button>
                             <button class="dot" data-index="3" aria-label="Go to slide 4"></button>
                             <button class="dot" data-index="4" aria-label="Go to slide 5"></button>
                         </div>
                         <button class="nav-btn next-btn" id="nextBtn" aria-label="Next Gallery Item"><i class="bi bi-chevron-right"></i></button>
                     </div>
                 </div>
                 <div class="fullscreen-modal" id="fullscreenModal">
                     <div class="modal-content">
                         <button class="modal-close" id="modalClose" aria-label="Close fullscreen image"><i class="bi bi-x"></i></button>
                         <div class="modal-image-container">
                           <img src="" alt="Gallery Image Fullscreen" class="modal-image" id="modalImageFs">
                         </div>
                         <div class="modal-caption" id="modalCaptionFs">Image Caption</div>
                     </div>
                 </div>
             </section>

            <!-- Analytics Dashboard Section -->
            <section id="analytics-dashboard" class="section section-angled-top section-angled-bottom">
                 <div class="section-divider divider-top"><svg viewBox="0 0 1200 120" preserveAspectRatio="none"><path d="M321.39,56.44c58-10.79,114.16-30.13,172-41.86,82.39-16.72,168.19-17.73,250.45-.39C823.78,31,906.67,72,985.66,92.83c70.05,18.48,146.53,26.09,214.34,3V0H0V27.35A600.21,600.21,0,0,0,321.39,56.44Z" class="shape-fill"></path></svg></div>
                 <div class="section-divider divider-bottom"><svg viewBox="0 0 1200 120" preserveAspectRatio="none"><path d="M985.66,92.83C906.67,72,823.78,31,743.84,14.19c-82.39-16.72-168.19-17.73-250.45-.39-57.84,11.73-114,31.07-172,41.86A600.21,600.21,0,0,1,0,27.35V120H1200V95.83C1132.19,118.92,1055.71,111.31,985.66,92.83Z" class="shape-fill"></path></svg></div>
                 <div class="container position-relative" style="z-index: 10;">
                     <h2 class="text-center mb-4" data-aos="fade-up">AuraStream <span class="text-gradient">Insights</span></h2>
                     <p class="lead text-center mb-5 pb-3" data-aos="fade-up" data-aos-delay="100"> Explore the data behind the entertainment universe. See what's trending, popular, and highly-rated. </p>
                     <div class="analytics-grid">
                         <!-- Card 1: Key Metrics -->
                         <div class="analytics-card kpi-card" data-aos="fade-up" data-aos-delay="200">
                             <h4>Platform Overview</h4>
                             <div class="kpi-grid">
                                 <div class="kpi-item"><span class="kpi-value" id="kpi-total-titles">~</span><span class="kpi-label">Titles Tracked</span></div>
                                 <div class="kpi-item"><span class="kpi-value" id="kpi-active-users">~</span><span class="kpi-label">Active Users</span></div>
                                 <div class="kpi-item"><span class="kpi-value" id="kpi-avg-rating"><i class="bi bi-star-fill text-warning"></i> ~</span><span class="kpi-label">Avg. Rating</span></div>
                                 <div class="kpi-item"><span class="kpi-value" id="kpi-community-posts">~</span><span class="kpi-label">Discussions</span></div>
                             </div>
                         </div>
                         <!-- Card 2: Genre Distribution -->
                         <div class="analytics-card" data-aos="fade-up" data-aos-delay="300">
                             <h4>Popular Genres (Movies)</h4>
                             <div class="chart-container simulated-donut-chart" id="genre-donut-chart">
                                 <div class="donut-chart-visual"></div>
                                 <ul class="chart-legend">
                                     <li><span class="legend-color" style="background-color: var(--primary-accent);"></span>Action</li>
                                     <li><span class="legend-color" style="background-color: var(--secondary-accent);"></span>Sci-Fi</li>
                                     <li><span class="legend-color" style="background-color: var(--tertiary-accent);"></span>Comedy</li>
                                     <li><span class="legend-color" style="background-color: #ffc107;"></span>Drama</li>
                                     <li><span class="legend-color" style="background-color: #4caf50;"></span>Other</li>
                                 </ul>
                             </div>
                         </div>
                         <!-- Card 3: Trending Score -->
                         <div class="analytics-card" data-aos="fade-up" data-aos-delay="400">
                              <h4>Weekly Trend Score</h4>
                              <div class="chart-container simulated-gauge-chart">
                                 <div class="gauge-wrap">
                                      <div class="gauge-fill" id="gauge-fill-element" style="transform: rotate(0.5turn)"></div>
                                      <div class="gauge-cover"><span class="gauge-value" id="gauge-value-element">0%</span><span class="gauge-label">Trending</span></div>
                                 </div>
                                 <p class="chart-subtext">Based on recent activity.</p>
                              </div>
                         </div>
                          <!-- Card 4: Release Year Trend -->
                         <div class="analytics-card large-card" data-aos="fade-up" data-aos-delay="250">
                             <h4>Content Releases Over Time (Conceptual)</h4>
                             <div class="chart-container simulated-area-chart">
                                 <div class="area-chart-visual"> <svg viewBox="0 0 100 30" preserveAspectRatio="none"> <polyline fill="rgba(var(--primary-accent-rgb), 0.2)" stroke="var(--primary-accent)" stroke-width="0.5" points="0,25 10,20 20,22 30,15 40,18 50,12 60,16 70,10 80,14 90,8 100,12 100,30 0,30" /> </svg> </div>
                                 <div class="chart-axis-labels"><span>'20</span><span>'21</span><span>'22</span><span>'23</span><span>'24</span></div>
                             </div>
                         </div>
                         <!-- Card 5: Popular Actors -->
                         <div class="analytics-card" data-aos="fade-up" data-aos-delay="350">
                             <h4>Most Popular Actors</h4>
                             <div class="list-container scrollable-list" id="top-actors-list">
                                 <!-- JS Populates This --> <div class="loading-placeholder">Loading actors...</div>
                             </div>
                         </div>
                         <!-- Card 6: Top Networks/Studios -->
                          <div class="analytics-card" data-aos="fade-up" data-aos-delay="450">
                             <h4>Top Production Networks (Sample)</h4>
                             <div class="chart-container simulated-bar-chart" id="network-bar-chart">
                                 <!-- JS Populates This --> <div class="loading-placeholder">Loading networks...</div>
                             </div>
                         </div>
                     </div>
                 </div>
             </section>

            <!-- Available Everywhere Section -->
             <section id="available-everywhere" class="section section-angled-top section-angled-bottom">
                  <div class="section-divider divider-top"><svg viewBox="0 0 1200 120" preserveAspectRatio="none"><path d="M321.39,56.44c58-10.79,114.16-30.13,172-41.86,82.39-16.72,168.19-17.73,250.45-.39C823.78,31,906.67,72,985.66,92.83c70.05,18.48,146.53,26.09,214.34,3V0H0V27.35A600.21,600.21,0,0,0,321.39,56.44Z" class="shape-fill"></path></svg></div>
                  <div class="section-divider divider-bottom"><svg viewBox="0 0 1200 120" preserveAspectRatio="none"><path d="M985.66,92.83C906.67,72,823.78,31,743.84,14.19c-82.39-16.72-168.19-17.73-250.45-.39-57.84,11.73-114,31.07-172,41.86A600.21,600.21,0,0,1,0,27.35V120H1200V95.83C1132.19,118.92,1055.71,111.31,985.66,92.83Z" class="shape-fill"></path></svg></div>
                  <div class="container position-relative" style="z-index: 10;">
                      <div class="row align-items-center g-5">
                         <div class="col-lg-6 order-lg-2" data-aos="fade-left">
                              <h2 class="mb-4">Your Universe, <span class="text-gradient">Everywhere</span>.</h2>
                              <p class="lead mb-4">Access AuraStream seamlessly on your desktop, tablet, or mobile browser. Dedicated apps are launching soon!</p>
                              <ul class="platform-list">
                                  <li><i class="bi bi-display-fill"></i> Web Browser (Current Focus)</li>
                                  <li><i class="bi bi-tablet-landscape-fill"></i> Tablet Responsive</li>
                                  <li><i class="bi bi-apple"></i> Native iOS App <span class="coming-soon">Planned</span></li>
                                  <li><i class="bi bi-android2"></i> Native Android App <span class="coming-soon">Planned</span></li>
                                  <li><i class="bi bi-tv-fill"></i> TV App Support <span class="coming-soon">Future</span></li>
                              </ul>
                              <button type="button" class="btn btn-secondary-outline mt-3 conceptual-link" title="Platform Details (Concept)"> View Platform Roadmap </button>
                          </div>
                         <div class="col-lg-6 order-lg-1 text-center" data-aos="zoom-in-right">
                             <div class="device-graphic-placeholder"> <i class="bi bi-phone-stack"></i> <span>Conceptual Device Mockup</span> <small class="mt-2 opacity-75">Imagine AuraStream adapting to every screen.</small> </div>
                         </div>
                      </div>
                  </div>
             </section>

            <!-- FAQ Section -->
             <section id="faq" class="section section-angled-top section-angled-bottom">
                  <div class="section-divider divider-top"><svg viewBox="0 0 1200 120" preserveAspectRatio="none"><path d="M985.66,92.83C906.67,72,823.78,31,743.84,14.19c-82.39-16.72-168.19-17.73-250.45-.39-57.84,11.73-114,31.07-172,41.86A600.21,600.21,0,0,1,0,27.35V120H1200V95.83C1132.19,118.92,1055.71,111.31,985.66,92.83Z" class="shape-fill"></path></svg></div>
                  <div class="section-divider divider-bottom"><svg viewBox="0 0 1200 120" preserveAspectRatio="none"><path d="M321.39,56.44c58-10.79,114.16-30.13,172-41.86,82.39-16.72,168.19-17.73,250.45-.39C823.78,31,906.67,72,985.66,92.83c70.05,18.48,146.53,26.09,214.34,3V0H0V27.35A600.21,600.21,0,0,0,321.39,56.44Z" class="shape-fill"></path></svg></div>
                  <div class="container position-relative" style="z-index: 10; max-width: 900px;">
                     <h2 class="text-center mb-5" data-aos="fade-up">Answers to Your <span class="text-gradient">Burning Questions</span></h2>
                      <div class="accordion faq-accordion" id="faqAccordionLanding" data-aos="fade-up" data-aos-delay="100">
                          <div class="accordion-item">
                              <h3 class="accordion-header" id="faqH1"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faqC1" aria-expanded="false" aria-controls="faqC1">What exactly IS AuraStream?</button></h3>
                              <div id="faqC1" class="accordion-collapse collapse" aria-labelledby="faqH1" data-bs-parent="#faqAccordionLanding"><div class="accordion-body">AuraStream is your ultimate entertainment command center...</div></div>
                          </div>
                          <div class="accordion-item">
                              <h3 class="accordion-header" id="faqH2"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faqC2" aria-expanded="false" aria-controls="faqC2">Do I watch movies directly ON AuraStream?</button></h3>
                              <div id="faqC2" class="accordion-collapse collapse" aria-labelledby="faqH2" data-bs-parent="#faqAccordionLanding"><div class="accordion-body">No, AuraStream itself doesn't host or stream video content...</div></div>
                          </div>
                          <div class="accordion-item">
                              <h3 class="accordion-header" id="faqH3"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faqC3" aria-expanded="false" aria-controls="faqC3">Is AuraStream free to use?</button></h3>
                              <div id="faqC3" class="accordion-collapse collapse" aria-labelledby="faqH3" data-bs-parent="#faqAccordionLanding"><div class="accordion-body">The core features presented... are based on freely available APIs...</div></div>
                          </div>
                          <div class="accordion-item">
                              <h3 class="accordion-header" id="faqH4"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faqC4" aria-expanded="false" aria-controls="faqC4">What data sources power AuraStream?</button></h3>
                              <div id="faqC4" class="accordion-collapse collapse" aria-labelledby="faqH4" data-bs-parent="#faqAccordionLanding"><div class="accordion-body">We primarily use The Movie Database (TMDb) API...</div></div>
                          </div>
                           <div class="accordion-item">
                              <h3 class="accordion-header" id="faqH5"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faqC5" aria-expanded="false" aria-controls="faqC5">Is the 'Community' feature active?</button></h3>
                              <div id="faqC5" class="accordion-collapse collapse" aria-labelledby="faqH5" data-bs-parent="#faqAccordionLanding"><div class="accordion-body">The community features... are conceptual...</div></div>
                          </div>
                      </div>
                      <p class="text-center mt-5 text-muted" data-aos="fade-up">Still curious? Check the project <a href="https://github.com/MEDELBOU3/AuraStream-Concept" target="_blank" rel="noopener noreferrer" class="text-gradient fw-bold">on GitHub</a>.</p>
                  </div>
             </section>

            <!-- Final CTA Section -->
             <section id="final-cta" class="section section-lg">
                 <div class="container text-center" data-aos="zoom-in-up">
                      <h2>Ready to <span class="text-gradient">Explore</span> Your Entertainment?</h2>
                     <p class="lead"> Stop searching, start experiencing. Launch the AuraStream concept today for a smarter, more connected way to discover and enjoy the content you love. </p>
                     <button type="button" class="btn btn-cta-final btn-lg" data-bs-toggle="modal" data-bs-target="#launchAppModal">
                         Launch Concept App <i class="bi bi-rocket-takeoff-fill ms-2"></i>
                      </button>
                 </div>
             </section>

        </main>
    </div> <!-- /.landing-wrapper -->

    <!-- Footer -->
    <footer class="landing-footer">
         <div class="container footer-content">
              <div class="footer-column">
                  <a class="navbar-brand-landing d-block mb-3" href="#"> <i class="bi bi-stars"></i> AuraStream </a>
                  <p style="font-size: 0.85rem;">Your portal to the entertainment universe. Discover, track, and connect.</p>
              </div>
              <div class="footer-column">
                  <h4>Quick Links</h4>
                  <ul>
                      <li><a href="#hero"><i class="bi bi-chevron-right"></i> Home</a></li>
                      <li><a href="#content-showcase"><i class="bi bi-chevron-right"></i> Discover</a></li>
                      <li><a href="#features"><i class="bi bi-chevron-right"></i> Features</a></li>
                      <li><a href="#gallery-section"><i class="bi bi-chevron-right"></i> Gallery</a></li>
                      <li><a href="#faq"><i class="bi bi-chevron-right"></i> FAQ</a></li>
                  </ul>
              </div>
              <div class="footer-column">
                  <h4>Explore (Conceptual)</h4>
                  <ul>
                      <li><button type="button" class="btn btn-link p-0 conceptual-link footer-link"><i class="bi bi-chevron-right"></i> Movies</button></li>
                      <li><button type="button" class="btn btn-link p-0 conceptual-link footer-link"><i class="bi bi-chevron-right"></i> TV Shows</button></li>
                      <li><button type="button" class="btn btn-link p-0 conceptual-link footer-link"><i class="bi bi-chevron-right"></i> Community Hub</button></li>
                      <li><button type="button" class="btn btn-link p-0 conceptual-link footer-link"><i class="bi bi-chevron-right"></i> Blog / News</button></li>
                  </ul>
              </div>
              <div class="footer-column">
                  <h4>Connect</h4>
                  <div class="footer-social">
                      <a href="https://github.com/MEDELBOU3/AuraStream-Concept" class="social-icon" target="_blank" rel="noopener noreferrer" title="GitHub"><i class="bi bi-github"></i></a>
                      <a href="#" class="social-icon conceptual-link" target="_blank" rel="noopener noreferrer" title="Twitter / X"><i class="bi bi-twitter-x"></i></a>
                      <a href="#" class="social-icon conceptual-link" target="_blank" rel="noopener noreferrer" title="Discord"><i class="bi bi-discord"></i></a>
                  </div>
                  <p style="margin-top: 1rem; font-size: 0.85rem;">Follow the project's development.</p>
              </div>
         </div>
          <div class="footer-bottom">
               <p>© <span id="copy-year">2024</span> AuraStream Concept by MEDELBOU3. All Rights Reserved.</p> <!-- JS will update year -->
               <p>Movie data provided by <a href="https://www.themoviedb.org/" target="_blank" rel="noopener">TMDb</a>. This product uses the TMDb API but is not endorsed or certified by TMDb.</p>
               <p><button type="button" class="btn btn-link p-0 conceptual-link footer-link-bottom">Privacy Policy</button> | <button type="button" class="btn btn-link p-0 conceptual-link footer-link-bottom">Terms of Service</button></p>
          </div>
      </footer>

     <!-- Modals -->

     <!-- Launch App / Authentication Modal -->
     <div class="modal fade" id="launchAppModal" tabindex="-1" aria-labelledby="launchAppModalLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="launchAppModalLabel"><i class="bi bi-stars me-2"></i> Enter AuraStream</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" id="auth-modal-close-button"></button>
                </div>
                <div class="modal-body">
                    <!-- Nav tabs for Login/Signup -->
                    <ul class="nav nav-pills nav-fill mb-3" id="authTabs" role="tablist">
                        <li class="nav-item" role="presentation"><button class="nav-link active" id="login-tab" data-bs-toggle="tab" data-bs-target="#login-panel" type="button" role="tab" aria-controls="login-panel" aria-selected="true">Login</button></li>
                        <li class="nav-item" role="presentation"><button class="nav-link" id="signup-tab" data-bs-toggle="tab" data-bs-target="#signup-panel" type="button" role="tab" aria-controls="signup-panel" aria-selected="false">Sign Up</button></li>
                    </ul>
                    <!-- Tab Content -->
                    <div class="tab-content" id="authTabsContent">
                        <!-- Login Panel -->
                        <div class="tab-pane fade show active" id="login-panel" role="tabpanel" aria-labelledby="login-tab">
                            <form id="login-form" novalidate>
                                <div class="mb-3"><label for="login-email" class="form-label">Email address</label><input type="email" class="form-control form-control-lg" id="login-email" placeholder="name@example.com" required></div>
                                <div class="mb-3"><label for="login-password" class="form-label">Password</label><input type="password" class="form-control form-control-lg" id="login-password" placeholder="Password" required></div>
                                <div class="d-grid mb-3"><button type="submit" class="btn btn-primary-gradient btn-lg">Login</button></div>
                            </form>
                            <div class="text-center text-muted my-3">OR</div>
                            <div class="d-grid"><button type="button" class="btn btn-light btn-lg border" id="google-login-button"><img src="https://developers.google.com/identity/images/g-logo.png" alt="Google logo" width="20" height="20" class="me-2"> Login with Google</button></div>
                        </div>
                        <!-- Sign Up Panel -->
                        <div class="tab-pane fade" id="signup-panel" role="tabpanel" aria-labelledby="signup-tab">
                             <form id="signup-form" novalidate>
                                <div class="mb-3"><label for="signup-name" class="form-label">Full Name</label><input type="text" class="form-control form-control-lg" id="signup-name" placeholder="Your Full Name" required></div>
                                <div class="mb-3"><label for="signup-age" class="form-label">Age</label><input type="number" class="form-control form-control-lg" id="signup-age" placeholder="Your Age" required min="1"></div>
                                <div class="mb-3"><label for="signup-email" class="form-label">Email address</label><input type="email" class="form-control form-control-lg" id="signup-email" placeholder="name@example.com" required></div>
                                <div class="mb-3"><label for="signup-password" class="form-label">Password</label><input type="password" class="form-control form-control-lg" id="signup-password" placeholder="Choose a strong password" required minlength="6"><div class="form-text">Minimum 6 characters</div></div>
                                <div class="mb-3"><label for="signup-avatar" class="form-label">Profile Picture (Optional)</label><input type="file" class="form-control form-control-lg" id="signup-avatar" accept="image/png, image/jpeg, image/gif"><div class="form-text">Upload an image for your avatar.</div></div>
                                <div class="d-grid mb-3"><button type="submit" class="btn btn-success btn-lg">Sign Up</button></div>
                            </form>
                            <div class="text-center text-muted my-3">OR</div>
                            <div class="d-grid"><button type="button" class="btn btn-light btn-lg border" id="google-signup-button"><img src="https://developers.google.com/identity/images/g-logo.png" alt="Google logo" width="20" height="20" class="me-2"> Sign Up with Google</button></div>
                        </div>
                    </div>
                    <!-- Error Message Area -->
                    <div id="auth-error-message" class="alert alert-danger mt-3 d-none" role="alert"></div>
                </div> <!-- /modal-body -->
            </div>
        </div>
    </div>

     <!-- Trailer Modal -->
     <div class="modal fade" id="trailer-modal" tabindex="-1" aria-labelledby="trailerModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-xl"> <!-- Use modal-xl for larger video -->
          <div class="modal-content" style="background-color: #000; border: none;"> <!-- Dark background -->
              <!-- Close button positioned better -->
              <button type="button" class="modal-close-video" data-bs-dismiss="modal" aria-label="Close"><i class="bi bi-x-lg"></i></button>
              <div class="modal-body p-0"> <!-- Remove padding -->
                  <div class="video-container"> <!-- Aspect ratio container -->
                      <iframe id="trailer-iframe" src="" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
                  </div>
              </div>
          </div>
      </div>
    </div>


    <!-- ================================= -->
    <!-- === VENDOR & CORE JS LIBS === -->
    <!-- ================================= -->
    <!-- Bootstrap -->
    <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Animate On Scroll -->
    <script defer src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <!-- Bootstrap Toasts (Optional, if used by conceptual links or other feedback) -->
    <script defer src="https://unpkg.com/bs5-toast@1.0.0/dist/bs5-toast.min.js"></script>
    <!-- Three.js (Loaded earlier, non-defer, as it's needed for background setup) -->
    <script src="https://unpkg.com/three@0.160.0/build/three.min.js"></script>


    <!-- ================================= -->
    <!-- === FIREBASE SDK SCRIPTS === -->
    <!-- Load v9 Compat libraries - order matters! -->
    <!-- ================================= -->
    <!-- Firebase App (Core) -->
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <!-- Firebase Authentication -->
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-auth-compat.js"></script>
    <!-- Firebase Cloud Storage (for avatar uploads) -->
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-storage-compat.js"></script>
    <!-- Firebase Firestore (for storing age/other user data) -->
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore-compat.js"></script>
    <script>
        /**
         * AuraStream Landing Page Script v9.5 (COMPLETE & COMBINED)
         * Includes all modules and logic implemented fully.
         */
    
        // --- Main Application Object ---
        const AuraStreamApp = {
    
            // --- Configuration ---
            config: {
                // VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV
                //  CRITICAL: REPLACE WITH YOUR VALID TMDB API KEY! GET ONE FROM themoviedb.org (Free)
                // VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV
                TMDB_API_KEY: '431fb541e27bceeb9db2f4cab69b54e1', // <<<--- YOUR REAL KEY
    
                TMDB_BASE_URL: 'https://api.themoviedb.org/3',
                IMAGE_BASE_URL: 'https://image.tmdb.org/t/p/',
                POSTER_SIZE: 'w500',
                PROFILE_SIZE: 'w185',
                BACKDROP_SIZE: 'w1280', // Used for trailer feature thumbnail
                HERO_BACKDROP_SIZE: 'original', // Highest quality for hero
                YOUTUBE_EMBED_URL: 'https://www.youtube.com/embed/',
    
                CONTENT_SHELVES: [
                    { id: 'trending-movie', title: 'Trending Movies', endpoint: '/trending/movie/week', containerSelector: '#trending-movies-scroll', type: 'movie', params: {}, ariaControls: 'trending-movies-scroll' },
                    { id: 'popular-tv', title: 'Popular TV Shows', endpoint: '/tv/popular', containerSelector: '#popular-tv-scroll', type: 'tv', params: {}, ariaControls: 'popular-tv-scroll'},
                    { id: 'toprated-movie', title: 'Top Rated Movies', endpoint: '/movie/top_rated', containerSelector: '#toprated-movies-scroll', type: 'movie', params: { region: 'US' }, ariaControls: 'toprated-movies-scroll' },
                ],
    
                HERO_UPDATE_INTERVAL: 90000,
                AOS_CONFIG: { duration: 700, once: true, offset: 80, easing: 'ease-out-cubic' },
                SCROLL_DEBOUNCE: 150,
                RESIZE_DEBOUNCE: 250,
                LOADING_SCREEN_FADE_DURATION: 700,
                THREE_PARTICLE_COUNT: 6500,
                THREE_GALAXY_RADIUS: 600,
                THREE_PARTICLE_SIZE: 0.8,
                THREE_PARTICLE_OPACITY: 0.7,
                THREE_ANIMATED_OBJ_OPACITY: 0.1,
                GALLERY_AUTO_ROTATE_DELAY: 12000,
                GALLERY_AUTO_ROTATE_INTERVAL: 6000,
                GALLERY_PERSPECTIVE: 1200,
                GALLERY_CARD_WIDTH: 340,
                GALLERY_CARD_HEIGHT: 220,
                GALLERY_TRANSLATE_Z_BASE: 290,
                GALLERY_TRANSLATE_Z_ACTIVE: 340,
                GALLERY_SCALE_ACTIVE: 1.1,
                INTRO_VIDEO_TIMEOUT_MS: 0,
                AUTH_REDIRECT_URL: 'app2.html',
    
                // --- Firebase Configuration ---
                // IMPORTANT: Replace ALL placeholders with your actual Firebase project config!
                firebaseConfigApp :{
                    apiKey: "AIzaSyDp2V0ULE-32AcIJ92a_e3mhMe6f6yZ_H4", // ***** REPLACE *****
                    authDomain: "sm4movies.firebaseapp.com",           // ***** REPLACE *****
                    projectId: "sm4movies",                      // ***** REPLACE *****
                    storageBucket: "sm4movies.appspot.com",       // ***** REPLACE *****
                    messagingSenderId: "277353836953",           // ***** REPLACE *****
                    appId: "1:277353836953:web:85e02783526c7cb58de308", // ***** REPLACE *****
                },
    
                DEBUG_MODE: true,
            },
    
            // --- Application State ---
            state: {
                domReady: false, apiKeyValid: false, initializationComplete: false, introHidden: false, isMobileMenuOpen: false,
                librariesLoaded: { three: false, bootstrap: false, aos: false },
                heroMovie: null, featuredTrailerMovieId: null, movieVideosCache: new Map(), shelfScrollData: new Map(),
                galleryAutoRotateTimeout: null, galleryAutoRotateInterval: null, isGalleryDragging: false,
                threeAnimationId: null,
                isLoggedIn: false, currentUser: null, firebaseApp: null, firebaseAuth: null, firebaseStorage: null, firebaseFirestore: null, authListenerUnsubscribe: null
            },
    
            // --- DOM Element Cache ---
            elements: {}, // Populated by initDomElements
    
            // --- Utility Functions ---
            utils: {
                log: function(message, ...optionalParams) { if (AuraStreamApp.config.DEBUG_MODE) console.log(`[AuraStream] ${message}`, ...optionalParams); },
                error: function(message, ...optionalParams) { console.error(`[AuraStream Error] ${message}`, ...optionalParams); },
                warn: function(message, ...optionalParams) { console.warn(`[AuraStream Warn] ${message}`, ...optionalParams); },
                escapeHtml: (unsafe) => { if (unsafe === null || typeof unsafe === 'undefined') return ''; return String(unsafe).replace(/&/g, "&").replace(/</g, "<").replace(/>/g, ">").replace(/"/g, "").replace(/'/g, "'"); },
                debounce: (func, delay) => { let timeoutId; return (...args) => { clearTimeout(timeoutId); timeoutId = setTimeout(() => { func.apply(this, args); }, delay); }; },
                fetchTMDB: async (endpoint, params = {}) => {
                     const config = AuraStreamApp.config; const utils = AuraStreamApp.utils;
                     if (!AuraStreamApp.state.apiKeyValid) { utils.error("API Key is invalid. Fetch aborted."); return null; }
                     const defaultParams = { api_key: config.TMDB_API_KEY, language: 'en-US' };
                     const urlParams = new URLSearchParams({ ...defaultParams, ...params });
                     for (const [key, value] of urlParams.entries()) { if (value === null || value === '' || value === 'undefined') urlParams.delete(key); }
                     const url = `${config.TMDB_BASE_URL}${endpoint}?${urlParams.toString()}`;
                     try {
                         const response = await fetch(url);
                         if (!response.ok) {
                             let errorData = { status_message: `HTTP error! Status: ${response.status}` }; try { errorData = await response.json(); } catch (e) { utils.warn(`Could not parse JSON error for ${endpoint}`); }
                             utils.error(`TMDB API Error ${response.status} for ${endpoint}:`, errorData); if (response.status === 401) { utils.error("API Error 401: Unauthorized. Check API Key."); AuraStreamApp.state.apiKeyValid = false; AuraStreamApp.modules?.loadingScreen?.showError("Invalid API Key"); AuraStreamApp.displayDataLoadingErrors("Invalid API Key");} return null;
                         }
                         const data = await response.json(); return data;
                     } catch (error) { utils.error(`TMDB Fetch Network Error (${endpoint}):`, error); AuraStreamApp.modules?.loadingScreen?.showError("Network Error"); AuraStreamApp.displayDataLoadingErrors("Network Error"); return null; }
                },
                getLoadingTextHTML: (text = "Loading...") => `<div class="loading-shelf-text w-100 d-flex align-items-center justify-content-center py-4" role="status"><div class="loading-spinner me-2"></div> ${AuraStreamApp.utils.escapeHtml(text)}</div>`,
                getErrorTextHTML: (text = "Could not load content.") => `<div class="error-shelf-text w-100 d-flex align-items-center justify-content-center py-4 text-danger" role="alert"><i class="bi bi-exclamation-triangle-fill me-2"></i> ${AuraStreamApp.utils.escapeHtml(text)}</div>`,
                getSkeletonCardHTML: () => ` <div class="movie-card skeleton-placeholder" aria-hidden="true"> <div class="card-image-wrapper skeleton-item"></div> <div class="card-content"> <div class="skeleton-item title mb-2"></div> <div class="skeleton-item meta"></div> </div> <style> .skeleton-item { background: linear-gradient(110deg, rgba(var(--border-color-rgb, 55 65 81),0.2) 8%, rgba(var(--border-color-rgb, 55 65 81),0.3) 18%, rgba(var(--border-color-rgb, 55 65 81),0.2) 33%); background-size: 200% 100%; border-radius: var(--radius-sm); animation: 1.8s pulse-skeleton linear infinite; } .skeleton-placeholder .title { height: 1rem; width: 85%; } .skeleton-placeholder .meta { height: 0.7rem; width: 55%; } @keyframes pulse-skeleton { 0% { background-position: 100% 0; } 100% { background-position: -100% 0; } } </style> </div>`,
                getSkeletonShelfHTML: (count = 6) => { let h = ''; for (let i = 0; i < count; i++) h += AuraStreamApp.utils.getSkeletonCardHTML(); return h; },
                formatDate: (d) => { if (!d) return 'N/A'; try { return new Date(d).toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' }); } catch (e) { return 'Invalid Date'; } },
                getYear: (d) => { if (!d) return ''; try { return new Date(d).getFullYear(); } catch (e) { return ''; } },
                fetchMovieVideos: async function(movieId) { const utils=AuraStreamApp.utils;if(AuraStreamApp.state.movieVideosCache.has(movieId))return AuraStreamApp.state.movieVideosCache.get(movieId);if(!movieId)return[];const data=await utils.fetchTMDB(`/movie/${movieId}/videos`);if(!data){AuraStreamApp.state.movieVideosCache.set(movieId,[]);return[]}const videos=data?.results?.filter(v=>v.site==='YouTube')||[];AuraStreamApp.state.movieVideosCache.set(movieId,videos);return videos},
                getBestTrailer: (vids) => { if(!vids||vids.length===0)return null;const t=vids.find(v=>v.type==='Trailer'&&v.official);if(t)return t;const ot=vids.find(v=>v.type==='Teaser'&&v.official);if(ot)return ot;const at=vids.find(v=>v.type==='Trailer');if(at)return at;const ayt=vids.find(v=>v.type==='Teaser');if(ayt)return ayt;const c=vids.find(v=>v.type==='Clip'||v.type==='Featurette');if(c)return c;return vids[0]||null },
                setCopyrightYear: () => { try { const el = AuraStreamApp.elements.copyYear; if(el) el.textContent = new Date().getFullYear(); else AuraStreamApp.utils.warn("Copyright year element not found."); } catch(e) { AuraStreamApp.utils.error("Error setting copyright year:", e); } },
                getCssVariable: (v, f) => { try { let val = getComputedStyle(document.documentElement).getPropertyValue(v).trim(); return val || f; } catch (e) { return f; } },
                getInitials: (name = '', email = '') => { if (name && name.trim().length > 0) { const parts = name.trim().split(' ').filter(Boolean); if (parts.length > 1) return (parts[0][0] + parts[parts.length - 1][0]).toUpperCase(); if (parts[0]?.length > 0) return parts[0].substring(0, 2).toUpperCase();} if (email && email.includes('@')) return email[0].toUpperCase(); return '??';}
            },
    
            // --- API Key Validation ---
            validateApiKey: function() {
                 const utils = this.utils; const key = this.config.TMDB_API_KEY; let isValid = true; utils.log("Validating TMDB API Key Structure..."); if (!key || key === 'YOUR_TMDB_API_KEY' || key.length < 30) { utils.error("TMDB API Key FAIL: Key is missing, placeholder, or too short."); isValid = false; } this.state.apiKeyValid = isValid; if (!isValid) utils.error(">>> ACTION REQUIRED: Set a valid TMDB API key in config. <<<"); else utils.log("TMDB API Key structure appears OK.");
            },
    
            // --- Display Global Data Loading Errors ---
            displayDataLoadingErrors: function(message = "Cannot load data: Check API Key or Network.") {
                 const utils = this.utils; utils.warn(`Displaying data loading errors: ${message}`); const errorHtml = utils.getErrorTextHTML(message); this.modules.hero.handleInitialLoadFailure(message); this.config.CONTENT_SHELVES.forEach(shelf => { try { const container = document.querySelector(shelf.containerSelector); if (container) { container.innerHTML = errorHtml; const wrapper = container.closest('.horizontal-scroll-wrapper'); wrapper?.querySelectorAll('.h-scroll-btn').forEach(btn => btn.classList.add('disabled')); } else utils.warn(`Shelf container not found: ${shelf.containerSelector}`); } catch (e) { utils.error(`Error display shelf ${shelf.id}:`, e); } }); try { if (this.elements.trailerFeatureSection) this.modules.trailerFeature.displayError(message); } catch (e) { utils.error("Error display trailer:", e); } try { if (document.getElementById('analytics-dashboard')) this.modules.analyticsDashboard.displayError(message); } catch (e) { utils.error("Error display analytics:", e); }
            },
    
            // --- Initialization Orchestration ---
            init: function() {
                this.utils.log("AuraStream Landing (v9.5 - Complete) Initializing...");
                if (this.state.initializationComplete || this.state.domReady) { this.utils.warn("Initialization already run/in progress."); return; }
                document.addEventListener('DOMContentLoaded', () => {
                    this.utils.log("DOM Loaded. Starting App Initialization Sequence."); this.state.domReady = true;
                    try {
                        this.utils.log("Phase 1: Critical Setup...");
                        if (!this.initDomElements()) throw new Error("Essential DOM elements missing.");
                        this.validateApiKey(); this.checkLibraries();
    
                        this.utils.log("Phase 2: Initializing Firebase and Auth Listener...");
                        if (!this.initializeFirebase()) {
                            this.utils.error("Firebase init failed. Auth features disabled.");
                            if(this.state.apiKeyValid) { this.utils.warn("Firebase failed, API key OK -> Manual async trigger."); this.runAsyncInits(); }
                            else { this.utils.warn("Firebase failed AND API key invalid. No data load."); this.displayDataLoadingErrors("Firebase Init Failed & Invalid API Key"); }
                        }
    
                        this.utils.log("Phase 3: Synchronous UI Module Init...");
                        this.initSyncModules();
    
                        this.utils.log("Phase 4: Visual Enhancements Init...");
                        this.initVisualLibraries();
    
                        this.utils.log("Phase 5: Handle Loading Screen...");
                        if (this.elements.loadingScreen) { this.utils.log("Hiding initial loading screen."); this.elements.loadingScreen.classList.add('hidden'); setTimeout(() => this.elements.loadingScreen.remove(), this.config.LOADING_SCREEN_FADE_DURATION + 100); }
    
                        this.utils.log(`AuraStream Initial Sync Setup Finished. API Key Valid: ${this.state.apiKeyValid}. Waiting for Auth & Async...`);
    
                    } catch (error) { this.utils.error("CRITICAL ERROR during Main Initialization Sequence:", error); try { document.body.innerHTML = `<div style="position:fixed; inset:0; background:var(--bg-primary); color:red; display:flex; flex-direction:column; align-items:center; justify-content:center; padding:20px; text-align:center; z-index:10000;"><h1>Application Initialization Failed</h1><p>Could not start AuraStream. Please check the console (F12) for errors or refresh the page.</p><pre style="max-width: 80%; overflow:auto; background:var(--bg-secondary); padding:10px; border-radius:5px; font-size:0.8em; text-align:left;">${error.message}\n${error.stack}</pre></div>`; } catch (renderError) { alert(`Critical Initialization Error: ${error.message}. Please check the console.`); } }
                });
            },
    
            // --- Firebase Initialization ---
            initializeFirebase: function() {
                 const utils = this.utils; const config = this.config.firebaseConfig; const state = this.state; const app = AuraStreamApp;
                 utils.log("Initializing Firebase...");
                 if (!config?.apiKey || !config?.authDomain || !config?.projectId || config.apiKey === "YOUR_API_KEY") { utils.error("Firebase config missing/invalid."); return false; }
                 if (!config.storageBucket) utils.warn("Firebase storageBucket missing. Uploads will fail.");
                 if (!config.projectId) utils.warn("Firebase projectId missing.");
                 if (typeof firebase === 'undefined' || !firebase.app || !firebase.auth || !firebase.storage || !firebase.firestore) { utils.error("Required Firebase SDKs not loaded."); return false; }
                 try {
                     if (!state.firebaseApp) {
                         state.firebaseApp = firebase.initializeApp(config); state.firebaseAuth = firebase.auth();
                         try { if (config.storageBucket) { state.firebaseStorage = firebase.storage(); utils.log("Firebase Storage initialized."); } else state.firebaseStorage = null; } catch (e) { utils.error("Storage init failed:", e); state.firebaseStorage = null; }
                         try { if (config.projectId) { state.firebaseFirestore = firebase.firestore(); utils.log("Firestore initialized."); } else state.firebaseFirestore = null; } catch (e) { utils.error("Firestore init failed:", e); state.firebaseFirestore = null; }
                         utils.log("Firebase App & Auth initialized.");
                     }
                     if (!state.authListenerUnsubscribe && state.firebaseAuth) {
                         utils.log("Attaching Firebase onAuthStateChanged listener...");
                         state.authListenerUnsubscribe = state.firebaseAuth.onAuthStateChanged(user => {
                             utils.log(`Firebase onAuthStateChanged: User is ${user ? 'LOGGED IN' : 'LOGGED OUT'}`);
                             const isInitialAuthCheck = !state.initializationComplete;
                             if (user) { state.isLoggedIn = true; state.currentUser = { uid: user.uid, email: user.email, displayName: user.displayName, photoURL: user.photoURL }; }
                             else { state.isLoggedIn = false; state.currentUser = null; }
                             app.modules.auth.updateAuthUI();
                             if (isInitialAuthCheck) {
                                 utils.log("Processing initial auth check tasks...");
                                 if (state.apiKeyValid) { utils.log("TMDB key valid -> Running async TMDB data fetches..."); app.runAsyncInits(); }
                                 else { utils.warn("TMDB key invalid. Will display errors post-intro."); if (state.introHidden) app.displayDataLoadingErrors("Invalid API Key"); }
                                 state.initializationComplete = true; utils.log("Initial Auth check complete. Main sync init finished.");
                             }
                             const authModalIsShowing = app.elements.launchAppModal?.classList.contains('show');
                             if (user && !isInitialAuthCheck && authModalIsShowing) { utils.log("Post-initial auth change detected via modal -> Redirecting..."); app.modules.modals.closeAuthModal(); setTimeout(() => { window.location.href = app.config.AUTH_REDIRECT_URL; }, 200); }
                             if (!state.introHidden && app.modules?.introVideo?.hideOverlay) { utils.log("Auth resolved before intro finished. Hiding intro."); app.modules.introVideo.hideOverlay(true); }
                         }); utils.log("Firebase onAuthStateChanged listener attached.");
                     } return true;
                 } catch (error) { utils.error("CRITICAL Firebase initialization failed:", error); app.modules?.auth?.updateAuthUI(); if (state.apiKeyValid) app.displayDataLoadingErrors("Firebase Init Failed"); return false; }
             },
    
            // --- Library Checks ---
            checkLibraries: function() { this.state.librariesLoaded.three = typeof THREE !== 'undefined'; this.state.librariesLoaded.bootstrap = typeof bootstrap !== 'undefined'; this.state.librariesLoaded.aos = typeof AOS !== 'undefined'; this.utils.log("Libraries Checked:", this.state.librariesLoaded); if(!this.state.librariesLoaded.bootstrap) this.utils.error("Bootstrap JS missing!"); if(!this.state.librariesLoaded.aos) this.utils.warn("AOS missing."); if(!this.state.librariesLoaded.three) this.utils.warn("Three.js missing."); },
    
            // --- DOM Element Caching ---
            initDomElements: function() {
                this.utils.log("Caching DOM Elements...");
                const els = {
                    loadingScreen: document.querySelector('.loading-screen'), threeCanvas: document.getElementById('three-bg-canvas'), navbar: document.querySelector('.landing-navbar'), mobileMenuToggle: document.getElementById('mobile-menu-toggler'), mobileMenuClose: document.getElementById('mobile-menu-close'), mobileMenu: document.getElementById('mobile-menu'), offcanvasOverlay: document.getElementById('offcanvas-overlay'),
                    heroSection: document.getElementById('hero'), heroBgImage: document.getElementById('hero-bg-image'), heroTitle: document.getElementById('hero-title'), heroOverview: document.getElementById('hero-overview'), heroInfoContainer: document.getElementById('hero-info-container'), heroWatchTrailerBtn: document.getElementById('hero-watch-trailer-btn'), heroMoreInfoBtn: document.getElementById('hero-more-info-btn'),
                    trailerFeatureSection: document.getElementById('trailer-feature'), trailerFeatureTitle: document.getElementById('trailer-feature-title'), trailerFeatureDesc: document.getElementById('trailer-feature-desc'), trailerFeatureThumbnail: document.getElementById('trailer-feature-thumbnail'), trailerFeaturePlayBtn: document.getElementById('trailer-feature-play-btn'), trailerFeatureMoreInfoBtn: document.getElementById('trailer-feature-more-info'),
                    gallerySection: document.getElementById('gallery-section'), galleryStage: document.getElementById('galleryStage'), galleryCards: document.querySelectorAll('#gallery-section .gallery-card'), galleryDotsContainer: document.getElementById('galleryDots'), galleryDots: document.querySelectorAll('#gallery-section .dot'), galleryPrevBtn: document.getElementById('prevBtn'), galleryNextBtn: document.getElementById('nextBtn'), galleryFullscreenModal: document.getElementById('fullscreenModal'), galleryModalImageFs: document.getElementById('modalImageFs'), galleryModalCaptionFs: document.getElementById('modalCaptionFs'), galleryModalCloseFs: document.getElementById('modalClose'),
                    kpiTotalTitles: document.getElementById('kpi-total-titles'), kpiActiveUsers: document.getElementById('kpi-active-users'), kpiAvgRating: document.getElementById('kpi-avg-rating'), kpiCommunityPosts: document.getElementById('kpi-community-posts'), topActorsList: document.getElementById('top-actors-list'),
                    gaugeFillElement: document.getElementById('gauge-fill-element'), gaugeValueElement: document.getElementById('gauge-value-element'), networkBarChart: document.getElementById('network-bar-chart'),
                    videoFeatureDemoPlayer: document.querySelector('.contained-video-player'), videoFeatureDemoVideo: document.querySelector('.contained-video-player video'), videoFeatureDemoPlayButton: document.querySelector('.contained-video-player .video-play-button'),
                    copyYear: document.getElementById('copy-year'),
                    launchAppModal: document.getElementById('launchAppModal'), trailerModal: document.getElementById('trailer-modal'), trailerIframe: document.getElementById('trailer-iframe'),
                    loginForm: document.getElementById('login-form'), signupForm: document.getElementById('signup-form'), loginEmailInput: document.getElementById('login-email'), loginPasswordInput: document.getElementById('login-password'), signupNameInput: document.getElementById('signup-name'), signupAgeInput: document.getElementById('signup-age'), signupEmailInput: document.getElementById('signup-email'), signupPasswordInput: document.getElementById('signup-password'), signupAvatarInput: document.getElementById('signup-avatar'),
                    googleLoginButton: document.getElementById('google-login-button'), googleSignupButton: document.getElementById('google-signup-button'), authErrorMessage: document.getElementById('auth-error-message'),
                    authButtonArea: document.getElementById('auth-button-area'), loginSignupButton: document.getElementById('login-signup-button'), userInfoArea: document.getElementById('user-info-area'), userAvatar: document.getElementById('user-avatar'), userAvatarInitials: document.getElementById('user-avatar-initials'), userAvatarImage: document.getElementById('user-avatar-image'), userDisplayName: document.getElementById('user-display-name'), logoutButton: document.getElementById('logout-button'),
                    introOverlay: document.getElementById('intro-overlay'), introVideo: document.querySelector('#intro-overlay video'), skipIntroButton: document.getElementById('skip-intro-button'),
                };
                const essentialKeys = ['navbar', 'heroSection', 'launchAppModal', 'loginForm', 'signupForm', 'authButtonArea', 'loginSignupButton', 'userInfoArea', 'logoutButton'];
                const missingElements = essentialKeys.filter(key => !els[key]);
                if (missingElements.length > 0) { this.utils.error(`Critical DOM elements missing: ${missingElements.join(', ')}.`); this.elements = {}; return false; }
                this.elements = els; this.utils.log("DOM Elements Cached."); return true;
            },
    
            // --- Initialize Synchronous Modules ---
            initSyncModules: function() {
                const modulesToInit = [ this.modules.auth, this.modules.navbar, this.modules.smoothScroll, this.modules.conceptualLinks, this.modules.modals, this.modules.faq, this.modules.featureVideoPlayer, this.modules.gallery3D, this.modules.analyticsDashboard ];
                this.utils.log(`Initializing ${modulesToInit.length} sync modules...`); modulesToInit.forEach(module => { if (module?.init) { const moduleName = module.name || module.constructor?.name || 'Module'; try { this.utils.log(` -> Init sync: ${moduleName}`); module.init(); } catch (e) { this.utils.error(`Error init sync ${moduleName}:`, e); } } else this.utils.warn("Module missing init function."); }); this.utils.setCopyrightYear();
            },
    
            // --- Initialize Visual Libraries ---
            initVisualLibraries: function() {
                if (this.state.librariesLoaded.three && this.elements.threeCanvas) { try { this.utils.log("Init Three.js..."); this.modules.threeBackground.init(); } catch (e) { this.utils.error("Three.js Init failed:", e); if(this.elements.threeCanvas) this.elements.threeCanvas.style.display = 'none'; } } else { this.utils.warn("Three.js disabled."); if(this.elements.threeCanvas) this.elements.threeCanvas.style.display = 'none'; }
                if (this.state.librariesLoaded.aos) { try { this.utils.log("Init AOS..."); AOS.init(this.config.AOS_CONFIG); } catch (e) { this.utils.error("AOS Init failed:", e); } } else { this.utils.warn("AOS disabled."); }
            },
    
            // --- Run Asynchronous Initializations (Data Fetching) ---
            runAsyncInits: async function() {
                if (!this.state.apiKeyValid) { this.utils.warn("Skipping async inits: API Key Invalid."); this.displayDataLoadingErrors("Invalid API Key"); return; }
                this.utils.log("Starting Async Inits (Hero, Shelves, Analytics)...");
                try {
                    const promises = [ this.modules.hero.loadBackgroundAndContent(true), this.modules.shelves.loadAllShelves(), this.modules.analyticsDashboard.loadAnalyticsData() ];
                    const results = await Promise.allSettled(promises);
                    this.utils.log("Async Inits settled."); results.forEach((r, i) => { if (r.status === 'rejected') this.utils.error(`Async init task ${i} failed:`, r.reason); });
                    this.modules.hero.startBackgroundUpdates();
                } catch (e) { this.utils.error("Error running async inits:", e); this.displayDataLoadingErrors("Failed to load initial content."); }
            },
    
            // --- Modules ---
            modules: {
    
                introVideo: {
                     init: function() { const els = AuraStreamApp.elements; const utils = AuraStreamApp.utils; utils.log("Init Intro Video..."); if (!els.introOverlay || !els.introVideo || !els.skipIntroButton) { utils.error("Intro elements missing. Skipping."); this.hideOverlay(true); return; } els.introVideo.addEventListener('ended', () => this.hideOverlay()); els.skipIntroButton.addEventListener('click', () => this.hideOverlay()); const timeout = AuraStreamApp.config.INTRO_VIDEO_TIMEOUT_MS; if (timeout > 0) { setTimeout(() => { if (!AuraStreamApp.state.introHidden) { utils.warn(`Intro timeout reached.`); this.hideOverlay(); }}, timeout); } els.introVideo.play().catch(e => { utils.warn("Intro autoplay likely blocked:", e.message); this.hideOverlay(true); }); },
                     hideOverlay: function(force = false) { if (AuraStreamApp.state.introHidden && !force) return; AuraStreamApp.state.introHidden = true; const els = AuraStreamApp.elements; const utils = AuraStreamApp.utils; utils.log("Hiding intro overlay..."); if (els.introOverlay) { els.introOverlay.style.transition = `opacity ${AuraStreamApp.config.LOADING_SCREEN_FADE_DURATION}ms ease-out`; els.introOverlay.style.opacity = '0'; setTimeout(() => { els.introOverlay.style.display = 'none'; }, AuraStreamApp.config.LOADING_SCREEN_FADE_DURATION); } if (els.introVideo) els.introVideo.pause(); if (!AuraStreamApp.state.apiKeyValid) { utils.warn("API Key was invalid. Displaying errors post-intro."); AuraStreamApp.displayDataLoadingErrors("Invalid API Key"); } if (AuraStreamApp.state.librariesLoaded.aos) { setTimeout(() => { utils.log("Refreshing AOS post-intro."); try{ AOS.refresh(); } catch(e){ utils.error("AOS refresh failed", e); } }, AuraStreamApp.config.LOADING_SCREEN_FADE_DURATION + 100); } }
                },
                loadingScreen: {
                     showError: function(message) { const el = AuraStreamApp.elements.loadingScreen; if (el && !el.classList.contains('hidden')) { el.innerHTML = `<div style="color:red; padding: 20px; text-align:center;">Error: ${AuraStreamApp.utils.escapeHtml(message)}</div>`; } }
                },
                threeBackground: {
                     scene: null, camera: null, renderer: null, particles: null, dust: null, animatedObjects: [], lights: {}, clock: null, mouse: new THREE.Vector2(), targetRotation: { x: 0, y: 0 }, targetCameraZ: 120, isInitialized: false,
                     init: function() { const els = AuraStreamApp.elements; const utils = AuraStreamApp.utils; if (this.isInitialized || !els.threeCanvas) return; utils.log("threeBackground: Initializing..."); try { this.clock = new THREE.Clock(); this.scene = new THREE.Scene(); this.scene.fog = new THREE.FogExp2(0x050609, 0.0016); this.camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 1, 2500); this.camera.position.z = this.targetCameraZ; this.renderer = new THREE.WebGLRenderer({ canvas: els.threeCanvas, antialias: true, alpha: true }); this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2)); this.renderer.setSize(window.innerWidth, window.innerHeight); this.renderer.setClearColor(0x000000, 0); this.createEnhancedParticles(); this.createAnimatedObjects(); this.createLighting(); this.createEnvironment(); this.addEventListeners(); this.onWindowResize(); this.isInitialized = true; this.startAnimation(); utils.log("threeBackground: Initialized."); } catch (e) { utils.error("threeBackground: Init failed.", e); this.stopAnimation(); if (els.threeCanvas) els.threeCanvas.style.display = 'none'; } },
                     createLighting: function() { this.lights.ambient = new THREE.AmbientLight(0xffffff, 0.55); this.scene.add(this.lights.ambient); this.lights.point1 = new THREE.PointLight(0xa855f7, 1.9, 1200, 1.7); this.lights.point1.position.set(-300, 200, 150); this.scene.add(this.lights.point1); this.lights.point2 = new THREE.PointLight(0x22d3ee, 1.6, 1000, 1.8); this.lights.point2.position.set(300, -150, 80); this.scene.add(this.lights.point2); this.lights.point3 = new THREE.PointLight(0xf472b6, 0.9, 800, 2); this.lights.point3.position.set(0, 0, 250); this.scene.add(this.lights.point3); this.lights.moving = new THREE.PointLight(0x4ade80, 1.5, 600, 2); this.lights.moving.position.set(100, 50, 100); this.scene.add(this.lights.moving); },
                     createAnimatedObjects: function() { this.animatedObjects = []; const torusKnotGeometry = new THREE.TorusKnotGeometry(18, 6, 120, 14, 2, 3); const torusKnotMaterial = new THREE.MeshStandardMaterial({ color: 0x101218, metalness: 0.8, roughness: 0.25, wireframe: true, wireframeLinewidth: 0.6, transparent: true, opacity: AuraStreamApp.config.THREE_ANIMATED_OBJ_OPACITY }); const torusKnot = new THREE.Mesh(torusKnotGeometry, torusKnotMaterial); torusKnot.position.set(0, 0, -100); this.scene.add(torusKnot); this.animatedObjects.push({ mesh: torusKnot, rotationSpeed: {x: 0.06, y: 0.09, z: 0.03}, position: {x: 0, y: 0, z: -100}}); const icoGeometry = new THREE.IcosahedronGeometry(12, 1); const icoMaterial = new THREE.MeshPhysicalMaterial({ color: 0x22d3ee, metalness: 0.6, roughness: 0.5, transmission: 0.5, thickness: 0.5, transparent: true, opacity: 0.65 }); const icosahedron = new THREE.Mesh(icoGeometry, icoMaterial); icosahedron.position.set(-80, 40, -50); this.scene.add(icosahedron); this.animatedObjects.push({ mesh: icosahedron, rotationSpeed: {x: 0.03, y: 0.05, z: 0.02}, position: {x: -80, y: 40, z: -50}, floatParams: { amplitude: 6, frequency: 0.15 }}); const octGroup = new THREE.Group(); const octMaterials = [ new THREE.MeshStandardMaterial({ color: 0xa855f7, metalness: 0.6, roughness: 0.4, transparent: true, opacity: 0.75 }), new THREE.MeshStandardMaterial({ color: 0x4ade80, metalness: 0.7, roughness: 0.3, transparent: true, opacity: 0.55 }) ]; for (let i = 0; i < 5; i++) { const size = 3 + Math.random() * 4; const octGeometry = new THREE.OctahedronGeometry(size, 0); const octMaterial = octMaterials[i % 2]; const octahedron = new THREE.Mesh(octGeometry, octMaterial); const radius = 12 + Math.random() * 6; const theta = Math.random() * Math.PI * 2; const phi = Math.random() * Math.PI; octahedron.position.x = radius * Math.sin(phi) * Math.cos(theta); octahedron.position.y = radius * Math.sin(phi) * Math.sin(theta); octahedron.position.z = radius * Math.cos(phi); octGroup.add(octahedron); } octGroup.position.set(70, -30, 0); this.scene.add(octGroup); this.animatedObjects.push({ mesh: octGroup, rotationSpeed: {x: 0.01, y: 0.02, z: 0.01}, position: {x: 70, y: -30, z: 0}, floatParams: { amplitude: 9, frequency: 0.1 }}); const ringGroup = new THREE.Group(); for (let i = 0; i < 3; i++) { const radius = 9 + i * 5; const tubeRadius = 0.6 - i * 0.12; const ringGeometry = new THREE.TorusGeometry(radius, tubeRadius, 16, 100); const ringMaterial = new THREE.MeshStandardMaterial({ color: i === 0 ? 0xff6b6b : i === 1 ? 0x22d3ee : 0xa855f7, metalness: 0.75, roughness: 0.25, transparent: true, opacity: 0.55 - i * 0.1 }); const ring = new THREE.Mesh(ringGeometry, ringMaterial); ring.rotation.x = Math.PI / 2; ring.rotation.y = i * (Math.PI / 4); ringGroup.add(ring); } ringGroup.position.set(-30, -50, 20); this.scene.add(ringGroup); this.animatedObjects.push({ mesh: ringGroup, rotationSpeed: {x: 0.005, y: 0.01, z: 0.008}, position: {x: -30, y: -50, z: 20}, customAnimation: function(time) { this.mesh.children.forEach((ring, i) => { ring.rotation.x = Math.PI / 2 + Math.sin(time * 0.5) * 0.2; ring.rotation.z = i * (Math.PI / 4) + time * (0.1 + i * 0.05); }); }}); },
                     createEnhancedParticles: function() { const config = AuraStreamApp.config; const particlesGeometry = new THREE.BufferGeometry(); const count = config.THREE_PARTICLE_COUNT; const positions = new Float32Array(count * 3); const colors = new Float32Array(count * 3); const sizes = new Float32Array(count); const colorInside = new THREE.Color(0xa855f7); const colorOutside = new THREE.Color(0x22d3ee); const colorAccent = new THREE.Color(0xff6b6b); const radius = config.THREE_GALAXY_RADIUS; const branches = 6; for (let i = 0; i < count; i++) { const i3 = i * 3; const r = Math.pow(Math.random(), 2) * radius; const spinAngle = r * 4.0; const branchAngle = (i % branches) / branches * Math.PI * 2; const scatterCoef = 0.3 * (1 - r / radius * 0.5); const randomX = Math.pow(Math.random(), 3.5) * (Math.random() < 0.5 ? 1 : -1) * scatterCoef * r; const randomY = Math.pow(Math.random(), 3.5) * (Math.random() < 0.5 ? 1 : -1) * scatterCoef * r; const randomZ = Math.pow(Math.random(), 3.5) * (Math.random() < 0.5 ? 1 : -1) * scatterCoef * r; positions[i3] = Math.cos(branchAngle + spinAngle) * r + randomX; positions[i3 + 1] = randomY * 0.6; positions[i3 + 2] = Math.sin(branchAngle + spinAngle) * r + randomZ; let mixedColor = (i % 20 === 0) ? colorAccent.clone() : colorInside.clone().lerp(colorOutside, Math.pow(r / radius, 0.8)); colors[i3] = mixedColor.r; colors[i3 + 1] = mixedColor.g; colors[i3 + 2] = mixedColor.b; sizes[i] = (Math.random() * 1.2 + 0.3) * config.THREE_PARTICLE_SIZE; } particlesGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3)); particlesGeometry.setAttribute('color', new THREE.BufferAttribute(colors, 3)); particlesGeometry.setAttribute('size', new THREE.BufferAttribute(sizes, 1)); const vertexShader = `attribute float size; varying vec3 vColor; void main() { vColor = color; vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 ); gl_PointSize = size * ( 300.0 / -mvPosition.z ); gl_Position = projectionMatrix * mvPosition; }`; const fragmentShader = `varying vec3 vColor; void main() { float strength = distance(gl_PointCoord, vec2(0.5)); if (strength > 0.5) discard; float alpha = 1.0 - strength * 2.0; gl_FragColor = vec4( vColor, ${config.THREE_PARTICLE_OPACITY} * alpha ); }`; this.starsMaterial = new THREE.ShaderMaterial({ vertexShader, fragmentShader, blending: THREE.AdditiveBlending, depthWrite: false, transparent: true, vertexColors: true }); this.particles = new THREE.Points(particlesGeometry, this.starsMaterial); this.scene.add(this.particles); this.createBackgroundStars(); },
                     createBackgroundStars: function() { const backgroundStarsGeometry = new THREE.BufferGeometry(); const count = 1500; const positions = new Float32Array(count * 3); const colors = new Float32Array(count * 3); const radius = 1000; for (let i = 0; i < count; i++) { const i3 = i * 3; const theta = Math.random() * Math.PI * 2; const phi = Math.acos((Math.random() * 2) - 1); const r = 400 + Math.random() * radius; positions[i3] = r * Math.sin(phi) * Math.cos(theta); positions[i3 + 1] = r * Math.sin(phi) * Math.sin(theta); positions[i3 + 2] = r * Math.cos(phi); const brightness = 0.4 + Math.random() * 0.4; colors[i3] = brightness; colors[i3 + 1] = brightness; colors[i3 + 2] = brightness; } backgroundStarsGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3)); backgroundStarsGeometry.setAttribute('color', new THREE.BufferAttribute(colors, 3)); const bgStarsMaterial = new THREE.PointsMaterial({ size: 0.6, sizeAttenuation: true, depthWrite: false, blending: THREE.AdditiveBlending, vertexColors: true, transparent: true, opacity: 0.4 }); const backgroundStars = new THREE.Points(backgroundStarsGeometry, bgStarsMaterial); backgroundStars.renderOrder = -1; this.scene.add(backgroundStars); this.animatedObjects.push({ mesh: backgroundStars, rotationSpeed: {x: 0.0001, y: 0.0002, z: 0.0001}}); },
                     createEnvironment: function() { const dustGeometry = new THREE.BufferGeometry(); const dustCount = 150; const dustPositions = new Float32Array(dustCount * 3); for (let i = 0; i < dustCount; i++) { const i3 = i * 3; dustPositions[i3] = (Math.random() - 0.5) * 400; dustPositions[i3 + 1] = (Math.random() - 0.5) * 400; dustPositions[i3 + 2] = (Math.random() - 0.5) * 400; } dustGeometry.setAttribute('position', new THREE.BufferAttribute(dustPositions, 3)); const dustTexture = this.createDustTexture(); const dustMaterial = new THREE.PointsMaterial({ map: dustTexture, size: 9, sizeAttenuation: true, color: 0xaaaaaa, transparent: true, opacity: 0.12, blending: THREE.AdditiveBlending, depthWrite: false }); this.dust = new THREE.Points(dustGeometry, dustMaterial); this.scene.add(this.dust); },
                     createDustTexture: function() { const canvas = document.createElement('canvas'); canvas.width = 64; canvas.height = 64; const context = canvas.getContext('2d'); const gradient = context.createRadialGradient(32, 32, 0, 32, 32, 32); gradient.addColorStop(0, 'rgba(255,255,255,0.5)'); gradient.addColorStop(0.2, 'rgba(255,255,255,0.3)'); gradient.addColorStop(0.6, 'rgba(255,255,255,0.1)'); gradient.addColorStop(1, 'rgba(255,255,255,0)'); context.fillStyle = gradient; context.fillRect(0, 0, 64, 64); return new THREE.CanvasTexture(canvas); },
                     addEventListeners: function() { document.addEventListener('mousemove', (e) => this.onDocumentMouseMove(e), false); window.addEventListener('resize', AuraStreamApp.utils.debounce(() => this.onWindowResize(), 100), false); window.addEventListener('scroll', AuraStreamApp.utils.debounce(() => this.onWindowScroll(), 50), { passive: true }); },
                     onDocumentMouseMove: function(event) { this.mouse.x = (event.clientX / window.innerWidth) * 2 - 1; this.mouse.y = -(event.clientY / window.innerHeight) * 2 + 1; },
                     onWindowScroll: function() { const scrollY = window.scrollY; const maxScroll = Math.max(1, document.body.scrollHeight - window.innerHeight); const scrollFactor = Math.min(scrollY / 1000, 1); this.targetCameraZ = 120 + scrollFactor * 80; },
                     onWindowResize: function() { if (!this.renderer || !this.camera) return; this.camera.aspect = window.innerWidth / window.innerHeight; this.camera.updateProjectionMatrix(); this.renderer.setSize(window.innerWidth, window.innerHeight); this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2)); },
                     animate: function() { if (!this.isInitialized) return; AuraStreamApp.state.threeAnimationId = requestAnimationFrame(() => this.animate()); const elapsedTime = this.clock.getElapsedTime(); this.targetRotation.y = this.mouse.x * 0.1; this.targetRotation.x = this.mouse.y * 0.1; if (this.particles) { this.particles.rotation.y += (this.targetRotation.y - this.particles.rotation.y) * 0.02 + 0.0006; this.particles.rotation.x += (this.targetRotation.x - this.particles.rotation.x) * 0.02; } this.animatedObjects.forEach(obj => { if (obj.rotationSpeed) { obj.mesh.rotation.x += obj.rotationSpeed.x * 0.1; obj.mesh.rotation.y += obj.rotationSpeed.y * 0.1; obj.mesh.rotation.z += obj.rotationSpeed.z * 0.1; } if (obj.floatParams) { const floatY = Math.sin(elapsedTime * obj.floatParams.frequency) * obj.floatParams.amplitude; obj.mesh.position.y = obj.position.y + floatY; } if (obj.customAnimation) obj.customAnimation.call(obj, elapsedTime); }); if (this.lights.moving) { this.lights.moving.position.x = Math.sin(elapsedTime * 0.35) * 180; this.lights.moving.position.z = Math.cos(elapsedTime * 0.25) * 180; this.lights.moving.position.y = Math.sin(elapsedTime * 0.55) * 100; } if (this.dust) { this.dust.rotation.x = elapsedTime * 0.008; this.dust.rotation.y = elapsedTime * 0.012; const dustScale = 1 + Math.sin(elapsedTime * 0.25) * 0.08; this.dust.scale.set(dustScale, dustScale, dustScale); } this.camera.position.x += (this.mouse.x * 15 - this.camera.position.x) * 0.015; this.camera.position.y += (-this.mouse.y * 15 - this.camera.position.y) * 0.015; this.camera.position.z += (this.targetCameraZ - this.camera.position.z) * 0.025; this.camera.lookAt(0, 0, 0); this.renderer.render(this.scene, this.camera); },
                     startAnimation: function() { if (this.isInitialized && !AuraStreamApp.state.threeAnimationId) this.animate(); },
                     stopAnimation: function() { if (AuraStreamApp.state.threeAnimationId) cancelAnimationFrame(AuraStreamApp.state.threeAnimationId); AuraStreamApp.state.threeAnimationId = null; }
                },
                navbar: {
                     init: function() { const els = AuraStreamApp.elements; const utils = AuraStreamApp.utils; if (!els.navbar || !els.mobileMenuToggle || !els.mobileMenuClose || !els.mobileMenu || !els.offcanvasOverlay) { utils.warn("Navbar elements missing."); return; } utils.log("Navbar Initializing..."); window.addEventListener('scroll', utils.debounce(() => this.handleScroll(), 50), { passive: true }); this.handleScroll(); els.mobileMenuToggle.addEventListener('click', () => this.openMobileMenu()); els.mobileMenuClose.addEventListener('click', () => this.closeMobileMenu()); els.offcanvasOverlay.addEventListener('click', () => this.closeMobileMenu()); els.mobileMenu.querySelectorAll('.nav-link').forEach(link => { link.addEventListener('click', () => this.closeMobileMenu()); }); this.setupActiveLinkHandling(); this.setupSearchListeners(); utils.log("Navbar Initialized."); },
                     handleScroll: function() { const navbar = AuraStreamApp.elements.navbar; if (!navbar) return; window.scrollY > 50 ? navbar.classList.add('scrolled') : navbar.classList.remove('scrolled'); },
                     openMobileMenu: function() { const els = AuraStreamApp.elements; if (!els.mobileMenu || !els.offcanvasOverlay) return; els.mobileMenu.classList.add('active'); els.offcanvasOverlay.classList.add('active'); document.body.classList.add('offcanvas-open'); AuraStreamApp.state.isMobileMenuOpen = true; },
                     closeMobileMenu: function() { const els = AuraStreamApp.elements; if (!els.mobileMenu || !els.offcanvasOverlay) return; els.mobileMenu.classList.remove('active'); els.offcanvasOverlay.classList.remove('active'); document.body.classList.remove('offcanvas-open'); AuraStreamApp.state.isMobileMenuOpen = false; },
                     setupActiveLinkHandling: function() { AuraStreamApp.utils.log("Navbar Active Link Handling setup (placeholder)."); /* TODO: Implement */ },
                     setupSearchListeners: function() { AuraStreamApp.utils.log("Navbar Search setup (placeholder)."); /* TODO: Implement */ }
                },
                smoothScroll: {
                    init: function() { AuraStreamApp.utils.log("SmoothScroll Initialized (basic)."); }
                },
                conceptualLinks: {
                     init: function() { const utils = AuraStreamApp.utils; document.body.addEventListener('click', (e) => { const link = e.target.closest('.conceptual-link'); if (link && !link.disabled) this.handleClick(link, link.title || 'Conceptual Feature', e); }); utils.log("ConceptualLinks Initialized."); },
                     handleClick: function(linkElement, message = null, event = null) { if (event) event.preventDefault(); alert(message || "This feature is conceptual and not yet implemented."); AuraStreamApp.utils.log(`Conceptual link clicked: ${linkElement.title || linkElement.textContent?.trim() || 'Unknown'}`); }
                },
                modals: {
                     trailerModalInstance: null, launchAppModalInstance: null,
                     init: function() { const utils = AuraStreamApp.utils; const els = AuraStreamApp.elements; utils.log("Init Modals..."); if (!AuraStreamApp.state.librariesLoaded.bootstrap) { utils.error("Bootstrap JS not loaded! Modals disabled."); return; } try { if (els.trailerModal) { this.trailerModalInstance = new bootstrap.Modal(els.trailerModal); els.trailerModal.addEventListener('hidden.bs.modal', () => { if (els.trailerIframe) els.trailerIframe.src = 'about:blank'; }); utils.log("Trailer Modal instance created."); } else utils.warn("Trailer modal element missing."); if (els.launchAppModal) { this.launchAppModalInstance = new bootstrap.Modal(els.launchAppModal); els.launchAppModal.addEventListener('show.bs.modal', () => AuraStreamApp.modules.auth.clearAuthError()); els.launchAppModal.addEventListener('hide.bs.modal', () => AuraStreamApp.modules.auth.clearAuthError()); utils.log("Auth Modal instance created."); } else utils.warn("Launch/Auth modal element missing."); } catch (e) { utils.error("Error init Bootstrap Modals:", e); } },
                     openTrailer: async function(movieId) { const utils = AuraStreamApp.utils; const els = AuraStreamApp.elements; if (!this.trailerModalInstance || !els.trailerIframe) { utils.error("Cannot open trailer: Modal instance or iframe missing."); alert("Trailer player error."); return; } if (!movieId) { utils.error("Cannot open trailer: Movie ID missing."); alert("Trailer info missing."); return; } utils.log(`Opening trailer for movie ID: ${movieId}`); els.trailerIframe.src = 'about:blank'; try { const videos = await utils.fetchMovieVideos(movieId); const bestTrailer = utils.getBestTrailer(videos); if (bestTrailer?.key) { els.trailerIframe.src = `${AuraStreamApp.config.YOUTUBE_EMBED_URL}${bestTrailer.key}?autoplay=1&rel=0&modestbranding=1`; this.trailerModalInstance.show(); utils.log(`Showing trailer: ${bestTrailer.key}`); } else { utils.warn(`No suitable trailer found for movie ID: ${movieId}`); alert("No trailer available."); } } catch (error) { utils.error(`Error fetching/playing trailer for ${movieId}:`, error); alert("Error loading trailer."); } },
                     closeAuthModal: function() { if (this.launchAppModalInstance) { this.launchAppModalInstance.hide(); AuraStreamApp.utils.log("Auth modal closed programmatically."); } }
                },
                faq: {
                    init: function() { AuraStreamApp.utils.log("FAQ Initialized (Bootstrap handled)."); }
                },
                featureVideoPlayer: {
                     init: function() { const els = AuraStreamApp.elements; const utils = AuraStreamApp.utils; if (!els.videoFeatureDemoPlayer || !els.videoFeatureDemoVideo || !els.videoFeatureDemoPlayButton) { utils.warn("Feature video player elements missing."); return; } utils.log("Init Feature Video Player..."); const player = els.videoFeatureDemoPlayer; const video = els.videoFeatureDemoVideo; const playButton = els.videoFeatureDemoPlayButton; const togglePlay = () => { if (video.paused || video.ended) { video.play().then(()=>player.classList.add('playing')).catch(e=>utils.error("Error playing feature video:", e)); } else video.pause(); }; playButton.addEventListener('click', (e) => { e.stopPropagation(); togglePlay(); }); player.addEventListener('click', togglePlay); video.addEventListener('play', () => player.classList.add('playing')); video.addEventListener('pause', () => { if(!video.ended) player.classList.remove('playing'); }); video.addEventListener('ended', () => player.classList.remove('playing')); utils.log("Feature video player listeners attached."); }
                },
                auth: {
                     init: function() { const utils = AuraStreamApp.utils; const els = AuraStreamApp.elements; utils.log("Initializing Auth module listeners..."); if (els.loginForm) els.loginForm.addEventListener('submit', (e) => this.handleEmailLogin(e)); else utils.warn("Login form not found."); if (els.signupForm) els.signupForm.addEventListener('submit', (e) => this.handleEmailSignup(e)); else utils.warn("Signup form not found."); if (els.googleLoginButton) els.googleLoginButton.addEventListener('click', () => this.handleGoogleAuth(false)); else utils.warn("Google login button not found."); if (els.googleSignupButton) els.googleSignupButton.addEventListener('click', () => this.handleGoogleAuth(true)); else utils.warn("Google signup button not found."); if (els.logoutButton) els.logoutButton.addEventListener('click', () => this.handleLogout()); else utils.warn("Logout button not found."); document.querySelectorAll('#authTabs button[data-bs-toggle="tab"]').forEach(tabEl => { tabEl.addEventListener('shown.bs.tab', () => this.clearAuthError()); }); utils.log("Auth module listeners attached."); },
                     updateAuthUI: function() { const utils = AuraStreamApp.utils; const els = AuraStreamApp.elements; const state = AuraStreamApp.state; if (!els.authButtonArea ||!els.loginSignupButton || !els.userInfoArea || !els.logoutButton || !els.userDisplayName || !els.userAvatar || !els.userAvatarImage || !els.userAvatarInitials) { return; } if (state.isLoggedIn && state.currentUser) { els.authButtonArea.classList.remove('d-none'); els.loginSignupButton.classList.add('d-none'); els.userInfoArea.classList.remove('d-none'); const displayName = state.currentUser.displayName || state.currentUser.email; els.userDisplayName.textContent = utils.escapeHtml(displayName); els.userDisplayName.title = `Logged in as: ${utils.escapeHtml(state.currentUser.email)}`; const photoURL = state.currentUser.photoURL; if (photoURL) { els.userAvatarImage.src = photoURL; els.userAvatarImage.alt = `${displayName}'s profile`; els.userAvatarImage.classList.remove('d-none'); els.userAvatarInitials.classList.add('d-none'); els.userAvatarInitials.textContent = ''; } else { const initials = utils.getInitials(state.currentUser.displayName, state.currentUser.email); els.userAvatarInitials.textContent = initials; els.userAvatarInitials.classList.remove('d-none'); els.userAvatarImage.classList.add('d-none'); els.userAvatarImage.src = ''; els.userAvatarImage.alt = ''; } } else { els.authButtonArea.classList.remove('d-none'); els.loginSignupButton.classList.remove('d-none'); els.userInfoArea.classList.add('d-none'); els.userDisplayName.textContent = ''; els.userDisplayName.title = ''; els.userAvatarInitials.textContent = ''; els.userAvatarImage.src = ''; els.userAvatarImage.alt = ''; els.userAvatarInitials.classList.add('d-none'); els.userAvatarImage.classList.add('d-none'); } },
                     handleEmailLogin: function(event) { event.preventDefault(); const utils = AuraStreamApp.utils; const els = AuraStreamApp.elements; const auth = AuraStreamApp.state.firebaseAuth; utils.log("Handling Email Login..."); this.clearAuthError(); const email = els.loginEmailInput?.value?.trim(); const password = els.loginPasswordInput?.value; if (!auth) { this.showAuthError("Auth service unavailable."); return; } if (!email || !password) { this.showAuthError("Please enter email and password."); return; } const loginButton = els.loginForm?.querySelector('button[type="submit"]'); if (loginButton) loginButton.disabled = true; this.showAuthError("Logging in...", "info"); auth.signInWithEmailAndPassword(email, password).then((userCredential) => { utils.log(`Firebase Email Login SUCCESS: ${userCredential.user.email}`); AuraStreamApp.modules.modals.closeAuthModal(); }).catch((error) => { utils.error("Firebase Email Login FAILED:", error); this.showAuthError(this.mapFirebaseError(error)); if (loginButton) loginButton.disabled = false; }); },
                     handleEmailSignup: function(event) { event.preventDefault(); const utils = AuraStreamApp.utils; const els = AuraStreamApp.elements; const auth = AuraStreamApp.state.firebaseAuth; utils.log("Handling Email Signup..."); this.clearAuthError(); const name = els.signupNameInput?.value?.trim(); const ageInput = els.signupAgeInput?.value; const email = els.signupEmailInput?.value?.trim(); const password = els.signupPasswordInput?.value; const avatarFile = els.signupAvatarInput?.files[0]; if (!auth) { this.showAuthError("Auth service unavailable."); return; } if (!name || !ageInput || !email || !password) { this.showAuthError("Please fill in Name, Age, Email, and Password."); return; } const age = parseInt(ageInput, 10); if (isNaN(age) || age < 1 || age > 120) { this.showAuthError("Please enter a valid age (1-120)."); return; } if (!/\S+@\S+\.\S+/.test(email)) { this.showAuthError("Invalid email format."); return; } if (password.length < 6) { this.showAuthError("Password must be at least 6 characters."); return; } if (avatarFile && avatarFile.size > 5 * 1024 * 1024) { this.showAuthError("Profile picture too large (Max 5MB)."); return; } if (avatarFile && !['image/jpeg', 'image/png', 'image/gif'].includes(avatarFile.type)) { this.showAuthError("Invalid image file type (JPG, PNG, GIF)."); return; } const signupButton = els.signupForm?.querySelector('button[type="submit"]'); if(signupButton) signupButton.disabled = true; this.showAuthError("Creating account...", "info"); auth.createUserWithEmailAndPassword(email, password).then(async (userCredential) => { const user = userCredential.user; utils.log(`Firebase User Account CREATED: ${user.email}`); try { utils.log(`Initiating profile/data storage for new user ${user.uid}...`); await this.updateProfileAndStoreData(user, name, age, avatarFile); utils.log(`Profile/data storage successful for ${user.email}.`); } catch (profileError) { utils.error(`Profile update/storage FAILED post-signup for ${user.email}:`, profileError); this.showAuthError(`Account created, but profile setup failed: ${profileError.message}. Redirecting...`, "warning"); setTimeout(() => AuraStreamApp.modules.modals?.closeAuthModal(), 4000); } }).catch((error) => { utils.error("Firebase Email Signup FAILED (creation):", error); this.showAuthError(this.mapFirebaseError(error)); if(signupButton) signupButton.disabled = false; }); },
                     handleGoogleAuth: function(isSignupAttempt = false) { const utils = AuraStreamApp.utils; const auth = AuraStreamApp.state.firebaseAuth; const action = isSignupAttempt ? "Signup" : "Login"; utils.log(`Handling Google ${action}...`); this.clearAuthError(); if (!auth || !firebase?.auth?.GoogleAuthProvider) { this.showAuthError("Google Auth setup error."); return; } const provider = new firebase.auth.GoogleAuthProvider(); utils.log(`Initiating Google Sign-In with Popup...`); this.showAuthError("Waiting for Google Sign-In...", "info"); auth.signInWithPopup(provider).then(async (result) => { const user = result.user; const isNewUser = result.additionalUserInfo?.isNewUser; utils.log(`Google ${action} SUCCESS: ${user.email}. New User: ${isNewUser}`); const googleName = result.additionalUserInfo?.profile?.name || user.displayName || user.email.split('@')[0]; const googlePhotoURL = result.additionalUserInfo?.profile?.picture || user.photoURL; if (isNewUser || !user.displayName || (googlePhotoURL && user.photoURL !== googlePhotoURL)) { utils.log(`New Google user or profile mismatch. Updating profile...`); try { await this.updateProfileAndStoreData(user, googleName, undefined, null, googlePhotoURL); utils.log(`Google user profile updated.`); await user.reload(); const refreshedUser = auth.currentUser; if(refreshedUser){ AuraStreamApp.state.currentUser = { uid: refreshedUser.uid, email: refreshedUser.email, displayName: refreshedUser.displayName, photoURL: refreshedUser.photoURL }; AuraStreamApp.modules.auth.updateAuthUI(); } } catch (profileError) { utils.error(`Failed update after Google signin:`, profileError); } } else { utils.log(`Existing Google user.`); AuraStreamApp.state.currentUser = { uid: user.uid, email: user.email, displayName: user.displayName, photoURL: user.photoURL }; AuraStreamApp.modules.auth.updateAuthUI();} AuraStreamApp.modules.modals.closeAuthModal(); }).catch((error) => { utils.error(`Google ${action} FAILED:`, error); this.showAuthError(this.mapFirebaseError(error)); }); },
                     handleLogout: function() { const utils = AuraStreamApp.utils; const auth = AuraStreamApp.state.firebaseAuth; utils.log("Handling Logout..."); if (!auth) { utils.error("Cannot logout: Auth unavailable."); return; } auth.signOut().then(() => { utils.log("Firebase Logout SUCCESS."); }).catch((error) => { utils.error("Firebase Logout FAILED:", error); alert("Logout failed."); }); },
                     updateProfileAndStoreData: async function(user, name, age, avatarFile = null, googlePhotoURL = null) { const utils = AuraStreamApp.utils; const state = AuraStreamApp.state; let finalPhotoURL = googlePhotoURL || user.photoURL; utils.log(`Starting profile/data update for ${user.uid}`); if (avatarFile && state.firebaseStorage) { utils.log(`Uploading avatar: ${avatarFile.name}`); const filePath = `profile_images/${user.uid}/${Date.now()}_${avatarFile.name}`; const storageRef = state.firebaseStorage.ref(filePath); try { const snapshot = await storageRef.put(avatarFile); finalPhotoURL = await snapshot.ref.getDownloadURL(); utils.log(`Avatar uploaded. URL: ${finalPhotoURL}`); } catch (uploadError) { utils.error(`Avatar upload failed:`, uploadError); this.showAuthError(`Avatar upload failed: ${this.mapFirebaseError(uploadError)}`, "warning"); } } else if (avatarFile) { utils.warn(`Avatar provided, but Storage unavailable.`); this.showAuthError("Cannot upload avatar: Storage not configured.", "warning"); } const profileUpdates = {}; if (name && name !== user.displayName) profileUpdates.displayName = name; if (finalPhotoURL && finalPhotoURL !== user.photoURL) profileUpdates.photoURL = finalPhotoURL; if (Object.keys(profileUpdates).length > 0) { utils.log(`Updating Auth profile with:`, profileUpdates); try { await user.updateProfile(profileUpdates); utils.log(`Auth profile updated successfully.`); } catch (authProfileError) { utils.error(`Auth profile update failed:`, authProfileError); this.showAuthError(`Failed to update profile: ${this.mapFirebaseError(authProfileError)}`, "warning"); } } else utils.log(`No changes needed for Auth profile.`); if (state.firebaseFirestore) { utils.log(`Storing user data (Email, Name, Age: ${age}) in Firestore...`); const userDocRef = state.firebaseFirestore.collection('users').doc(user.uid); const userData = { email: user.email, name: name, ...(age !== undefined && age !== null && !isNaN(age) && { age: Number(age) }), lastLogin: firebase.firestore.FieldValue.serverTimestamp() }; try { await userDocRef.set(userData, { merge: true }); utils.log(`User data stored/merged successfully.`); } catch (firestoreError) { utils.error(`Firestore write failed:`, firestoreError); this.showAuthError(`Failed to save user data: ${this.mapFirebaseError(firestoreError)}`, "warning"); } } else utils.warn(`Firestore unavailable, cannot store user data.`); utils.log(`Profile and data update process completed.`); },
                     showAuthError: function(message, level = "danger") { const els = AuraStreamApp.elements; if (els.authErrorMessage) { els.authErrorMessage.textContent = message; els.authErrorMessage.className = `alert alert-${level} mt-3`; } AuraStreamApp.utils.error(`Auth Error Displayed: ${message}`); },
                     clearAuthError: function() { const els = AuraStreamApp.elements; if (els.authErrorMessage) { els.authErrorMessage.textContent = ''; els.authErrorMessage.className = 'alert alert-danger mt-3 d-none'; } },
                     mapFirebaseError: function(error) { switch (error.code) { case 'auth/invalid-email': return 'Invalid email format.'; case 'auth/user-disabled': return 'Account disabled.'; case 'auth/user-not-found': return 'User not found.'; case 'auth/wrong-password': return 'Incorrect password.'; case 'auth/email-already-in-use': return 'Email already registered.'; case 'auth/weak-password': return 'Password too weak (min 6 chars).'; case 'auth/operation-not-allowed': return 'Email/Password sign-in disabled.'; case 'auth/popup-closed-by-user': return 'Google Sign-In cancelled.'; case 'auth/cancelled-popup-request': return 'Sign-in cancelled.'; case 'auth/popup-blocked': return 'Popup blocked by browser.'; case 'storage/unauthorized': return 'File upload permission denied.'; case 'storage/canceled': return 'File upload cancelled.'; case 'storage/object-not-found': return 'File upload error.'; case 'storage/quota-exceeded': return 'Storage quota exceeded.'; case 'storage/unknown': return 'Unknown storage error.'; default: return error.message || 'Unknown auth/storage error.'; } }
                },
                hero: {
                     updateIntervalId: null,
                     init: function() { AuraStreamApp.utils.log("Hero module init."); this.setupButtonListeners(); },
                     loadBackgroundAndContent: async function(isInitial = true) { const utils = AuraStreamApp.utils; if (document.hidden && !isInitial) return; utils.log(`Hero: ${isInitial ? 'Initial Load' : 'Update'} starting...`); try { const data = await utils.fetchTMDB('/movie/popular', { page: 1 }); if (!data?.results?.length) { utils.warn("Hero: Popular fetch failed/empty."); if (isInitial) this.handleInitialLoadFailure("Could not load content."); return; } const potentialHeroes = data.results.filter(m => m.backdrop_path && m.overview && m.vote_average >= 6.0); if (potentialHeroes.length > 0) { const movie = potentialHeroes[Math.floor(Math.random() * potentialHeroes.length)]; AuraStreamApp.state.heroMovie = movie; utils.log(`Hero: Selected movie: ${movie.title} (ID: ${movie.id})`); this.updateHeroBackground(movie.backdrop_path, isInitial); const [details, videos] = await Promise.all([ utils.fetchTMDB(`/movie/${movie.id}`), utils.fetchMovieVideos(movie.id) ]); if (details) this.updateHeroContent(details, videos || []); else { utils.warn(`Hero: Details fetch failed for ${movie.id}. Using basic data.`); this.updateHeroContent(movie, videos || []); if(isInitial) this.handleInitialLoadFailure("Failed to load full details."); } if (AuraStreamApp.state.featuredTrailerMovieId !== movie.id && AuraStreamApp.elements.trailerFeatureSection) AuraStreamApp.modules.trailerFeature.loadContent(movie); } else { utils.warn("Hero: No suitable movies found."); if (isInitial) this.handleInitialLoadFailure("No suitable content found."); } } catch (error) { utils.error("Error loading hero content:", error); if (isInitial) this.handleInitialLoadFailure(); } },
                     updateHeroBackground: function(path, isInitial) { const els = AuraStreamApp.elements; const utils = AuraStreamApp.utils; if (!els.heroBgImage || !els.heroSection) return; if (!path) { utils.warn("Hero: No backdrop."); if(isInitial) els.heroSection.classList.add('loaded'); els.heroBgImage.style.backgroundImage=''; els.heroBgImage.style.opacity=0; return; } const url = `${AuraStreamApp.config.IMAGE_BASE_URL}${AuraStreamApp.config.HERO_BACKDROP_SIZE}${path}`; const img = new Image(); img.onload=()=>{ if (!els.heroBgImage) return; if (els.heroBgImage.style.backgroundImage !== `url("${url}")`) { els.heroBgImage.style.opacity=0; setTimeout(() => { if (!els.heroBgImage) return; els.heroBgImage.style.backgroundImage=`url('${url}')`; els.heroBgImage.style.transition='opacity 1.8s ease-in-out'; els.heroBgImage.style.opacity=0.4; if(isInitial) els.heroSection.classList.add('loaded');}, 350); } else if (isInitial) { els.heroSection.classList.add('loaded'); els.heroBgImage.style.opacity=0.4;}}; img.onerror=()=>{ utils.warn('Hero img load fail:',url); if(isInitial) this.handleInitialLoadFailure();}; img.src=url;},
                     updateHeroContent: function(movie, videos = []) { const els = AuraStreamApp.elements; const utils = AuraStreamApp.utils; if (!els.heroTitle || !els.heroOverview || !els.heroInfoContainer || !movie) { utils.warn("Cannot update hero content: Missing elements or data."); if(els.heroSection && !movie) this.handleInitialLoadFailure("Missing movie data."); return; } els.heroTitle.textContent = utils.escapeHtml(movie.title || 'Featured Content'); els.heroOverview.textContent = utils.escapeHtml(movie.overview || 'No description available.'); const genres = movie.genres?.map(g => utils.escapeHtml(g.name)).join(', ') || 'N/A'; const rating = movie.vote_average ? movie.vote_average.toFixed(1) : 'N/A'; const releaseDate = movie.release_date ? utils.formatDate(movie.release_date) : 'N/A'; els.heroInfoContainer.innerHTML = `<div class="hero-info-item"><i class="bi bi-calendar3"></i><span>${releaseDate}</span></div><div class="hero-info-item"><i class="bi bi-star-fill"></i><span>${rating}/10</span></div><div class="hero-info-item"><i class="bi bi-film"></i><span>${genres}</span></div>`; const bestTrailer = utils.getBestTrailer(videos); if (els.heroWatchTrailerBtn) { els.heroWatchTrailerBtn.disabled = !bestTrailer; els.heroWatchTrailerBtn.dataset.movieId = movie?.id || ''; } if (els.heroMoreInfoBtn) { els.heroMoreInfoBtn.disabled = false; els.heroMoreInfoBtn.title = `More Info for ${utils.escapeHtml(movie.title || 'this content')} (Concept)`; els.heroMoreInfoBtn.dataset.movieId = movie?.id || ''; } },
                     handleInitialLoadFailure: function(errorMessage = "Could not load content.") { const els = AuraStreamApp.elements; const utils = AuraStreamApp.utils; utils.warn(`Hero Fallback: ${errorMessage}`); if (!els.heroSection) return; els.heroSection.classList.add('loaded'); if(els.heroTitle) els.heroTitle.textContent="AuraStream"; if(els.heroOverview) els.heroOverview.innerHTML=`<span class="text-danger"><i class="bi bi-exclamation-circle-fill me-2"></i>${utils.escapeHtml(errorMessage)}</span>`; if(els.heroInfoContainer) els.heroInfoContainer.innerHTML=''; if(els.heroWatchTrailerBtn) els.heroWatchTrailerBtn.disabled=true; if(els.heroMoreInfoBtn) els.heroMoreInfoBtn.disabled=true; if(els.heroBgImage) { els.heroBgImage.style.backgroundImage=`linear-gradient(to right, rgba(var(--bg-primary-rgb),0.95) 25%, rgba(var(--bg-primary-rgb),0.6) 60%, transparent 100%)`; els.heroBgImage.style.opacity=1;}},
                     startBackgroundUpdates: function() { if (this.updateIntervalId) clearInterval(this.updateIntervalId); this.updateIntervalId = setInterval(() => this.loadBackgroundAndContent(false), AuraStreamApp.config.HERO_UPDATE_INTERVAL); AuraStreamApp.utils.log("Hero background updates started."); },
                     setupButtonListeners: function() { const els = AuraStreamApp.elements; const utils = AuraStreamApp.utils; if (els.heroWatchTrailerBtn) { els.heroWatchTrailerBtn.addEventListener('click', function() { utils.log('HERO Play button clicked!'); const movieId = this.dataset.movieId; if (movieId && !this.disabled) { utils.log(`Calling modals.openTrailer from HERO for ID: ${movieId}`); AuraStreamApp.modules.modals.openTrailer(movieId); } else utils.warn(`Hero play conditions not met. MovieID: ${movieId}, Disabled: ${this.disabled}`); }); utils.log("Hero Watch Trailer button listener attached."); } else utils.warn("Hero Watch Trailer button missing."); if (els.heroMoreInfoBtn) { els.heroMoreInfoBtn.addEventListener('click', function(e) { if (this.classList.contains('conceptual-link') && !this.disabled) { utils.log(`Hero More Info clicked for ID: ${this.dataset.movieId}`); AuraStreamApp.modules.conceptualLinks.handleClick(this, `More info for movie ID ${this.dataset.movieId}`, e); } else utils.warn(`Hero More Info not conceptual or disabled. Disabled: ${this.disabled}`); }); utils.log("Hero More Info button listener attached."); } else utils.warn("Hero More Info button missing."); }
                },
                shelves: {
                     init: function() { AuraStreamApp.utils.log("Shelves module init."); this.initResizeListener(); },
                     renderCards: function(items, containerEl, type = 'movie') { const utils = AuraStreamApp.utils; if(!containerEl) { utils.warn("renderCards: Container missing."); return; } containerEl.innerHTML = ''; const config = AuraStreamApp.config; if (!items?.length) { containerEl.innerHTML = utils.getErrorTextHTML(`No ${type === 'tv' ? 'shows' : 'movies'} found.`); return; } const frag = document.createDocumentFragment(); items.forEach((item, idx) => { const itemType = item.media_type || type; if (itemType === 'person' || !item.id || (!item.poster_path && !item.profile_path)) return; const title = utils.escapeHtml(item.title || item.name || 'Untitled'); const posterPath = item.poster_path || item.profile_path; const poster = posterPath ? `${config.IMAGE_BASE_URL}${config.POSTER_SIZE}${posterPath}` : 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7'; const rating = item.vote_average?.toFixed(1); const year = utils.getYear(item.release_date || item.first_air_date); const link = document.createElement('a'); link.href = `#details?type=${itemType}&id=${item.id}`; link.className = 'movie-card conceptual-link'; link.title = `${title} (${year || itemType})`; link.dataset.aos = "fade-up"; link.dataset.aosDelay = `${Math.min(idx * 50, 300)}`; link.draggable = false; link.dataset.itemId = item.id; link.dataset.itemType = itemType; link.innerHTML = `<div class="card-image-wrapper"><img src="${poster}" alt="${title} Poster" loading="lazy" draggable="false" onerror="this.onerror=null;this.src='data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';this.parentElement.innerHTML = '<div class=\\'skeleton-placeholder d-flex align-items-center justify-content-center text-center p-2 flex-column h-100\\'><i class=\\'bi bi-image-alt fs-1 opacity-50\\'></i><small class=\\'mt-1 opacity-75\\'>No Poster</small></div>';"><div class="card-image-overlay"></div><div class="card-top-info">${rating > 0.1 ? `<span class="card-badge rating"><i class="bi bi-star-fill"></i> ${rating}</span>` : ''}${year ? `<span class="card-badge year">${year}</span>` : ''}</div></div><div class="card-content"><h4 class="card-title">${title}</h4><div class="card-meta"><span><i class="bi ${itemType === 'tv' ? 'bi-tv' : 'bi-film'}"></i> ${itemType === 'tv' ? 'TV' : 'Movie'}</span></div></div>`; link.addEventListener('click', (e) => { if (link.classList.contains('conceptual-link')) { e.preventDefault(); AuraStreamApp.modules.conceptualLinks.handleClick(link, `View details for ${title}`); } }); if (itemType === 'movie') link.addEventListener('mouseenter', () => utils.fetchMovieVideos(item.id).catch(e => utils.warn("Prefetch videos failed:", e)), { once: true }); frag.appendChild(link); }); containerEl.appendChild(frag); if (AuraStreamApp.state.librariesLoaded.aos) AOS.refresh(); },
                     setupHorizontalScroll: function(wrapperEl, containerId) { if (!wrapperEl) return; const container = wrapperEl.querySelector('.horizontal-scroll-container'); const prevBtn = wrapperEl.querySelector('.h-scroll-btn.prev'); const nextBtn = wrapperEl.querySelector('.h-scroll-btn.next'); if (!container || !prevBtn || !nextBtn) { AuraStreamApp.utils.warn(`Scroll elements missing for container: ${containerId}`); return; } const utils = AuraStreamApp.utils; const updateBtns = () => { requestAnimationFrame(() => { if(!container) return; const { scrollLeft, scrollWidth, clientWidth } = container; const tolerance = 15; const isStart = scrollLeft <= tolerance; const isEnd = scrollLeft >= Math.ceil(scrollWidth - clientWidth) - tolerance; prevBtn.classList.toggle('disabled', isStart); prevBtn.setAttribute('aria-disabled', String(isStart)); nextBtn.classList.toggle('disabled', isEnd); nextBtn.setAttribute('aria-disabled', String(isEnd)); }); }; const scrollH = (dir) => { if(!container) return; container.scrollBy({ left: dir * container.clientWidth * 0.75, behavior: 'smooth' }); setTimeout(updateBtns, 150); setTimeout(updateBtns, 450); }; const debouncedUpd = utils.debounce(updateBtns, AuraStreamApp.config.SCROLL_DEBOUNCE); container.addEventListener('scroll', debouncedUpd, { passive: true }); prevBtn.addEventListener('click', () => scrollH(-1)); nextBtn.addEventListener('click', () => scrollH(1)); setTimeout(updateBtns, 300); AuraStreamApp.state.shelfScrollData.set(containerId, updateBtns); }, // Store update function keyed by containerId
                     loadShelf: async function(shelfConfig) { const utils = AuraStreamApp.utils; utils.log(`Loading shelf: ${shelfConfig.title}`); const container = document.querySelector(shelfConfig.containerSelector); const wrapper = container?.closest('.horizontal-scroll-wrapper'); if (!container || !wrapper) { utils.error(`Shelf elements missing for selector: ${shelfConfig.containerSelector}`); return; } container.innerHTML = utils.getSkeletonShelfHTML(); wrapper.querySelectorAll('.h-scroll-btn').forEach(btn => btn.classList.add('disabled')); try { const data = await utils.fetchTMDB(shelfConfig.endpoint, shelfConfig.params); if (data?.results?.length > 0) { utils.log(`Shelf ${shelfConfig.id}: Received ${data.results.length} items.`); this.renderCards(data.results, container, shelfConfig.type); } else { utils.warn(`Shelf ${shelfConfig.id}: No results found or fetch failed.`); container.innerHTML = utils.getErrorTextHTML(`No ${shelfConfig.type === 'tv' ? 'shows' : 'movies'} found for "${shelfConfig.title}".`); } } catch (error) { utils.error(`Error loading shelf ${shelfConfig.id}:`, error); container.innerHTML = utils.getErrorTextHTML(`Error loading ${shelfConfig.title}.`); } finally { this.setupHorizontalScroll(wrapper, shelfConfig.ariaControls); } },
                     loadAllShelves: async function() { const utils = AuraStreamApp.utils; utils.log("Loading all content shelves..."); const promises = AuraStreamApp.config.CONTENT_SHELVES.map(shelf => this.loadShelf(shelf)); await Promise.allSettled(promises); utils.log("All shelves loading attempts complete."); },
                     initResizeListener: function() { window.addEventListener('resize', AuraStreamApp.utils.debounce(() => { AuraStreamApp.state.shelfScrollData.forEach((updateFn, key) => { try { updateFn(); } catch(e){ AuraStreamApp.utils.warn(`Error updating scroll buttons for ${key} on resize:`, e); }}); }, AuraStreamApp.config.RESIZE_DEBOUNCE)); }
                },
                trailerFeature: {
                     currentMovie: null,
                     init: function() { const utils = AuraStreamApp.utils; const els = AuraStreamApp.elements; utils.log("Initializing Trailer Feature module..."); if (!els.trailerFeatureSection) { utils.warn("Trailer Feature section element missing. Module disabled."); return; } if (els.trailerFeaturePlayBtn) els.trailerFeaturePlayBtn.addEventListener('click', () => { if (this.currentMovie?.id && !els.trailerFeaturePlayBtn.disabled) AuraStreamApp.modules.modals.openTrailer(this.currentMovie.id); else utils.warn(`Trailer play conditions not met. ID: ${this.currentMovie?.id}, Disabled: ${els.trailerFeaturePlayBtn?.disabled}`); }); else utils.warn("Trailer feature play button missing."); if (els.trailerFeatureMoreInfoBtn) els.trailerFeatureMoreInfoBtn.addEventListener('click', (e) => { if (this.currentMovie?.id && els.trailerFeatureMoreInfoBtn.classList.contains('conceptual-link')) AuraStreamApp.modules.conceptualLinks.handleClick(els.trailerFeatureMoreInfoBtn, `View details for ${this.currentMovie.title}`, e); else utils.warn("Trailer More Info not conceptual or no movie data."); }); else utils.warn("Trailer feature more info button missing."); this.updateDisplay(null); utils.log("Trailer Feature module initialized."); },
                     loadContent: async function(movie) { const utils = AuraStreamApp.utils; if(!movie?.id) { utils.warn("TrailerFeature: Invalid movie data provided."); return; } if (movie.id === this.currentMovie?.id) return; utils.log(`TrailerFeature: Loading content for ${movie.title} (ID: ${movie.id})`); this.currentMovie = movie; AuraStreamApp.state.featuredTrailerMovieId = movie.id; const videos = await utils.fetchMovieVideos(movie.id); const bestTrailer = utils.getBestTrailer(videos || []); this.updateDisplay(bestTrailer); },
                     updateDisplay: function(bestTrailer = null) { const els = AuraStreamApp.elements; const movie = this.currentMovie; const utils = AuraStreamApp.utils; if (!els.trailerFeatureTitle || !els.trailerFeatureDesc || !els.trailerFeatureThumbnail || !els.trailerFeaturePlayBtn || !els.trailerFeatureMoreInfoBtn) { utils.warn("Trailer feature display elements missing during update."); return; } if (!movie) { els.trailerFeatureTitle.innerHTML = `<span class="trailer-loading-placeholder">Loading...</span>`; els.trailerFeatureDesc.innerHTML = `<span class="trailer-loading-placeholder">Please wait...</span>`; els.trailerFeatureThumbnail.src = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7'; els.trailerFeatureThumbnail.alt = 'Loading'; els.trailerFeaturePlayBtn.disabled = true; els.trailerFeatureMoreInfoBtn.disabled = true; els.trailerFeatureMoreInfoBtn.classList.remove('conceptual-link'); return; } els.trailerFeatureTitle.textContent = utils.escapeHtml(movie.title || 'Featured Content'); els.trailerFeatureDesc.textContent = movie.overview ? (movie.overview.length > 200 ? utils.escapeHtml(movie.overview.substring(0, 197)) + '...' : utils.escapeHtml(movie.overview)) : 'No description.'; els.trailerFeatureMoreInfoBtn.disabled = false; els.trailerFeatureMoreInfoBtn.classList.add('conceptual-link'); els.trailerFeatureMoreInfoBtn.title = `View Details for ${utils.escapeHtml(movie.title)} (Concept)`; els.trailerFeatureMoreInfoBtn.dataset.movieId = movie.id; if (movie.backdrop_path) { els.trailerFeatureThumbnail.src = `${AuraStreamApp.config.IMAGE_BASE_URL}${AuraStreamApp.config.BACKDROP_SIZE}${movie.backdrop_path}`; els.trailerFeatureThumbnail.alt = `${utils.escapeHtml(movie.title)} thumbnail`; els.trailerFeatureThumbnail.style.opacity = '1'; } else { els.trailerFeatureThumbnail.alt = 'Thumbnail unavailable'; els.trailerFeatureThumbnail.src = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7'; els.trailerFeatureThumbnail.style.opacity = '0.5'; } els.trailerFeaturePlayBtn.disabled = false; els.trailerFeaturePlayBtn.dataset.movieId = movie.id; utils.log(`TrailerFeature display updated for ${movie.title}.`); },
                     displayError: function(message = "Cannot load trailer.") { const els = AuraStreamApp.elements; const utils = AuraStreamApp.utils; if (!els.trailerFeatureSection) return; utils.warn(`Displaying error in trailer: ${message}`); if(els.trailerFeatureTitle) els.trailerFeatureTitle.innerHTML = `<span class="text-danger small">${utils.escapeHtml(message)}</span>`; if(els.trailerFeatureDesc) els.trailerFeatureDesc.textContent = 'Please try again later.'; if(els.trailerFeatureThumbnail) { els.trailerFeatureThumbnail.src = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7'; els.trailerFeatureThumbnail.alt = 'Error loading'; } if(els.trailerFeaturePlayBtn) els.trailerFeaturePlayBtn.disabled = true; if(els.trailerFeatureMoreInfoBtn) { els.trailerFeatureMoreInfoBtn.disabled = true; els.trailerFeatureMoreInfoBtn.classList.remove('conceptual-link');} this.currentMovie = null; }
                },
                gallery3D: {
                     elements:{}, state:{currentIndex:0, rotationY:0, angleStep:0, isDragging:false, startPosition:0, currentTouchIdentifier:null},
                     init:function(){const utils=AuraStreamApp.utils; utils.log("Init 3D Gallery...");this.cacheElements();if(!this.validateElements()){utils.warn("3D Gallery invalid. Aborting.");if(this.elements.galleryContainer)this.elements.galleryContainer.style.display='none';return}this.state.angleStep=360/this.elements.cards.length;this.applyCardTransforms();this.addEventListeners();this.updateGallery(false);this.resetAutoRotate();utils.log("3D Gallery Initialized.")},
                     cacheElements:function(){this.elements.galleryContainer=AuraStreamApp.elements.gallerySection;this.elements.galleryStage=AuraStreamApp.elements.galleryStage;this.elements.cards=AuraStreamApp.elements.galleryCards;this.elements.dotsContainer=AuraStreamApp.elements.galleryDotsContainer;this.elements.dots=AuraStreamApp.elements.galleryDots;this.elements.prevBtn=AuraStreamApp.elements.galleryPrevBtn;this.elements.nextBtn=AuraStreamApp.elements.galleryNextBtn;this.elements.modal=AuraStreamApp.elements.galleryFullscreenModal;this.elements.modalImage=AuraStreamApp.elements.galleryModalImageFs;this.elements.modalCaption=AuraStreamApp.elements.galleryModalCaptionFs;this.elements.modalClose=AuraStreamApp.elements.galleryModalCloseFs},
                     validateElements:function(){const els=this.elements;const utils=AuraStreamApp.utils;const req=[els.galleryContainer,els.galleryStage,els.cards,els.dotsContainer,els.dots,els.prevBtn,els.nextBtn,els.modal,els.modalImage,els.modalCaption,els.modalClose];if(req.some(el=>!el)){utils.error("Gallery validation failed: Missing elements.");return false}if(els.cards.length===0||els.dots.length!==els.cards.length){utils.error(`Gallery validation failed: Card/dot count mismatch (${els.cards.length}/${els.dots.length}).`);return false}return true},
                     applyCardTransforms:function(){const config=AuraStreamApp.config;const baseZ=config.GALLERY_TRANSLATE_Z_BASE;this.elements.cards.forEach((card,index)=>{const angle=index*this.state.angleStep;card.style.transform=`translate3d(-50%, -50%, 0) rotateY(${angle}deg) translateZ(${baseZ}px)`;card.dataset.index=index;card.style.width=`${config.GALLERY_CARD_WIDTH}px`;card.style.height=`${config.GALLERY_CARD_HEIGHT}px`});if(this.elements.galleryContainer)this.elements.galleryContainer.style.perspective=`${config.GALLERY_PERSPECTIVE}px`},
                     addEventListeners:function(){const els=this.elements;const self=this;const utils=AuraStreamApp.utils;try{els.prevBtn.addEventListener('click',()=>{self.resetAutoRotate();self.prevSlide()});els.nextBtn.addEventListener('click',()=>{self.resetAutoRotate();self.nextSlide()});els.dots.forEach(dot=>dot.addEventListener('click',function(){self.resetAutoRotate();const i=parseInt(this.dataset.index);if(!isNaN(i)&&i!==self.state.currentIndex){self.state.currentIndex=i;self.updateGallery()}}));els.cards.forEach(card=>{card.addEventListener('click',function(){self.resetAutoRotate();const i=parseInt(this.dataset.index);if(isNaN(i))return;if(this.classList.contains('active'))self.openModal(i);else{self.state.currentIndex=i;self.updateGallery()}});card.addEventListener('mousedown',self.dragStart.bind(self));card.addEventListener('touchstart',self.dragStart.bind(self),{passive:true})});els.modalClose.addEventListener('click',self.closeModal.bind(self));els.modal.addEventListener('click',(e)=>{if(e.target===els.modal)self.closeModal()});document.addEventListener('mouseup',self.dragEnd.bind(self));document.addEventListener('touchend',self.dragEnd.bind(self));document.addEventListener('mousemove',self.drag.bind(self));document.addEventListener('touchmove',self.drag.bind(self),{passive:false});els.galleryStage.addEventListener('mouseleave',self.dragEnd.bind(self));document.addEventListener('keydown',(e)=>{if(els.modal.classList.contains('active')){if(e.key==='Escape')self.closeModal()}else if(document.activeElement&&!['INPUT','TEXTAREA'].includes(document.activeElement.tagName)&&els.galleryContainer?.contains(document.activeElement)){if(e.key==='ArrowLeft'){e.preventDefault();self.resetAutoRotate();self.prevSlide()}if(e.key==='ArrowRight'){e.preventDefault();self.resetAutoRotate();self.nextSlide()}}});['mousedown','touchstart','keydown'].forEach(evt=>els.galleryContainer?.addEventListener(evt,self.resetAutoRotate.bind(self),{capture:true}))}catch(e){utils.error("Error gallery listeners:",e)}},
                     updateGallery:function(transition=true){try{const config=AuraStreamApp.config;const baseZ=config.GALLERY_TRANSLATE_Z_BASE;const activeZ=config.GALLERY_TRANSLATE_Z_ACTIVE;const activeScale=config.GALLERY_SCALE_ACTIVE;this.state.rotationY=-this.state.currentIndex*this.state.angleStep;if(!this.elements.galleryStage)return;this.elements.galleryStage.style.transition=transition?`transform 0.8s cubic-bezier(0.25, 0.8, 0.25, 1.2)`:'none';this.elements.galleryStage.style.transform=`rotateY(${this.state.rotationY}deg)`;this.elements.cards.forEach((card,index)=>{card.classList.toggle('active',index===this.state.currentIndex);const angle=index*this.state.angleStep;const isActive=index===this.state.currentIndex;const currentZ=isActive?activeZ:baseZ;const currentScale=isActive?activeScale:1;card.style.transform=`translate3d(-50%, -50%, 0) rotateY(${angle}deg) translateZ(${currentZ}px) scale(${currentScale})`});this.elements.dots.forEach((dot,index)=>dot.classList.toggle('active',index===this.state.currentIndex))}catch(e){AuraStreamApp.utils.error("Error update gallery:",e)}},
                     nextSlide:function(){this.state.currentIndex=(this.state.currentIndex+1)%this.elements.cards.length;this.updateGallery()},
                     prevSlide:function(){this.state.currentIndex=(this.state.currentIndex-1+this.elements.cards.length)%this.elements.cards.length;this.updateGallery()},
                     openModal:function(index){const utils=AuraStreamApp.utils;try{const card=this.elements.cards[index];if(!card||!this.elements.modalImage||!this.elements.modalCaption||!this.elements.modal)return;const imgEl=card.querySelector('.card-image');const name=card.getAttribute('data-name')||`Image ${index+1}`;if(imgEl?.src){this.elements.modalImage.src=imgEl.src;this.elements.modalImage.alt=imgEl.alt||name}else{this.elements.modalImage.src='';this.elements.modalImage.alt='N/A';utils.warn(`Img src missing ${index}`)}this.elements.modalCaption.textContent=name;this.elements.modal.classList.add('active');document.body.style.overflow='hidden'}catch(e){utils.error("Error open modal:",e)}},
                     closeModal:function(){try{if(!this.elements.modal)return;this.elements.modal.classList.remove('active');document.body.style.overflow=''}catch(e){AuraStreamApp.utils.error("Error close modal:",e)}},
                     dragStart:function(e){const utils=AuraStreamApp.utils;try{if(e.target.closest('.nav-btn')||e.target.closest('.dot')||!this.elements.galleryStage)return;this.resetAutoRotate();AuraStreamApp.state.isGalleryDragging=true;this.state.startPosition=this.getPositionX(e);if(this.state.startPosition===null){AuraStreamApp.state.isGalleryDragging=false;return}this.elements.galleryStage.style.transition='none';this.elements.galleryStage.style.cursor='grabbing';document.body.style.cursor='grabbing';document.body.style.userSelect='none';if(e.type==='touchstart')this.state.currentTouchIdentifier=e.touches[0].identifier}catch(e){utils.error("Error dragStart:",e);AuraStreamApp.state.isGalleryDragging=false}},
                     drag:function(e){if(!AuraStreamApp.state.isGalleryDragging||!this.elements.galleryStage)return;try{const currentPos=this.getPositionX(e);if(currentPos===null)return;if(e.type.includes('touch')){e.preventDefault()}const diff=currentPos-this.state.startPosition;const rotationDelta=diff*0.2;this.elements.galleryStage.style.transform=`rotateY(${this.state.rotationY+rotationDelta}deg)`}catch(e){AuraStreamApp.utils.error("Error during drag:",e);AuraStreamApp.state.isGalleryDragging=false;this.dragEnd()}},
                     dragEnd:function(e){if(!AuraStreamApp.state.isGalleryDragging||!this.elements.galleryStage)return;AuraStreamApp.state.isGalleryDragging=false;try{this.elements.galleryStage.style.cursor='grab';document.body.style.cursor='';document.body.style.userSelect='';const endPos=this.getPositionX(e);const currentPos=(endPos!==undefined&&endPos!==null)?endPos:this.state.startPosition;const diff=currentPos-this.state.startPosition;const threshold=50;if(diff>threshold)this.prevSlide();else if(diff<-threshold)this.nextSlide();else this.updateGallery();this.state.currentTouchIdentifier=null}catch(e){AuraStreamApp.utils.error("Error dragEnd:",e);this.updateGallery()}},
                     getPositionX:function(e){if(e.type.includes('mouse'))return e.pageX;if(e.type.includes('touch')){const touch=(e.touches&&e.touches.length>0)?Array.from(e.touches).find(t=>t.identifier===this.state.currentTouchIdentifier)||e.touches[0]:(e.changedTouches&&e.changedTouches.length>0)?e.changedTouches[0]:null;return touch?touch.clientX:null}return null},
                     startAutoRotate:function(){this.stopAutoRotate();AuraStreamApp.state.galleryAutoRotateInterval=setInterval(()=>this.nextSlide(),AuraStreamApp.config.GALLERY_AUTO_ROTATE_INTERVAL)},
                     stopAutoRotate:function(){clearInterval(AuraStreamApp.state.galleryAutoRotateInterval);clearTimeout(AuraStreamApp.state.galleryAutoRotateTimeout);AuraStreamApp.state.galleryAutoRotateInterval=null;AuraStreamApp.state.galleryAutoRotateTimeout=null},
                     resetAutoRotate:function(){this.stopAutoRotate();AuraStreamApp.state.galleryAutoRotateTimeout=setTimeout(()=>this.startAutoRotate(),AuraStreamApp.config.GALLERY_AUTO_ROTATE_DELAY)}
                 },
                analyticsDashboard: {
                     elements:{},
                     init:function(){AuraStreamApp.utils.log("Analytics init.");this.cacheElements()},
                     cacheElements:function(){this.elements.kpiTotalTitles=AuraStreamApp.elements.kpiTotalTitles;this.elements.kpiActiveUsers=AuraStreamApp.elements.kpiActiveUsers;this.elements.kpiAvgRating=AuraStreamApp.elements.kpiAvgRating;this.elements.kpiCommunityPosts=AuraStreamApp.elements.kpiCommunityPosts;this.elements.topActorsList=AuraStreamApp.elements.topActorsList;this.elements.gaugeFillElement=AuraStreamApp.elements.gaugeFillElement;this.elements.gaugeValueElement=AuraStreamApp.elements.gaugeValueElement;this.elements.networkBarChart=AuraStreamApp.elements.networkBarChart},
                     loadAnalyticsData:async function(){const utils=AuraStreamApp.utils;utils.log("Loading analytics...");const results=await Promise.allSettled([this.updateKpis(),this.fetchAndRenderTopActors(),this.updateGauge(),this.updateNetworkChart()]);utils.log("Analytics settled.");results.forEach((r,i)=>{if(r.status==='rejected')utils.error(`Analytics load failed (Task ${i}):`,r.reason)})},
                     updateKpis:async function(){const utils=AuraStreamApp.utils;await new Promise(res=>setTimeout(res,150));try{if(this.elements.kpiTotalTitles)this.elements.kpiTotalTitles.textContent="1.3M+";if(this.elements.kpiActiveUsers)this.elements.kpiActiveUsers.textContent="72k+";if(this.elements.kpiAvgRating)this.elements.kpiAvgRating.innerHTML='8.1 <i class="bi bi-star-fill text-warning"></i>';if(this.elements.kpiCommunityPosts)this.elements.kpiCommunityPosts.textContent="15k+"}catch(e){utils.error("Error update KPIs:",e)}},
                     updateGauge:function(){const utils=AuraStreamApp.utils;try{const val=Math.floor(Math.random()*26)+60;const turn=val/100;if(this.elements.gaugeFillElement)setTimeout(()=>{this.elements.gaugeFillElement.style.transform=`rotate(${turn}turn)`},100);if(this.elements.gaugeValueElement)this.elements.gaugeValueElement.textContent=`${val}%`}catch(e){utils.error("Error update Gauge:",e)}},
                     updateNetworkChart:function(){const utils=AuraStreamApp.utils;const data=[{l:"Netflix",v:75,c:"var(--gradient-primary)"},{l:"HBO",v:70,c:"var(--gradient-secondary)"},{l:"Disney+",v:65,c:"linear-gradient(130deg, var(--secondary-accent), var(--tertiary-accent))"},{l:"Prime",v:60,c:"linear-gradient(130deg, var(--tertiary-accent), #ffc107)"},{l:"Apple+",v:45,c:"linear-gradient(130deg, #ffc107, #4caf50)"}];try{if(this.elements.networkBarChart){let html='';data.forEach((item,i)=>{html+=`<div class="bar-item" data-aos="fade-left" data-aos-delay="${i*50}"><div class="bar-label">${utils.escapeHtml(item.l)}</div><div class="bar" style="background: ${item.c}; width: 0%;" data-target-width="${item.v}%"></div></div>`});this.elements.networkBarChart.innerHTML=html;setTimeout(()=>{this.elements.networkBarChart.querySelectorAll('.bar').forEach(bar=>{bar.style.width=bar.dataset.targetWidth})},100)}}catch(e){utils.error("Error update Network Chart:",e)}},
                     fetchAndRenderTopActors:async function(){const utils=AuraStreamApp.utils;if(!this.elements.topActorsList)return;this.elements.topActorsList.innerHTML=utils.getLoadingTextHTML("Loading actors...");try{const data=await utils.fetchTMDB('/person/popular',{page:1});if(data?.results?.length)this.renderTopActors(data.results.slice(0,6));else{this.elements.topActorsList.innerHTML=utils.getErrorTextHTML("Could not load actors.");utils.warn("Fetch actors failed/empty.")}}catch(e){utils.error("Error fetch actors:",e);this.elements.topActorsList.innerHTML=utils.getErrorTextHTML("Error loading actors.")}},
                     renderTopActors:function(actors){const utils=AuraStreamApp.utils;if(!this.elements.topActorsList||!actors?.length)return;const config=AuraStreamApp.config;let html='';actors.forEach((actor,i)=>{const img=actor.profile_path?`${config.IMAGE_BASE_URL}${config.PROFILE_SIZE}${actor.profile_path}`:'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="%23a0aec0" class="bi bi-person-fill" viewBox="0 0 16 16"><path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6"/></svg>';html+=`<div class="actor-item" data-aos="fade-up" data-aos-delay="${i*50}"><img src="${img}" alt="${utils.escapeHtml(actor.name)}" loading="lazy"><span class="actor-name">${utils.escapeHtml(actor.name)}</span><span class="actor-popularity"><i class="bi bi-graph-up"></i> ${actor.popularity?.toFixed(1)||'?'}</span></div>`});this.elements.topActorsList.innerHTML=html;utils.log("Actors rendered.");if(AuraStreamApp.state.librariesLoaded.aos)AOS.refresh()},
                     displayError:function(message="Cannot load analytics."){const utils=AuraStreamApp.utils;utils.warn(`Displaying error in analytics: ${message}`);const errorHtml=utils.getErrorTextHTML(message);if(this.elements.kpiTotalTitles)this.elements.kpiTotalTitles.textContent="N/A";if(this.elements.kpiActiveUsers)this.elements.kpiActiveUsers.textContent="N/A";if(this.elements.kpiAvgRating)this.elements.kpiAvgRating.innerHTML='<i class="bi bi-exclamation-triangle text-danger"></i>';if(this.elements.kpiCommunityPosts)this.elements.kpiCommunityPosts.textContent="N/A";if(this.elements.topActorsList)this.elements.topActorsList.innerHTML=errorHtml;if(this.elements.gaugeValueElement)this.elements.gaugeValueElement.textContent="N/A";if(this.elements.gaugeFillElement)this.elements.gaugeFillElement.style.transform='rotate(0turn)';if(this.elements.networkBarChart)this.elements.networkBarChart.innerHTML=errorHtml}
                 }
    
            } // End AuraStreamApp.modules
    
        }; // End AuraStreamApp object
    
        // --- Start the Main Application ---
        AuraStreamApp.init();
    
    </script>
</body>
</html>
