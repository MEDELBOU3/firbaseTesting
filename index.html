<!DOCTYPE html>
<html lang="fr" x-data="{ darkMode: false }" x-bind:class="{ 'dark': darkMode }" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FPN Informatique & AI – Portail 100% Gratuit</title>

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Firebase CDN -->
    <script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore-compat.js"></script>

    <!-- Tailwind Configuration & Custom Styles -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'] },
                    colors: {
                        primary: '#3b82f6',
                        accent: '#8b5cf6',
                        lightSurface: '#f8f9fa',
                        darkSurface: '#1f2937',
                        darkCard: '#111827'
                    },
                    animation: {
                        float: 'float 6s ease-in-out infinite',
                        'slide-up': 'slideUp 0.5s ease-out',
                        'fade-in': 'fadeIn 0.6s ease-out',
                        flow: 'flow 20s linear infinite', // Added flow animation
                    },
                    keyframes: {
                        float: {
                            '0%,100%': { transform: 'translateY(0) rotate(0deg)' },
                            '50%': { transform: 'translateY(-20px) rotate(3deg)' },
                        },
                        slideUp: { '0%': { transform: 'translateY(20px)', opacity: '0' }, '100%': { transform: 'translateY(0)', opacity: '1' } },
                        fadeIn: { '0%': { opacity: '0' }, '100%': { opacity: '1' } },
                        flow: { // Defined keyframes for flow
                            '0%': { transform: 'translateX(-50%) translateY(0) rotate(0deg)' },
                            '50%': { transform: 'translateX(50%) translateY(20px) rotate(45deg)' },
                            '100%': { transform: 'translateX(-50%) translateY(0) rotate(0deg)' }
                        }
                    },
                },
            },
        }
    </script>

    <!-- Alpine.js CDN -->
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>

    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />

    <style>
        /* Dynamic Glass Class (Handles both Light and Dark) */
        .dynamic-glass {
            @apply bg-white/90 backdrop-blur-3xl border border-white/50 shadow-2xl dark:bg-gray-900/95 dark:border-gray-700/70 dark:shadow-xl dark:shadow-black/30;
        }

        .gradient-text {
            @apply text-transparent bg-clip-text bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600;
            @apply dark:from-blue-300 dark:via-purple-300 dark:to-pink-300;
        }

        .btn-primary {
            @apply px-8 py-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-full font-bold shadow-lg hover:shadow-2xl hover:scale-[1.03] transition-all duration-300;
            @apply dark:from-blue-500 dark:to-purple-500;
        }

        .btn-secondary {
            @apply px-8 py-4 bg-white/10 backdrop-blur-sm text-gray-900 rounded-full font-bold border-2 border-gray-300 hover:border-blue-600 hover:shadow-lg transition-all duration-300;
            @apply dark:bg-gray-800/50 dark:text-white dark:border-gray-600 dark:hover:border-blue-400;
        }

        /* Animated background - LIGHT MODE BASE */
        .animated-bg {
            background: linear-gradient(-45deg, #e0f2fe, #ddd6fe, #fce7f3, #e0e7ff);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
        }

        /* Animated background - DARK MODE OVERRIDE */
        .dark .animated-bg {
            background: linear-gradient(-45deg, #0f172a, #1e1b4b, #3b0764, #0f172a);
            background-size: 400% 400%;
            animation: gradient 20s ease infinite;
        }

        @keyframes gradient {
            0% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 100% 50%;
            }

            100% {
                background-position: 0% 50%;
            }
        }

        .dark .glass-card {
            @apply bg-gray-800/70 border-gray-700/50 shadow-lg shadow-black/40;
        }

        .glass-card {
            @apply bg-white/70 border-gray-300 shadow-xl;
        }

        .glow {
            box-shadow: 0 0 50px rgba(59, 130, 246, 0.2);
        }

        /* Custom style for opaque Auth Modal */
        .auth-modal-content {
            @apply bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700;
        }

        /* --- DEMO SECTION SPECIFIC STYLES --- */
        .mockup-container {
            position: relative;
            transform-style: preserve-3d;
            perspective: 1500px;
        }

        .mockup-card {
            transition: transform 0.8s cubic-bezier(0.2, 0.8, 0.2, 1);
            transform: translateZ(0);
        }

        .mockup-card:hover {
            transform: translateZ(20px) translateY(-5px);
            box-shadow: 0 40px 80px rgba(0, 0, 0, 0.4);
        }

        .mockup-card-bg {
            background-color: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 1.5rem;
        }

        .mockup-shadow {
            /* Custom glowing shadow effect */
            filter: drop-shadow(0 15px 30px rgba(70, 130, 180, 0.5));
        }

        .mockup-video-wrapper {
            position: relative;
            background: #000;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
        }

        #webgl-bg {
            position: absolute;
            inset: 0;
            z-index: -10;
            display: block;
        }

        .content {
            position: relative;
            z-index: 10;
            color: white;
            text-align: center;
            padding-top: 200px;
            font-family: sans-serif;
        }
    </style>
</head>

<body
    class="min-h-screen animated-bg text-gray-900 dark:text-gray-100 dark:bg-gray-950 overflow-x-hidden transition-colors duration-500"
    x-data="app()">

    <!-- Floating particles -->
    <div class="fixed inset-0 pointer-events-none overflow-hidden opacity-30 dark:opacity-10">
        <div class="absolute top-20 left-10 w-2 h-2 bg-blue-400 rounded-full animate-float"></div>
        <div class="absolute top-40 right-20 w-3 h-3 bg-purple-400 rounded-full animate-float"
            style="animation-delay: -2s;"></div>
        <div class="absolute bottom-32 left-1/4 w-2 h-2 bg-pink-400 rounded-full animate-float"
            style="animation-delay: -4s;"></div>
    </div>

    <!-- Navigation -->
    <nav class="fixed top-0 left-0 right-0 z-50 dynamic-glass animate-slide-up">
        <div class="mx-auto max-w-7xl px-6 py-3">
            <div class="flex items-center justify-between">

                <!-- Logo + Text -->
                <div class="flex items-center gap-3">
                    <img src="https://espace-fpn.ump.ma/src/logo.svg" alt="Logo FPN" class="w-16 h-16">
                    <span class="text-xl font-black text-gray-900 dark:text-white">FPN <span
                            class="text-base font-light text-gray-500 dark:text-gray-400">Info & IA</span></span>
                </div>

                <!-- Nav Links -->
                <ul class="hidden lg:flex items-center gap-8 text-sm font-semibold text-gray-700 dark:text-gray-300">
                    <li><a href="#features" class="hover:text-blue-600 dark:hover:text-blue-400 transition">Ressources
                            Clés</a></li>
                    <li><a href="#tools" class="hover:text-blue-600 dark:hover:text-blue-400 transition">Outils & AI</a>
                    </li>
                    <li><a href="#community"
                            class="hover:text-blue-600 dark:hover:text-blue-400 transition">Communauté</a></li>
                </ul>

                <!-- Buttons -->
                <div class="flex items-center gap-4">
                    <!-- Dark Mode Toggle -->
                    <button @click="darkMode = !darkMode"
                        class="p-2 rounded-full text-gray-700 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700 transition">
                        <template x-if="!darkMode">
                            <i class="bi bi-sun-fill w-6 h-6"></i>
                        </template>
                        <template x-if="darkMode">
                            <i class="bi bi-moon-fill w-6 h-6"></i>
                        </template>
                    </button>

                    <!-- Student Access Button -->
                    <button @click="document.getElementById('modalAuth').classList.remove('hidden')"
                        class="px-6 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-full text-sm font-bold hover:scale-[1.03] transition-all">
                        Accès Étudiant
                    </button>
                </div>

            </div>
        </div>
    </nav>


    <!-- Hero Section -->
    <section class="relative pt-40 pb-32 px-6 lg:px-8 overflow-hidden animated-bg">
        <!-- Background Flow Elements -->
        <div class="absolute inset-0 overflow-hidden pointer-events-none">
            <div class="absolute top-10 left-0 w-80 h-80 bg-blue-300/20 rounded-full animate-flow-slow"></div>
            <div class="absolute bottom-20 right-0 w-96 h-96 bg-purple-300/20 rounded-full animate-flow-fast"></div>
            <div class="absolute top-1/3 left-1/2 w-72 h-72 bg-pink-300/10 rounded-full animate-flow-slow"></div>
            <div class="absolute top-1/4 right-1/4 w-64 h-64 bg-green-300/20 rounded-full animate-flow-fast"></div>
        </div>

        <div class="relative mx-auto max-w-7xl grid lg:grid-cols-2 gap-16 items-center">
            <!-- Left Content -->
            <div class="space-y-8 z-10 relative">
                <div
                    class="inline-flex items-center gap-2 px-4 py-2 dynamic-glass rounded-full shadow-md text-sm font-semibold text-gray-800 dark:text-gray-200">
                    <span class="relative flex h-3 w-3">
                        <span
                            class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span>
                        <span class="relative inline-flex rounded-full h-3 w-3 bg-green-500"></span>
                    </span>
                    Portail Officiel - Accès 100% GRATUIT
                </div>

                <h1 class="text-6xl lg:text-7xl font-black leading-tight text-gray-900 dark:text-white">
                    L'Excellence <br>
                    <span class="gradient-text">Numérique</span> Intégrée
                </h1>

                <p class="text-xl text-gray-700 dark:text-gray-300 leading-relaxed max-w-xl">
                    Votre hub unique pour les supports de cours, outils d'IA, et la collaboration étudiante au sein
                    de la Division Informatique et Intelligence Artificielle.
                </p>

                <div class="flex flex-col sm:flex-row gap-4">
                    <template x-if="$store.auth.loggedIn">
                        <div class="flex flex-col sm:flex-row gap-4 animate-fade-in">
                            <button @click="$store.auth.redirectToApp()" class="btn-primary">
                                Aller au Tableau de Bord de <span x-text="$store.auth.userName"></span> →
                            </button>
                            <a href="#features" class="btn-secondary">Explorer la Landing Page</a>
                        </div>
                    </template>

                    <template x-if="!$store.auth.loggedIn">
                        <div class="flex flex-col sm:flex-row gap-4 animate-fade-in">
                            <button @click="document.getElementById('modalAuth').classList.remove('hidden')"
                                class="btn-primary">
                                Accès Immédiat →
                            </button>
                            <a href="#features" class="btn-secondary">Explorer les Ressources</a>
                        </div>
                    </template>
                </div>

                <!-- Trust Bar -->
                <div class="flex items-center gap-6 pt-4 text-gray-700 dark:text-gray-400">
                    <div class="flex -space-x-3">
                        <img src="https://i.pravatar.cc/40?u=fpn1"
                            class="w-10 h-10 rounded-full ring-2 ring-white dark:ring-gray-800" alt="">
                        <img src="https://i.pravatar.cc/40?u=fpn2"
                            class="w-10 h-10 rounded-full ring-2 ring-white dark:ring-gray-800" alt="">
                        <img src="https://i.pravatar.cc/40?u=fpn3"
                            class="w-10 h-10 rounded-full ring-2 ring-white dark:ring-gray-800" alt="">
                        <img src="https://i.pravatar.cc/40?u=fpn4"
                            class="w-10 h-10 rounded-full ring-2 ring-white dark:ring-gray-800" alt="">
                    </div>
                    <div class="text-sm">
                        <div class="font-bold">Plus de 1500 étudiants actifs</div>
                        <div class="text-gray-500">Intégration transparente pour toute la division.</div>
                    </div>
                </div>
            </div>

            <!-- Right Visual -->
            <div class="relative h-[500px] lg:h-[600px] hidden lg:block z-10">
                <!-- Main Card: Course Progress -->
                <div
                    class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-80 h-52 bg-gradient-to-br from-blue-600 via-purple-600 to-pink-600 rounded-3xl shadow-2xl p-6 text-white flex flex-col justify-between animate-float glow hover:scale-[1.05] transition-transform duration-500">
                    <div class="flex justify-between items-start">
                        <div>
                            <div class="text-sm opacity-90 font-semibold">Tableau de Bord Étudiant</div>
                            <div class="text-xs opacity-75 mt-1">Progression Semestre S4</div>
                        </div>
                        <div
                            class="w-12 h-8 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center font-bold text-xl">
                            FPN</div>
                    </div>
                    <div>
                        <div class="text-2xl font-bold tracking-wide mb-2">Algorithmique & Structures</div>
                        <div class="flex items-center justify-between">
                            <div class="w-full bg-white/30 rounded-full h-2.5">
                                <div class="bg-yellow-400 h-2.5 rounded-full" style="width: 75%"></div>
                            </div>
                            <span class="text-sm opacity-90 ml-3">75%</span>
                        </div>
                    </div>
                </div>

                <!-- Floating Bubbles -->
                <div class="absolute top-16 right-0 flex items-center gap-2 dynamic-glass rounded-full px-4 py-2 shadow-xl text-sm font-semibold text-gray-800 dark:text-gray-100 animate-float"
                    style="animation-delay: -1s;">
                    <i class="bi bi-robot text-purple-600 dark:text-purple-400 text-lg"></i> Assistant IA
                </div>
                <div class="absolute bottom-16 left-0 flex items-center gap-2 dynamic-glass rounded-full px-4 py-2 shadow-xl text-sm font-semibold text-gray-800 dark:text-gray-100 animate-float"
                    style="animation-delay: -3s;">
                    <i class="bi bi-code-slash text-cyan-600 dark:text-cyan-400 text-lg"></i> Éditeur UML
                </div>
                <div class="absolute top-1/2 left-0 flex items-center gap-2 dynamic-glass rounded-full px-4 py-2 shadow-xl text-sm font-semibold text-gray-800 dark:text-gray-100 animate-float"
                    style="animation-delay: -5s;">
                    <i class="bi bi-bell-fill text-red-600 dark:text-red-400 text-lg"></i> 3 Nouveaux Messages
                </div>
            </div>
        </div>
    </section>

    <!-- Section de Démonstration (Mockups & Vidéo) -->
    <section id="demo-section"
        class="relative py-32 px-6 lg:px-8 bg-lightSurface/80 dark:bg-darkCard/50 overflow-hidden">
        <!-- Background Flow Elements -->
        <div class="absolute inset-0 pointer-events-none">
            <div class="absolute top-10 left-0 w-72 h-72 bg-blue-300/20 rounded-full animate-flow-slow"></div>
            <div class="absolute bottom-20 right-0 w-96 h-96 bg-purple-300/20 rounded-full animate-flow-fast"></div>
        </div>

        <div class="mx-auto max-w-7xl relative z-10">
            <!-- Title -->
            <div class="text-center mb-16">
                <h2 class="text-5xl md:text-6xl font-black mb-4 text-gray-900 dark:text-white">
                    Aperçu <span class="gradient-text">Immersif</span>
                </h2>
                <p class="text-xl md:text-2xl text-gray-700 dark:text-gray-400 max-w-3xl mx-auto">
                    Visualisez le fonctionnement des fonctionnalités clés de FPN : suivez votre progression et maîtrisez
                    nos outils intégrés.
                </p>
            </div>

            <div class="grid lg:grid-cols-2 gap-12 items-center">
                <!-- Colonne Gauche : Maquettes Empilées (Mockups) -->
                <div class="mockup-container h-full flex items-center justify-center relative pt-16 lg:pt-0">
                    <!-- Mockup 1: Tableau de Bord (Arrière) -->
                    <div
                        class="absolute top-0 left-0 w-[85%] lg:w-[340px] shadow-2xl mockup-shadow z-20 mockup-card transition-transform duration-700 hover:-translate-y-2 hover:rotate-3">
                        <div class="dynamic-glass border dark:border-gray-700 rounded-2xl p-4">
                            <h4 class="font-bold mb-2 dark:text-gray-300 text-sm flex items-center">
                                <i class="bi bi-speedometer2 me-1"></i> Tableau de Bord
                            </h4>
                            <img src="https://github.com/MEDELBOU3/firbaseTesting/blob/main/images/mockup-frame.png?raw=true"
                                alt="Mockup Tableau de Bord FPN"
                                class="w-full h-auto rounded-xl border border-gray-300 dark:border-gray-600 shadow-inner">
                        </div>
                    </div>

                    <!-- Mockup 2: Éditeur de Code (Avant) -->
                    <div
                        class="relative w-full lg:w-[380px] shadow-2xl mockup-shadow z-30 mockup-card transition-transform duration-700 hover:translate-y-2 hover:-rotate-3">
                        <div class="dynamic-glass border dark:border-gray-700 rounded-2xl p-4">
                            <h4 class="font-bold mb-2 dark:text-gray-300 text-sm flex items-center">
                                <i class="bi bi-diagram-3-fill me-1"></i> UML Éditeur
                            </h4>
                            <img src="https://github.com/MEDELBOU3/firbaseTesting/blob/main/images/umlEditor.png?raw=true"
                                alt="Mockup Éditeur de Code FPN"
                                class="w-full h-auto rounded-xl border border-gray-300 dark:border-gray-600 shadow-inner">
                        </div>
                    </div>
                </div>

                <!-- Colonne Droite : Vidéo Démo & Texte -->
                <div class="space-y-8 lg:text-left relative z-10">
                    <h3 class="text-3xl md:text-4xl font-black gradient-text">Vidéo de Présentation Rapide</h3>
                    <p class="text-lg md:text-xl text-gray-700 dark:text-gray-400">
                        Regardez notre courte démonstration pour comprendre le flux de travail, la navigation des cours
                        et l'utilisation des assistants intelligents en quelques minutes.
                    </p>

                    <!-- Vidéo Démo -->

                    <div
                        class="mockup-video-wrapper w-full aspect-video rounded-2xl overflow-hidden shadow-xl group relative">
                        <!-- YouTube iframe -->
                        <iframe id="demoVideo"
                            class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105 rounded-2xl"
                            src="https://www.youtube.com/embed/DaspflqqOyM?enablejsapi=1&mute=1&controls=0"
                            title="YouTube video player" frameborder="0"
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                            allowfullscreen>
                        </iframe>

                        <!-- Overlay + Play Button -->
                        <div onclick="toggleVideoPlay()"
                            class="absolute inset-0 bg-black/40 group-hover:bg-black/20 transition duration-500 flex items-center justify-center cursor-pointer"
                            id="videoOverlay">
                            <div class="bg-white/20 backdrop-blur-md rounded-full p-6 hover:scale-110 transition flex items-center justify-center"
                                id="playButton">
                                <i class="bi bi-play-fill text-white text-5xl"></i>
                            </div>
                        </div>
                    </div>



                    <!-- CTA Sous la vidéo -->
                    <div class="mt-8 flex flex-wrap gap-4">
                        <button @click="document.getElementById('modalAuth').classList.remove('hidden')"
                            class="btn-primary px-6 py-3 text-base">
                            Commencer l'Exploration
                        </button>
                        <button class="btn-secondary px-6 py-3 text-base flex items-center gap-2">
                            <i class="bi bi-download"></i> Télécharger le Guide FPN
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Features Section (Ressources Clés) -->
    <section id="features" class="py-24 px-6 lg:px-8 bg-lightSurface/80 backdrop-blur-sm dark:bg-darkCard/50">
        <div class="mx-auto max-w-7xl">
            <div class="text-center mb-16">
                <h2 class="text-5xl font-black mb-4 text-gray-900 dark:text-white">Ressources <span
                        class="gradient-text">Clés</span></h2>
                <p class="text-xl text-gray-700 dark:text-gray-400 max-w-2xl mx-auto">Chaque fonctionnalité de la
                    plateforme est conçue pour votre réussite académique.</p>
            </div>

            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                <div
                    class="glass-card dynamic-glass rounded-xl p-8 card-glow group cursor-pointer border dark:border-gray-700">
                    <div
                        class="w-16 h-16 bg-gradient-to-br from-blue-500 to-cyan-500 rounded-xl mb-6 flex items-center justify-center text-white text-3xl shadow-lg">
                        <i class="bi bi-file-earmark-code"></i>
                    </div>
                    <h3
                        class="text-2xl font-bold mb-3 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition">
                        Supports Officiels et Drive</h3>
                    <p class="text-gray-600 dark:text-gray-400 leading-relaxed">Accès direct et sécurisé à tous les
                        documents (PDF, Slides) stockés sur Google Drive (Vue "Tous les cours").</p>
                </div>

                <div
                    class="glass-card dynamic-glass rounded-xl p-8 card-glow group cursor-pointer border dark:border-gray-700">
                    <div
                        class="w-16 h-16 bg-gradient-to-br from-purple-500 to-pink-500 rounded-xl mb-6 flex items-center justify-center text-white text-3xl shadow-lg">
                        <i class="bi bi-people-fill"></i>
                    </div>
                    <h3
                        class="text-2xl font-bold mb-3 group-hover:text-purple-600 dark:group-hover:text-purple-400 transition">
                        Messagerie & Groupes Projets</h3>
                    <p class="text-gray-600 dark:text-gray-400 leading-relaxed">Chats privés et groupes de travail avec
                        indicateurs de présence et réactions pour une collaboration académique efficace.</p>
                </div>

                <div
                    class="glass-card dynamic-glass rounded-xl p-8 card-glow group cursor-pointer border dark:border-gray-700">
                    <div
                        class="w-16 h-16 bg-gradient-to-br from-green-500 to-emerald-500 rounded-xl mb-6 flex items-center justify-center text-white text-3xl shadow-lg">
                        <i class="bi bi-graph-up"></i>
                    </div>
                    <h3
                        class="text-2xl font-bold mb-3 group-hover:text-green-600 dark:group-hover:text-green-400 transition">
                        Suivi de Progression Détaillé</h3>
                    <p class="text-gray-600 dark:text-gray-400 leading-relaxed">Visualisez vos cours terminés, en cours,
                        et votre score d'accomplissement grâce à des graphiques clairs et motivants.</p>
                </div>

                <div
                    class="glass-card dynamic-glass rounded-xl p-8 card-glow group cursor-pointer border dark:border-gray-700">
                    <div
                        class="w-16 h-16 bg-gradient-to-br from-orange-500 to-red-500 rounded-xl mb-6 flex items-center justify-center text-white text-3xl shadow-lg">
                        <i class="bi bi-book-half"></i>
                    </div>
                    <h3
                        class="text-2xl font-bold mb-3 group-hover:text-orange-600 dark:group-hover:text-orange-400 transition">
                        Bibliothèque & Ressources Externes</h3>
                    <p class="text-gray-600 dark:text-gray-400 leading-relaxed">Recherchez et prévisualisez des livres
                        techniques (OpenLibrary) et du contenu vidéo éducatif pertinent (TMDB/YouTube).</p>
                </div>

                <div
                    class="glass-card dynamic-glass rounded-xl p-8 card-glow group cursor-pointer border dark:border-gray-700">
                    <div
                        class="w-16 h-16 bg-gradient-to-br from-indigo-500 to-blue-500 rounded-xl mb-6 flex items-center justify-center text-white text-3xl shadow-lg">
                        <i class="bi bi-calendar-event"></i>
                    </div>
                    <h3
                        class="text-2xl font-bold mb-3 group-hover:text-indigo-600 dark:group-hover:text-indigo-400 transition">
                        Calendrier et Rappels</h3>
                    <p class="text-gray-600 dark:text-gray-400 leading-relaxed">Gérez vos devoirs et examens dans un
                        calendrier unifié avec un système d'alarme pour ne jamais manquer une échéance.</p>
                </div>

                <div
                    class="glass-card dynamic-glass rounded-xl p-8 card-glow group cursor-pointer border dark:border-gray-700">
                    <div
                        class="w-16 h-16 bg-gradient-to-br from-pink-500 to-rose-500 rounded-xl mb-6 flex items-center justify-center text-white text-3xl shadow-lg">
                        <i class="bi bi-chat-square-dots"></i>
                    </div>
                    <h3
                        class="text-2xl font-bold mb-3 group-hover:text-pink-600 dark:group-hover:text-pink-400 transition">
                        Discussions et Q&A</h3>
                    <p class="text-gray-600 dark:text-gray-400 leading-relaxed">Posez vos questions complexes dans les
                        forums de discussion pour bénéficier de l'expertise des professeurs et de la communauté
                        étudiante.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Tools & AI Section -->
    <section id="tools" class="py-24 px-6 lg:px-8">
        <div class="mx-auto max-w-7xl">
            <div class="text-center mb-16">
                <h2 class="text-5xl font-black mb-4 dark:text-white">Outils <span class="gradient-text">Intégrés</span>
                </h2>
                <p class="text-xl text-gray-700 dark:text-gray-400 max-w-2xl mx-auto">Des environnements de travail
                    professionnels sans quitter la plateforme.</p>
            </div>

            <div class="grid md:grid-cols-2 gap-12 items-center">
                <!-- AI Assistant -->
                <div
                    class="dynamic-glass rounded-3xl p-8 card-glow h-full flex flex-col justify-between border dark:border-gray-700">
                    <div class="flex items-center gap-4 mb-4">
                        <div
                            class="w-16 h-16 bg-gradient-to-br from-teal-400 to-green-500 rounded-xl flex items-center justify-center text-white text-3xl shadow-lg">
                            <i class="bi bi-robot"></i>
                        </div>
                        <h3 class="text-3xl font-black dark:text-white">Assistant IA FPN</h3>
                    </div>
                    <p class="text-gray-700 dark:text-gray-400 mb-6 leading-relaxed flex-grow">
                        L'outil "Chat with Fpn Ai" utilise des modèles avancés pour vous assister dans la compréhension
                        et la résolution de problèmes :
                    </p>
                    <ul class="space-y-3 dark:text-gray-300">
                        <li class="flex items-center gap-2"><i class="bi bi-check-circle-fill text-green-500"></i>
                            Explication de code et débogage.</li>
                        <li class="flex items-center gap-2"><i class="bi bi-check-circle-fill text-green-500"></i>
                            Synthèse de concepts académiques.</li>
                        <li class="flex items-center gap-2"><i class="bi bi-check-circle-fill text-green-500"></i>
                            Génération d'exemples spécifiques.</li>
                    </ul>
                </div>

                <!-- Coding Tools -->
                <div
                    class="dynamic-glass rounded-3xl p-8 card-glow h-full flex flex-col justify-between border dark:border-gray-700">
                    <div class="flex items-center gap-4 mb-4">
                        <div
                            class="w-16 h-16 bg-gradient-to-br from-indigo-400 to-purple-500 rounded-xl flex items-center justify-center text-white text-3xl shadow-lg">
                            <i class="bi bi-code-slash"></i>
                        </div>
                        <h3 class="text-3xl font-black dark:text-white">Éditeurs de Projet</h3>
                    </div>
                    <p class="text-gray-700 dark:text-gray-400 mb-6 leading-relaxed flex-grow">
                        La section "Outils d'application" vous fournit deux environnements de travail critiques :
                    </p>
                    <ul class="space-y-3 dark:text-gray-300">
                        <li class="flex items-start gap-2"><i class="bi bi-code-square text-blue-400 mt-1"></i> **Code
                            Editor Sandbox:** Un environnement de codage web rapide basé sur VS Code (Monaco Editor).
                        </li>
                        <li class="flex items-start gap-2"><i class="bi bi-diagram-3-fill text-blue-400 mt-1"></i>
                            **Éditeur UML:** Un outil de conception professionnel pour vos diagrammes (classes,
                            séquences) avec options d'exportation.</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- Community Section -->
    <section id="community" class="py-24 px-6 lg:px-8 bg-lightSurface/80 backdrop-blur-sm dark:bg-darkCard/50">
        <div class="mx-auto max-w-7xl">
            <div class="grid md:grid-cols-2 gap-16 items-center">

                <!-- Left Content -->
                <div class="space-y-6">
                    <span class="text-lg font-bold gradient-text uppercase">Collaborez, Contribuez, Réussissez</span>
                    <h3 class="text-4xl font-black text-gray-900 dark:text-white">Une Communauté <br>Active et Solidaire
                    </h3>
                    <p class="text-xl text-gray-700 dark:text-gray-400 leading-relaxed">
                        Le cœur de FPN est l'échange. Aidez vos camarades, posez des questions dans les forums et
                        contribuez à enrichir la base de connaissances.
                    </p>
                    <ul class="space-y-3">
                        <li class="flex items-start gap-3">
                            <i class="bi bi-check-lg text-2xl text-blue-600 dark:text-blue-400 flex-shrink-0 mt-1"></i>
                            <p class="text-lg dark:text-gray-300">**Contenu Contribué:** Partagez vos meilleurs
                                tutoriels ou documents utiles pour obtenir la reconnaissance de la communauté.</p>
                        </li>
                        <li class="flex items-start gap-3">
                            <i class="bi bi-check-lg text-2xl text-blue-600 dark:text-blue-400 flex-shrink-0 mt-1"></i>
                            <p class="text-lg dark:text-gray-300">**Réactions et Popovers:** Interagissez rapidement
                                avec les messages grâce aux réactions et consultez les profils utilisateurs en un clic.
                            </p>
                        </li>
                    </ul>
                    <div class="mt-8">
                        <button @click="document.getElementById('modalAuth').classList.remove('hidden')"
                            class="btn-primary px-6 py-3 text-base">Rejoindre la Communauté</button>
                    </div>
                </div>

                <!-- Right Visual: Discussion/Inbox mockup -->
                <div class="relative h-96 hidden md:block">
                    <div
                        class="absolute w-full h-full p-4 dynamic-glass rounded-3xl shadow-xl animate-float dark:bg-gray-800/80">
                        <h4 class="font-bold border-b pb-2 mb-2 dark:border-gray-700 dark:text-white"><i
                                class="bi bi-chat-square-dots me-2"></i>Fil de Discussion</h4>
                        <div class="space-y-3 text-sm">
                            <div
                                class="p-3 bg-blue-50 dark:bg-blue-900/60 rounded-lg border border-blue-200 dark:border-blue-600/50">
                                <div class="font-semibold text-blue-800 dark:text-blue-300">"Erreur de Segmentation en
                                    C++"</div>
                                <div class="text-xs text-gray-600 dark:text-blue-300 mt-1">Par: Marie L. - 5 réponses
                                </div>
                            </div>
                            <div class="p-3 dynamic-glass rounded-lg border dark:border-gray-700">
                                <div class="font-semibold text-gray-900 dark:text-white">Meilleures pratiques pour
                                    MongoDB</div>
                                <div class="text-xs text-gray-600 dark:text-gray-400 mt-1">Par: Dr. Dubois (Admin) - 12
                                    réponses</div>
                            </div>
                        </div>
                    </div>

                    <div class="absolute w-64 p-3 bg-green-500/95 backdrop-blur-md rounded-xl shadow-2xl text-white -bottom-4 right-0 animate-float"
                        style="animation-delay: -2s;">
                        <div class="flex items-center gap-3">
                            <i class="bi bi-check-circle-fill text-2xl"></i>
                            <div>
                                <div class="font-bold">Contenu Contribué</div>
                                <p class="text-sm">Votre partage a été validé !</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section id="cta" class="py-24 px-6 lg:px-8">
        <div class="mx-auto max-w-5xl">
            <div
                class="dynamic-glass rounded-3xl p-12 lg:p-16 text-center relative overflow-hidden glow dark:bg-gray-800/80">
                <!-- Decorative elements -->
                <div
                    class="absolute top-0 right-0 w-64 h-64 bg-gradient-to-br from-blue-500/20 to-purple-500/20 rounded-full blur-3xl">
                </div>
                <div
                    class="absolute bottom-0 left-0 w-64 h-64 bg-gradient-to-tr from-pink-500/20 to-cyan-500/20 rounded-full blur-3xl">
                </div>

                <div class="relative">
                    <h2 class="text-5xl lg:text-6xl font-black mb-6 text-gray-900 dark:text-white">
                        <span class="gradient-text">Démarrez</span> Votre Succès
                    </h2>
                    <p class="text-xl text-gray-700 dark:text-gray-400 mb-10 max-w-2xl mx-auto leading-relaxed">
                        Utilisez vos identifiants institutionnels pour vous connecter et accéder immédiatement à votre
                        Tableau de Bord.
                    </p>
                    <div class="flex flex-col sm:flex-row gap-4 justify-center">
                        <button @click="document.getElementById('modalAuth').classList.remove('hidden')"
                            class="btn-primary text-lg">
                            Se Connecter à FPN →
                        </button>
                        <button @click="alert('Veuillez contacter le service scolarité.')"
                            class="btn-secondary text-lg">
                            Problème de Compte
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer id="contact"
        class="py-16 px-6 lg:px-8 dynamic-glass border-t border-gray-300 dark:border-gray-700/50 dark:bg-gray-900/90">
        <div class="mx-auto max-w-7xl">
            <div class="grid md:grid-cols-4 gap-12 mb-12">
                <div>
                    <div class="flex items-center gap-3 mb-4">
                        <img src="https://espace-fpn.ump.ma/src/logo.svg" alt="Logo FPN" class="w-11 h-11">
                        <span class="text-xl font-black text-gray-900 dark:text-white">FPN Info & IA</span>
                    </div>
                    <p class="text-gray-600 dark:text-gray-400 text-sm">Portail Officiel de la Division Informatique et
                        Intelligence Artificielle.</p>
                </div>

                <div>
                    <h4 class="font-bold mb-4 text-gray-900 dark:text-white">Ressources</h4>
                    <ul class="space-y-2 text-sm">
                        <li><a href="#features"
                                class="text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition">Supports
                                de Cours (Drive)</a></li>
                        <li><a href="#tools"
                                class="text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition">Assistant
                                IA</a></li>
                        <li><a href="#"
                                class="text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition">Bibliothèque</a>
                        </li>
                    </ul>
                </div>

                <div>
                    <h4 class="font-bold mb-4 text-gray-900 dark:text-white">Communauté</h4>
                    <ul class="space-y-2 text-sm">
                        <li><a href="#"
                                class="text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition">Forums
                                (Q&A)</a></li>
                        <li><a href="#"
                                class="text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition">Messagerie
                                Groupes</a></li>
                        <li><a href="#"
                                class="text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition">Contenu
                                Contribué</a></li>
                    </ul>
                </div>

                <div>
                    <h4 class="font-bold mb-4 text-gray-900 dark:text-white">Légal & Aide</h4>
                    <ul class="space-y-2 text-sm">
                        <li><a href="#"
                                class="text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition">Assistance
                                Technique</a></li>
                        <li><a href="#"
                                class="text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition">Politique
                                de Confidentialité</a></li>
                    </ul>
                </div>
            </div>

            <div class="pt-8 border-t border-gray-300 dark:border-gray-700/50">
                <p class="text-sm text-gray-600 dark:text-gray-400">&copy; 2024 FPN Informatique & AI. Tous droits
                    réservés.</p>
            </div>
        </div>
    </footer>


    <!-- AUTH MODAL (Opaque Background) -->
    <div id="modalAuth" class="fixed inset-0 z-50 flex items-center justify-center hidden bg-black/80"
        x-data="{ activeTab: 'signin' }">
        <div class="w-full max-w-md p-8 rounded-xl shadow-3xl auth-modal-content">

            <!-- Close Button -->
            <button onclick="document.getElementById('modalAuth').classList.add('hidden')"
                class="absolute top-4 right-4 text-gray-700 dark:text-gray-400 hover:text-black dark:hover:text-white transition">
                <i class="bi bi-x-lg text-xl"></i>
            </button>

            <!-- Tabs -->
            <div class="flex border-b border-gray-300 dark:border-gray-700 mb-6">
                <button @click="activeTab = 'signin'"
                    :class="{'border-blue-500 text-blue-500 dark:border-blue-400 dark:text-blue-400': activeTab === 'signin', 'border-transparent text-gray-500 dark:text-gray-400': activeTab !== 'signin'}"
                    class="flex-1 py-3 text-center font-semibold transition border-b-2">
                    Se connecter
                </button>
                <button @click="activeTab = 'signup'"
                    :class="{'border-blue-500 text-blue-500 dark:border-blue-400 dark:text-blue-400': activeTab === 'signup', 'border-transparent text-gray-500 dark:text-gray-400': activeTab !== 'signup'}"
                    class="flex-1 py-3 text-center font-semibold transition border-b-2">
                    Créer un compte
                </button>
            </div>

            <!-- Sign In Tab -->
            <div x-show="activeTab === 'signin'" x-transition:enter.duration.300>
                <h4 class="text-center text-2xl font-bold mb-6 text-gray-900 dark:text-white">Connexion Étudiant</h4>

                <button id="googleSignIn"
                    class="w-full py-3 mb-4 flex items-center justify-center gap-3 border border-gray-300 dark:border-gray-600 rounded-lg font-semibold hover:bg-gray-100 dark:hover:bg-gray-800 transition text-gray-800 dark:text-white">
                    <svg class="w-5 h-5" viewBox="0 0 48 48">
                        <path fill="#FFC107"
                            d="M43.61 20.08v3.19h-11.44c.64 2.87 2.37 5.09 4.99 6.83l2.84 2.22C36.96 34.69 33.68 36 30 36c-5.45 0-9.87-4.42-9.87-9.87s4.42-9.87 9.87-9.87c2.83 0 5.37 1.25 7.15 2.96l2.84-2.84C38.31 15.65 34.42 14 30 14c-8.84 0-16 7.16-16 16s7.16 16 16 16c9.23 0 15.11-6.75 15.11-16C45.11 28.53 45.02 26.54 44.75 25.04H32.17z" />
                        <path fill="#FF3D00" d="M14 26.2c0-1.74 0-3.48 0-5.22H30.43c.09 1.74 0 3.48 0 5.22H14z" />
                        <path fill="#4CAF50"
                            d="M30.43 36c-1.89-.52-3.8-1.2-5.7-2.03-3.62-1.63-6.52-4.53-8.15-8.15H14c1.6 8.84 8.8 16 16 16s14.4-7.16 14.4-16h-2.12c-.27 2.08-.66 4.16-1.17 6.24L39.75 41C36.96 44.59 33.68 46 30 46c-5.45 0-9.87-4.42-9.87-9.87s4.42-9.87 9.87-9.87c2.83 0 5.37 1.25 7.15 2.96l2.84-2.84C38.31 15.65 34.42 14 30 14c-8.84 0-16 7.16-16 16s7.16 16 16 16c9.23 0 15.11-6.75 15.11-16C45.11 28.53 45.02 26.54 44.75 25.04H32.17z" />
                    </svg>
                    Continuer avec Google
                </button>

                <div class="text-center text-sm text-gray-500 mb-4">ou par email institutionnel</div>

                <form id="signinForm" class="space-y-4">
                    <input id="signinEmail" type="email" placeholder="Email institutionnel" required
                        class="w-full p-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-800 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-gray-800 dark:text-white">
                    <input id="signinPassword" type="password" placeholder="Mot de passe" required
                        class="w-full p-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-800 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-gray-800 dark:text-white">
                    <button type="submit" class="w-full py-3 btn-primary font-bold text-lg">Se connecter</button>
                </form>
                <p id="authError" class="text-red-500 text-sm mt-4 hidden text-center"></p>
            </div>

            <!-- Sign Up Tab -->
            <div x-show="activeTab === 'signup'" x-transition:enter.duration.300>
                <h4 class="text-center text-2xl font-bold mb-6 text-gray-900 dark:text-white">Créer un nouveau compte
                </h4>

                <button id="googleSignup"
                    class="w-full py-3 mb-4 flex items-center justify-center gap-3 border border-gray-300 dark:border-gray-600 rounded-lg font-semibold hover:bg-gray-100 dark:hover:bg-gray-800 transition text-gray-800 dark:text-white">
                    <svg class="w-5 h-5" viewBox="0 0 48 48">
                        <path fill="#FFC107"
                            d="M43.61 20.08v3.19h-11.44c.64 2.87 2.37 5.09 4.99 6.83l2.84 2.22C36.96 34.69 33.68 36 30 36c-5.45 0-9.87-4.42-9.87-9.87s4.42-9.87 9.87-9.87c2.83 0 5.37 1.25 7.15 2.96l2.84-2.84C38.31 15.65 34.42 14 30 14c-8.84 0-16 7.16-16 16s7.16 16 16 16c9.23 0 15.11-6.75 15.11-16C45.11 28.53 45.02 26.54 44.75 25.04H32.17z" />
                        <path fill="#FF3D00" d="M14 26.2c0-1.74 0-3.48 0-5.22H30.43c.09 1.74 0 3.48 0 5.22H14z" />
                        <path fill="#4CAF50"
                            d="M30.43 36c-1.89-.52-3.8-1.2-5.7-2.03-3.62-1.63-6.52-4.53-8.15-8.15H14c1.6 8.84 8.8 16 16 16s14.4-7.16 14.4-16h-2.12c-.27 2.08-.66 4.16-1.17 6.24L39.75 41C36.96 44.59 33.68 46 30 46c-5.45 0-9.87-4.42-9.87-9.87s4.42-9.87 9.87-9.87c2.83 0 5.37 1.25 7.15 2.96l2.84-2.84C38.31 15.65 34.42 14 30 14c-8.84 0-16 7.16-16 16s7.16 16 16 16c9.23 0 15.11-6.75 15.11-16C45.11 28.53 45.02 26.54 44.75 25.04H32.17z" />
                    </svg>
                    S'inscrire avec Google
                </button>

                <div class="text-center text-sm text-gray-500 mb-4">ou par email et mot de passe</div>

                <form id="signupForm" class="space-y-4">
                    <input id="signupName" type="text" placeholder="Nom Complet" required
                        class="w-full p-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-800 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-gray-800 dark:text-white">
                    <input id="signupEmail" type="email" placeholder="Email institutionnel" required
                        class="w-full p-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-800 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-gray-800 dark:text-white">
                    <input id="signupPassword" type="password" placeholder="Mot de passe (min 6 caractères)" required
                        class="w-full p-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-800 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-gray-800 dark:text-white">
                    <button type="submit" class="w-full py-3 btn-primary font-bold text-lg">Créer mon compte</button>
                </form>
                <p id="signupError" class="text-red-500 text-sm mt-4 hidden text-center"></p>
            </div>

        </div>
    </div>

    <style>
        /* Custom gradient for glow
        .bg-gradient-radial {
            background: radial-gradient(circle at center, rgba(59, 130, 246, 0.25), transparent 70%);
        }*/

        /* Smooth cursor glow */
        #cursor-glow {
            filter: blur(60px);
            transition: opacity 0.4s ease;
        }
    </style>
    <!-- Alpine.js & Firebase Script -->
    <script src="https://www.youtube.com/iframe_api"></script>
    <script>
        // --- Firebase Configuration from your index.html ---
        const firebaseConfig = {
            apiKey: "AIzaSyCEWWnD_36oOe5zUPh7A968hNI8t3LTUJ8",
            authDomain: "fpn-info-et-ia.firebaseapp.com",
            databaseURL: "https://fpn-info-et-ia-default-rtdb.firebaseio.com",
            projectId: "fpn-info-et-ia",
            storageBucket: "fpn-info-et-ia.firebasestorage.app",
            messagingSenderId: "746733727875",
            appId: "1:746733727875:web:25629c417c9202b22cabb6",
            measurementId: "G-XRJ2DZPKT0"
        };

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        const googleProvider = new firebase.auth.GoogleAuthProvider();

        // Set persistence to LOCAL so the login persists across the main app
        auth.setPersistence(firebase.auth.Auth.Persistence.LOCAL)
            .then(() => {
                console.log("Persistence set to LOCAL.");
            })
            .catch((error) => {
                console.error("Failed to set persistence:", error);
            });


        // --- Utility Functions ---

        function showAuthError(message, elementId = 'authError') {
            const errorEl = document.getElementById(elementId);
            if (errorEl) {
                errorEl.textContent = `Erreur: ${message}`;
                errorEl.classList.remove('hidden');
                setTimeout(() => errorEl.classList.add('hidden'), 5000);
            }
        }

        function redirectToDashboard() {
            // Since persistence is set to LOCAL, the main app (index.html) will automatically
            // detect the logged-in user state.
            alert("Connexion réussie ! L'état de connexion est enregistré localement.");
            document.getElementById('modalAuth').classList.add('hidden');
            handleSuccessfulLogin(auth.currentUser);
            // Example of a real redirection: window.location.href = '/dashboard.html';
        }

        // Function to ensure user document exists in Firestore (for user management/data init)
        async function initializeUserDocument(user) {
            try {
                await db.collection('users').doc(user.uid).set({
                    name: user.displayName || user.email,
                    email: user.email,
                    photoURL: user.photoURL || null,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                }, { merge: true });
            } catch (error) {
                console.error("Erreur lors de l'initialisation du document utilisateur:", error);
            }
        }


        // --- Sign In Handlers ---

        document.getElementById('googleSignIn')?.addEventListener('click', async () => {
            try {
                document.getElementById('authError').classList.add('hidden');
                localStorage.setItem('fpn_redirect_on_login', 'true'); // Définir le drapeau
                const result = await auth.signInWithPopup(googleProvider);
                await initializeUserDocument(result.user);
                handleSuccessfulLogin(result.user); // Appelle la logique de redirection/bouton
            } catch (error) {
                showAuthError(error.message, 'authError');
                localStorage.removeItem('fpn_redirect_on_login');
                console.error("Google Sign-In Error:", error);
            }
        });

        document.getElementById('signinForm')?.addEventListener('submit', async (e) => {
            e.preventDefault();
            // Re-hide previous errors
            document.getElementById('authError').classList.add('hidden');
            const email = document.getElementById('signinEmail').value;
            const password = document.getElementById('signinPassword').value;

            try {
                const result = await auth.signInWithEmailAndPassword(email, password);
                redirectToDashboard();
            } catch (error) {
                showAuthError("Email ou mot de passe incorrect.", 'authError');
                console.error("Email/Password Sign-In Error:", error);
            }
        });

        // --- Sign Up Handlers ---

        document.getElementById('googleSignup')?.addEventListener('click', async () => {
            try {
                // Re-hide previous errors
                document.getElementById('signupError').classList.add('hidden');
                const result = await auth.signInWithPopup(googleProvider);

                if (!result.user.displayName) {
                    await result.user.updateProfile({
                        displayName: result.user.email.split('@')[0]
                    });
                }
                await initializeUserDocument(result.user);
                redirectToDashboard();
            } catch (error) {
                showAuthError(error.message, 'signupError');
                console.error("Google Sign-Up Error:", error);
            }
        });

        document.getElementById('signupForm')?.addEventListener('submit', async (e) => {
            e.preventDefault();
            // Re-hide previous errors
            document.getElementById('signupError').classList.add('hidden');
            const name = document.getElementById('signupName').value;
            const email = document.getElementById('signupEmail').value;
            const password = document.getElementById('signupPassword').value;

            try {
                const result = await auth.createUserWithEmailAndPassword(email, password);
                await result.user.updateProfile({ displayName: name });
                await initializeUserDocument(result.user);
                redirectToDashboard();
            } catch (error) {
                let errorMessage = error.message;
                if (error.code === 'auth/weak-password') {
                    errorMessage = "Le mot de passe doit contenir au moins 6 caractères.";
                } else if (error.code === 'auth/email-already-in-use') {
                    errorMessage = "Cet email est déjà utilisé. Veuillez vous connecter.";
                } else if (error.code === 'auth/invalid-email') {
                    errorMessage = "Format d'email invalide.";
                }
                showAuthError(errorMessage, 'signupError');
                console.error("Email/Password Sign-Up Error:", error);
            }
        });

        // --- Global State for Login Status ---
        let userIsLoggedIn = false;
        let userDisplayName = '';

        function handleSuccessfulLogin(user) {
            userIsLoggedIn = true;
            userDisplayName = user.displayName || user.email;

            // 1. Cacher le modal d'authentification
            document.getElementById('modalAuth').classList.add('hidden');

            // 2. Mettre à jour l'UI pour afficher le bouton de redirection
            // Cette fonction sera définie dans Alpine.js pour interagir avec le DOM
            if (window.Alpine) {
                Alpine.store('auth').loggedIn = true;
                Alpine.store('auth').userName = userDisplayName;
            }

            // 3. Rediriger immédiatement si c'est la première connexion, ou afficher le bouton
            // Nous allons ajouter un paramètre "redirect_on_login" au localStorage pour gérer ça
            const redirectOnLogin = localStorage.getItem('fpn_redirect_on_login');

            if (redirectOnLogin === 'true' || redirectOnLogin === null) {
                // Redirection immédiate si c'est la première fois ou si le drapeau n'est pas configuré
                localStorage.setItem('fpn_redirect_on_login', 'false'); // Pour éviter la redirection sur rafraîchissement ultérieur de la landing page
                window.location.href = 'app.html'; // Remplacez par 'app.html' si c'est votre fichier d'application principal
            } else {
                // L'utilisateur reste sur la landing page, le bouton Alpine s'affiche.
                // Nettoyer le drapeau
                localStorage.removeItem('fpn_redirect_on_login');
            }
        }

        // --- Alpine App Data ---
        function app() {
            return {
                // Initialisation du mode clair par défaut
                darkMode: false,
                // Initialisation des stores Alpine pour l'état d'authentification
                init() {
                    // Initialize the store once Alpine is ready
                    this.$store.auth = {
                        loggedIn: userIsLoggedIn,
                        userName: userDisplayName,
                        redirectToApp: () => {
                            window.location.href = 'index.html'; // Remplacez par 'app.html'
                        }
                    };
                }
            }
        }

    </script>

    <!-- Add this <script> block after your section (before </body>) -->
    <script>
        // ---------- Ensure YT API script is loaded only once ----------
        if (!window.YT) {
            const tag = document.createElement('script');
            tag.src = "https://www.youtube.com/iframe_api";
            document.head.appendChild(tag);
        }

        // ---------- Player state helpers ----------
        let player;
        let playerReady = false;
        const overlay = document.getElementById('videoOverlay');
        const playButton = document.getElementById('playButton');

        // These functions update UI (icon + overlay)
        function setPlayIcon() {
            if (!playButton) return;
            playButton.innerHTML = '<i class="bi bi-play-fill text-white text-5xl"></i>';
        }
        function setPauseIcon() {
            if (!playButton) return;
            playButton.innerHTML = '<i class="bi bi-pause-fill text-white text-5xl"></i>';
        }
        function hideOverlay() {
            if (!overlay) return;
            overlay.classList.add('opacity-0');
            overlay.classList.add('pointer-events-none');
            // keep some transition time if you use CSS transitions
            setTimeout(() => {
                overlay.style.backgroundColor = 'transparent';
            }, 250);
        }
        function showOverlay() {
            if (!overlay) return;
            overlay.classList.remove('opacity-0');
            overlay.classList.remove('pointer-events-none');
            overlay.style.backgroundColor = ''; // revert to css value
        }

        // ---------- YouTube IFrame API callbacks ----------
        // This will be called by the YT script when ready
        function onYouTubeIframeAPIReady() {
            // Create the player around the existing iframe with id 'demoVideo'
            player = new YT.Player('demoVideo', {
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                }
                // optional: you can pass playerVars if you want to force specific behavior
                // playerVars: { rel: 0, modestbranding: 1 }
            });
            // expose in case you want to debug
            window._ytPlayerInstance = player;
        }

        function onPlayerReady(event) {
            playerReady = true;
            // Start with overlay visible and play icon (unless you want otherwise)
            setPlayIcon();
            showOverlay();
        }

        function onPlayerStateChange(e) {
            const state = e.data;
            // YT player states: -1 unstarted, 0 ended, 1 playing, 2 paused, 3 buffering
            if (state === YT.PlayerState.PLAYING) {
                setPauseIcon();
                hideOverlay();
            } else if (state === YT.PlayerState.PAUSED || state === YT.PlayerState.ENDED || state === YT.PlayerState.UNSTARTED) {
                setPlayIcon();
                showOverlay();
            } else if (state === YT.PlayerState.BUFFERING) {
                // Optional: show a loading indicator
                // keep current UI as-is
            }
        }

        // ---------- Toggle handler wired to your overlay onclick ----------
        function toggleVideoPlay() {
            if (!playerReady || !player || typeof player.getPlayerState !== 'function') {
                console.warn('YouTube player not ready yet.');
                return;
            }

            const state = player.getPlayerState();
            if (state === YT.PlayerState.PLAYING) {
                player.pauseVideo();
            } else {
                // playVideo will unmute if the video is already muted or not — browsers block autoplay unless user interacted,
                // but since this function is called on user click it should work fine.
                player.playVideo();
            }
        }

        // Expose function to the global scope (your markup uses onclick="toggleVideoPlay()")
        window.toggleVideoPlay = toggleVideoPlay;
        // Also expose YT callback globally so YouTube can call it
        window.onYouTubeIframeAPIReady = onYouTubeIframeAPIReady;

        // OPTIONAL: hide overlay after a short delay when clicking play to mimic YouTube's auto-hide
        if (overlay) {
            overlay.addEventListener('click', () => {
                // A click triggers toggleVideoPlay which will start the player; UI updates are handled in onPlayerStateChange.
                // This listener ensures immediate visual feedback (if you want it)
                overlay.classList.add('transition', 'duration-200');
            });
        }
    </script>

    <!-- Add this small CSS (optional) to support fade and pointer-events toggling -->
    <style>
        #videoOverlay {
            transition: opacity .25s ease, background-color .25s ease;
        }

        #videoOverlay.opacity-0 {
            opacity: 0;
        }

        #videoOverlay.pointer-events-none {
            pointer-events: none;
        }
    </style>

</body>

</html>
